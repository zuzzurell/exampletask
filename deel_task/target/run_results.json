{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2024-07-23T12:21:57.117485Z", "invocation_id": "24829b96-f440-40fd-84b5-5bea676facf0", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:41.586343Z", "completed_at": "2024-07-23T12:21:41.598921Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:41.599455Z", "completed_at": "2024-07-23T12:21:42.326437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8999209403991699, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d00-0000-0000ca65476d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_task.stg_globepay__acceptance", "compiled": true, "compiled_code": "-- Load raw data\nwith load_acceptance as (\n    select * \n    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT\n)\n\nselect \n    AMOUNT::number as globepay_acceptance_amount,\n    COUNTRY as globepay_country,\n    CURRENCY as globepay_currency,\n    CVV_PROVIDED::boolean as is_globepay_cvv_provided,\n    DATE_TIME::timestamp as globepay_acceptance_at,\n    EXTERNAL_REF as globepay_acceptance_id,\n    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,\n    REF as globepay_acceptance_event_id,\n    SOURCE as globepay_acceptance_source,\n    STATE as globepay_acceptance_state,\n    STATUS as globepay_acceptance_status\nfrom load_acceptance", "relation_name": "DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:42.493643Z", "completed_at": "2024-07-23T12:21:42.498649Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:42.499232Z", "completed_at": "2024-07-23T12:21:43.160305Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8510227203369141, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d00-0000-0000ca654771"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_task.stg_globepay__chargeback", "compiled": true, "compiled_code": "-- Load raw data\nwith load_chargeback as (\n    select * \n    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT\n)\n\nselect \n    EXTERNAL_REF as globepay_acceptance_id,\n    SOURCE as globepay_chargeback_source,\n    STATUS::boolean as globepay_chargeback_status,\n    CHARGEBACK::boolean as is_globepay_chargeback\nfrom load_chargeback", "relation_name": "DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:43.348342Z", "completed_at": "2024-07-23T12:21:43.358714Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:43.359117Z", "completed_at": "2024-07-23T12:21:44.001366Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8195550441741943, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d00-0000-0000ca654775"}, "message": null, "failures": 0, "unique_id": "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect globepay_acceptance_id\nfrom DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance\nwhere globepay_acceptance_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:44.172221Z", "completed_at": "2024-07-23T12:21:44.183506Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:44.184389Z", "completed_at": "2024-07-23T12:21:44.827544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8319330215454102, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d29-0000-0000ca65376d"}, "message": null, "failures": 0, "unique_id": "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    globepay_acceptance_id as unique_field,\n    count(*) as n_records\n\nfrom DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance\nwhere globepay_acceptance_id is not null\ngroup by globepay_acceptance_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:45.007820Z", "completed_at": "2024-07-23T12:21:45.015226Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:45.015752Z", "completed_at": "2024-07-23T12:21:45.655796Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8230688571929932, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d29-0000-0000ca653771"}, "message": null, "failures": 0, "unique_id": "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect globepay_acceptance_id\nfrom DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback\nwhere globepay_acceptance_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:45.835149Z", "completed_at": "2024-07-23T12:21:45.849500Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:45.850101Z", "completed_at": "2024-07-23T12:21:46.599559Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9351851940155029, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d00-0000-0000ca654779"}, "message": null, "failures": 0, "unique_id": "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select globepay_acceptance_id as from_field\n    from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance\n    where globepay_acceptance_id is not null\n),\n\nparent as (\n    select globepay_acceptance_id as to_field\n    from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:46.775044Z", "completed_at": "2024-07-23T12:21:46.782526Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:46.783044Z", "completed_at": "2024-07-23T12:21:47.391963Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.778850793838501, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d29-0000-0000ca653775"}, "message": null, "failures": 0, "unique_id": "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    globepay_acceptance_id as unique_field,\n    count(*) as n_records\n\nfrom DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback\nwhere globepay_acceptance_id is not null\ngroup by globepay_acceptance_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:47.556513Z", "completed_at": "2024-07-23T12:21:47.561892Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:47.562506Z", "completed_at": "2024-07-23T12:21:48.404674Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.012537956237793, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d29-0000-0000ca653779"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_task.dim_globepay", "compiled": true, "compiled_code": "with laod_acceptance as (\n    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance\n),\nlaod_chargeback as (\n    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback\n),\n\n--GRAIN is the event\njoin_acceptance_chargeback as (\nSELECT \n    acceptance.globepay_acceptance_id,\n    chargeback.globepay_chargeback_source,\n    acceptance.globepay_country,\n    acceptance.globepay_currency,\n    acceptance.globepay_acceptance_source,\n    chargeback.is_globepay_chargeback,\n    acceptance.is_globepay_cvv_provided,\n    acceptance.globepay_acceptance_status,\n    chargeback.globepay_chargeback_status,\nFROM laod_acceptance  acceptance \nLEFT JOIN laod_chargeback chargeback\nON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id\n)\nSELECT * FROM join_acceptance_chargeback", "relation_name": "DEEL_HOME_TEST.RAW_MART.dim_globepay"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:48.574676Z", "completed_at": "2024-07-23T12:21:48.581854Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:48.582342Z", "completed_at": "2024-07-23T12:21:49.367518Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9902727603912354, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d29-0000-0000ca65377d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_task.fct_globepay", "compiled": true, "compiled_code": "with laod_acceptance as (\n    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance\n),\nlaod_chargeback as (\n    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback\n),\n\n--GRAIN is the event\njoin_acceptance_chargeback as (\nSELECT \n    acceptance.globepay_acceptance_id,\n    acceptance.globepay_acceptance_event_id,\n    acceptance.globepay_acceptance_amount,\n    acceptance.globepay_acceptance_at,\n    acceptance.globepay_acceptance_state,\n    --Getting the correct rate for country amounts\n    case\n        when (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency] is not null\n        then (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency]::string::float\n        else null\n    end as country_rate_to_usd,\n    acceptance.globepay_acceptance_amount/country_rate_to_usd as globepay_acceptance_amount_usd\nFROM laod_acceptance  acceptance \nLEFT JOIN laod_chargeback chargeback\nON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id\n)\nSELECT * FROM join_acceptance_chargeback", "relation_name": "DEEL_HOME_TEST.RAW_MART.fct_globepay"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:49.570561Z", "completed_at": "2024-07-23T12:21:49.577799Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:49.578308Z", "completed_at": "2024-07-23T12:21:50.231378Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8169169425964355, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d00-0000-0000ca65477d"}, "message": null, "failures": 0, "unique_id": "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect globepay_acceptance_id\nfrom DEEL_HOME_TEST.RAW_MART.dim_globepay\nwhere globepay_acceptance_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:50.389058Z", "completed_at": "2024-07-23T12:21:50.393634Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:50.394006Z", "completed_at": "2024-07-23T12:21:51.093564Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.870617151260376, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d00-0000-0000ca654781"}, "message": null, "failures": 0, "unique_id": "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    globepay_acceptance_id as unique_field,\n    count(*) as n_records\n\nfrom DEEL_HOME_TEST.RAW_MART.dim_globepay\nwhere globepay_acceptance_id is not null\ngroup by globepay_acceptance_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:51.264954Z", "completed_at": "2024-07-23T12:21:51.272390Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:51.272960Z", "completed_at": "2024-07-23T12:21:51.913760Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8057990074157715, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d29-0000-0000ca653781"}, "message": null, "failures": 0, "unique_id": "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect globepay_acceptance_id\nfrom DEEL_HOME_TEST.RAW_MART.fct_globepay\nwhere globepay_acceptance_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:52.071388Z", "completed_at": "2024-07-23T12:21:52.074292Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:52.074512Z", "completed_at": "2024-07-23T12:21:52.926293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0298192501068115, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d00-0000-0000ca654785"}, "message": null, "failures": 0, "unique_id": "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    globepay_acceptance_id as unique_field,\n    count(*) as n_records\n\nfrom DEEL_HOME_TEST.RAW_MART.fct_globepay\nwhere globepay_acceptance_id is not null\ngroup by globepay_acceptance_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:53.107457Z", "completed_at": "2024-07-23T12:21:53.113764Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:53.114399Z", "completed_at": "2024-07-23T12:21:53.904103Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9874207973480225, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d29-0000-0000ca653785"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_task.rpt_globepay__daily_acceptance_rate", "compiled": true, "compiled_code": "--1. What is the acceptance rate over time?\nwith load_fct_globepay as (\n    SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay\n)\nSELECT\n--DAILY GRAIN\nDATE_TRUNC(day,GLOBEPAY_ACCEPTANCE_AT)::date GLOBEPAY_ACCEPTANCE_DATE,\nCOUNT_IF(GLOBEPAY_ACCEPTANCE_STATE = 'ACCEPTED') as count_acceptance,\nCOUNT(*) total_count,\ncount_acceptance/total_count as daily_acceptance_rate\nFROM load_fct_globepay\nGROUP BY GLOBEPAY_ACCEPTANCE_DATE", "relation_name": "DEEL_HOME_TEST.RAW.rpt_globepay__daily_acceptance_rate"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:54.099523Z", "completed_at": "2024-07-23T12:21:54.105285Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:54.105874Z", "completed_at": "2024-07-23T12:21:54.899447Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9818708896636963, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d00-0000-0000ca654789"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_task.rpt_globepay__declined_countries_greater_25_mil", "compiled": true, "compiled_code": "--2. List the countries where the amount of declined transactions went over $25M\nwith load_fct_globepay as (\n     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay\n     where FCT_GLOBEPAY.GLOBEPAY_ACCEPTANCE_STATE = 'DECLINED'\n\n),\n\nload_dim_globepay as (\n     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay\n),\n\njoin_tables as (\n    SELECT *  \n    FROM load_fct_globepay \n    LEFT JOIN load_dim_globepay  \n    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID\n)\n\nSELECT \nGLOBEPAY_COUNTRY,\nSUM(GLOBEPAY_ACCEPTANCE_AMOUNT_USD) total_amount\nFROM join_tables\nGROUP BY 1\n--Over 25 millions\nHAVING total_amount > 25000000", "relation_name": "DEEL_HOME_TEST.RAW.rpt_globepay__declined_countries_greater_25_mil"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:55.086058Z", "completed_at": "2024-07-23T12:21:55.091903Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:55.092500Z", "completed_at": "2024-07-23T12:21:56.026417Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.108902931213379, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d00-0000-0000ca65478d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_task.rpt_globepay__no_chargeback_transactions", "compiled": true, "compiled_code": "--Which transactions are missing chargeback data?\nwith load_dim_globepay as (\n     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay\n     where not is_globepay_chargeback \n),\nload_fct_globepay as (\n     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay\n\n),\n\njoin_tables as (\n    SELECT \n    load_dim_globepay.globepay_acceptance_id,\n    load_fct_globepay.globepay_acceptance_event_id\n    FROM load_dim_globepay \n    LEFT JOIN load_fct_globepay  \n    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID\n)\n\nSELECT * FROM join_tables", "relation_name": "DEEL_HOME_TEST.RAW.rpt_globepay__no_chargeback_transactions"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-07-23T12:21:56.201207Z", "completed_at": "2024-07-23T12:21:56.207979Z"}, {"name": "execute", "started_at": "2024-07-23T12:21:56.208778Z", "completed_at": "2024-07-23T12:21:56.942109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.911395788192749, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b5dc45-0000-6d00-0000-0000ca654791"}, "message": null, "failures": 0, "unique_id": "test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect globepay_acceptance_id\nfrom DEEL_HOME_TEST.RAW.rpt_globepay__no_chargeback_transactions\nwhere globepay_acceptance_id is null\n\n\n", "relation_name": null}], "elapsed_time": 20.639580011367798, "args": {"enable_legacy_logger": false, "vars": {}, "log_format": "default", "exclude_resource_types": [], "log_path": "/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs", "log_format_file": "debug", "static_parser": true, "write_json": true, "export_saved_queries": false, "partial_parse_file_diff": true, "populate_cache": true, "require_resource_names_without_spaces": false, "resource_types": [], "project_dir": "/Users/alessandro.broggio/Desktop/deel/github/deel_task", "select": [], "which": "build", "require_explicit_package_overrides_for_builtin_materializations": true, "cache_selected_only": false, "log_level_file": "debug", "include_saved_query": false, "favor_state": false, "print": true, "send_anonymous_usage_stats": true, "use_colors": true, "partial_parse": true, "printer_width": 80, "defer": false, "strict_mode": false, "use_colors_file": true, "quiet": false, "macro_debugging": false, "introspect": true, "log_level": "info", "invocation_command": "dbt build", "show": false, "show_resource_report": false, "empty": false, "exclude": [], "indirect_selection": "eager", "warn_error_options": {"include": [], "exclude": []}, "profiles_dir": "./profiles", "log_file_max_bytes": 10485760, "version_check": true, "source_freshness_run_project_hooks": false}}