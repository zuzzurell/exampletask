[0m12:01:00.573819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110436f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104550d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110454c80>]}


============================== 12:01:00.576840 | 0ce855f3-f3f2-433c-8e3c-2017bf5c9087 ==============================
[0m12:01:00.576840 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:01:00.577196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:01:00.577550 [info ] [MainThread]: dbt version: 1.7.11
[0m12:01:00.577741 [info ] [MainThread]: python version: 3.12.2
[0m12:01:00.577922 [info ] [MainThread]: python path: /Users/alessandro.broggio/opt/anaconda3/envs/env/bin/python3.12
[0m12:01:00.578100 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m12:01:00.578292 [info ] [MainThread]: Using profiles dir at ./profiles
[0m12:01:00.578457 [info ] [MainThread]: Using profiles.yml file at ./profiles/profiles.yml
[0m12:01:00.578624 [info ] [MainThread]: Using dbt_project.yml file at /Users/alessandro.broggio/Desktop/deel/github/deel_task/dbt_project.yml
[0m12:01:00.618814 [info ] [MainThread]: Configuration:
[0m12:01:00.619167 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m12:01:00.619366 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:01:00.619557 [info ] [MainThread]: Required dependencies:
[0m12:01:00.619932 [debug] [MainThread]: Executing "git --help"
[0m12:01:00.662424 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:01:00.662998 [debug] [MainThread]: STDERR: "b''"
[0m12:01:00.663217 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:01:00.663425 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:01:00.663618 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:01:00.663798 [info ] [MainThread]: dbt looked for a profiles.yml file in ./profiles/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m12:01:00.666221 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.12048762, "process_user_time": 0.867257, "process_kernel_time": 0.168751, "process_mem_max_rss": "96747520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:01:00.666623 [debug] [MainThread]: Command `dbt debug` failed at 12:01:00.666540 after 0.12 seconds
[0m12:01:00.666929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f81160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033f9430>]}
[0m12:01:00.667202 [debug] [MainThread]: Flushing usage events
[0m12:05:39.960368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f11f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c212e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f3e660>]}


============================== 12:05:39.963727 | a8d1331b-8b3e-4347-9cb8-ad9c6d96d81a ==============================
[0m12:05:39.963727 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:05:39.964089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'version_check': 'True', 'profiles_dir': './profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:05:39.964433 [info ] [MainThread]: dbt version: 1.7.11
[0m12:05:39.964621 [info ] [MainThread]: python version: 3.12.2
[0m12:05:39.964795 [info ] [MainThread]: python path: /Users/alessandro.broggio/opt/anaconda3/envs/env/bin/python3.12
[0m12:05:39.964963 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m12:05:39.966922 [info ] [MainThread]: Using profiles dir at ./profiles
[0m12:05:39.967155 [info ] [MainThread]: Using profiles.yml file at ./profiles/profiles.yml
[0m12:05:39.967340 [info ] [MainThread]: Using dbt_project.yml file at /Users/alessandro.broggio/Desktop/deel/github/deel_task/dbt_project.yml
[0m12:05:40.001382 [info ] [MainThread]: Configuration:
[0m12:05:40.001729 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:05:40.001922 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:05:40.002094 [info ] [MainThread]: Required dependencies:
[0m12:05:40.002457 [debug] [MainThread]: Executing "git --help"
[0m12:05:40.048632 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:05:40.049189 [debug] [MainThread]: STDERR: "b''"
[0m12:05:40.049413 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:05:40.049615 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:05:40.049804 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:05:40.049979 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'deel_task'


[0m12:05:40.051658 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.13568191, "process_user_time": 0.880982, "process_kernel_time": 0.164287, "process_mem_max_rss": "96387072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:05:40.052044 [debug] [MainThread]: Command `dbt debug` failed at 12:05:40.051964 after 0.14 seconds
[0m12:05:40.052364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e216a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e22060>]}
[0m12:05:40.052624 [debug] [MainThread]: Flushing usage events
[0m12:06:08.167676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084afe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bf170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084da660>]}


============================== 12:06:08.172208 | 806d53ec-f905-4fdc-9e15-c79596a83784 ==============================
[0m12:06:08.172208 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:06:08.172612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': './profiles', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:06:08.172958 [info ] [MainThread]: dbt version: 1.7.11
[0m12:06:08.173152 [info ] [MainThread]: python version: 3.12.2
[0m12:06:08.173328 [info ] [MainThread]: python path: /Users/alessandro.broggio/opt/anaconda3/envs/env/bin/python3.12
[0m12:06:08.173497 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m12:06:08.175465 [info ] [MainThread]: Using profiles dir at ./profiles
[0m12:06:08.175653 [info ] [MainThread]: Using profiles.yml file at ./profiles/profiles.yml
[0m12:06:08.175820 [info ] [MainThread]: Using dbt_project.yml file at /Users/alessandro.broggio/Desktop/deel/github/deel_task/dbt_project.yml
[0m12:06:08.209915 [info ] [MainThread]: Configuration:
[0m12:06:08.210240 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:06:08.210431 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:06:08.210601 [info ] [MainThread]: Required dependencies:
[0m12:06:08.210906 [debug] [MainThread]: Executing "git --help"
[0m12:06:08.248294 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:06:08.248893 [debug] [MainThread]: STDERR: "b''"
[0m12:06:08.249117 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:06:08.249325 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:06:08.249515 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:06:08.249685 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'deel_task'


[0m12:06:08.252014 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.12781121, "process_user_time": 0.884302, "process_kernel_time": 0.160273, "process_mem_max_rss": "97124352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:06:08.252431 [debug] [MainThread]: Command `dbt debug` failed at 12:06:08.252342 after 0.13 seconds
[0m12:06:08.252751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcc620>]}
[0m12:06:08.253073 [debug] [MainThread]: Flushing usage events
[0m12:07:25.014235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114836960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11487aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11487a6c0>]}


============================== 12:07:25.017641 | e41e05d2-c711-4d2d-a286-dc9c4f301657 ==============================
[0m12:07:25.017641 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:07:25.018027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'profiles_dir': './profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:07:25.018405 [info ] [MainThread]: dbt version: 1.7.11
[0m12:07:25.018611 [info ] [MainThread]: python version: 3.12.2
[0m12:07:25.018800 [info ] [MainThread]: python path: /Users/alessandro.broggio/opt/anaconda3/envs/env/bin/python3.12
[0m12:07:25.018980 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m12:07:25.219662 [info ] [MainThread]: Using profiles dir at ./profiles
[0m12:07:25.220001 [info ] [MainThread]: Using profiles.yml file at ./profiles/profiles.yml
[0m12:07:25.220192 [info ] [MainThread]: Using dbt_project.yml file at /Users/alessandro.broggio/Desktop/deel/github/deel_task/dbt_project.yml
[0m12:07:25.221129 [info ] [MainThread]: adapter type: snowflake
[0m12:07:25.221367 [info ] [MainThread]: adapter version: 1.7.3
[0m12:07:25.253484 [info ] [MainThread]: Configuration:
[0m12:07:25.253744 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:07:25.253934 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:07:25.254110 [info ] [MainThread]: Required dependencies:
[0m12:07:25.254448 [debug] [MainThread]: Executing "git --help"
[0m12:07:25.291421 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:07:25.292021 [debug] [MainThread]: STDERR: "b''"
[0m12:07:25.292240 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:07:25.292444 [info ] [MainThread]: Connection:
[0m12:07:25.292643 [info ] [MainThread]:   account: https://sb10459.eu-west-3.aws.snowflakecomputing.com
[0m12:07:25.292815 [info ] [MainThread]:   user: DEELTESTACCOUNT
[0m12:07:25.292980 [info ] [MainThread]:   database: DEEL_HOME_TEST
[0m12:07:25.293143 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:07:25.293298 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:07:25.293456 [info ] [MainThread]:   schema: RAW
[0m12:07:25.293611 [info ] [MainThread]:   authenticator: None
[0m12:07:25.293765 [info ] [MainThread]:   oauth_client_id: None
[0m12:07:25.293918 [info ] [MainThread]:   query_tag: None
[0m12:07:25.294077 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:07:25.294231 [info ] [MainThread]:   host: None
[0m12:07:25.294388 [info ] [MainThread]:   port: None
[0m12:07:25.294543 [info ] [MainThread]:   proxy_host: None
[0m12:07:25.294693 [info ] [MainThread]:   proxy_port: None
[0m12:07:25.294844 [info ] [MainThread]:   protocol: None
[0m12:07:25.294993 [info ] [MainThread]:   connect_retries: 1
[0m12:07:25.295142 [info ] [MainThread]:   connect_timeout: None
[0m12:07:25.295292 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:07:25.295445 [info ] [MainThread]:   retry_all: False
[0m12:07:25.295594 [info ] [MainThread]:   insecure_mode: False
[0m12:07:25.295745 [info ] [MainThread]:   reuse_connections: None
[0m12:07:25.296025 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:07:25.356943 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:07:25.358384 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:07:25.358694 [debug] [MainThread]: On debug: select 1 as id
[0m12:07:25.359034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:26.438082 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m12:07:26.438973 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m12:07:26.439577 [debug] [MainThread]: On debug: No close available on handle
[0m12:07:26.440187 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:07:26.441219 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:07:26.442203 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:07:26.446571 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.4791374, "process_user_time": 1.021686, "process_kernel_time": 0.208475, "process_mem_max_rss": "119357440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:07:26.447600 [debug] [MainThread]: Command `dbt debug` failed at 12:07:26.447360 after 1.48 seconds
[0m12:07:26.448251 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:07:26.448914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102ab800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151e5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f1d4c0>]}
[0m12:07:26.449597 [debug] [MainThread]: Flushing usage events
[0m12:08:12.798318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ba8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093dab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093da780>]}


============================== 12:08:12.801898 | 8fb11daa-cbea-444c-9885-35eca8f0450c ==============================
[0m12:08:12.801898 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:08:12.802280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:12.802660 [info ] [MainThread]: dbt version: 1.7.11
[0m12:08:12.802870 [info ] [MainThread]: python version: 3.12.2
[0m12:08:12.803053 [info ] [MainThread]: python path: /Users/alessandro.broggio/opt/anaconda3/envs/env/bin/python3.12
[0m12:08:12.803221 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m12:08:12.979019 [info ] [MainThread]: Using profiles dir at ./profiles
[0m12:08:12.979333 [info ] [MainThread]: Using profiles.yml file at ./profiles/profiles.yml
[0m12:08:12.979519 [info ] [MainThread]: Using dbt_project.yml file at /Users/alessandro.broggio/Desktop/deel/github/deel_task/dbt_project.yml
[0m12:08:12.980074 [info ] [MainThread]: adapter type: snowflake
[0m12:08:12.980299 [info ] [MainThread]: adapter version: 1.7.3
[0m12:08:13.012343 [info ] [MainThread]: Configuration:
[0m12:08:13.012602 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:08:13.012792 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:08:13.012967 [info ] [MainThread]: Required dependencies:
[0m12:08:13.013276 [debug] [MainThread]: Executing "git --help"
[0m12:08:13.051903 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:08:13.052506 [debug] [MainThread]: STDERR: "b''"
[0m12:08:13.052733 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:08:13.052944 [info ] [MainThread]: Connection:
[0m12:08:13.053158 [info ] [MainThread]:   account: https://sb10459.eu-west-3.aws.snowflakecomputing.com
[0m12:08:13.053330 [info ] [MainThread]:   user: DEELTESTACCOUNT
[0m12:08:13.053492 [info ] [MainThread]:   database: DEEL_HOME_TEST
[0m12:08:13.053649 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:08:13.053804 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:08:13.053964 [info ] [MainThread]:   schema: RAW
[0m12:08:13.054119 [info ] [MainThread]:   authenticator: None
[0m12:08:13.054272 [info ] [MainThread]:   oauth_client_id: None
[0m12:08:13.054437 [info ] [MainThread]:   query_tag: None
[0m12:08:13.054591 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:08:13.054747 [info ] [MainThread]:   host: None
[0m12:08:13.054911 [info ] [MainThread]:   port: None
[0m12:08:13.055071 [info ] [MainThread]:   proxy_host: None
[0m12:08:13.055225 [info ] [MainThread]:   proxy_port: None
[0m12:08:13.055378 [info ] [MainThread]:   protocol: None
[0m12:08:13.055533 [info ] [MainThread]:   connect_retries: 1
[0m12:08:13.055684 [info ] [MainThread]:   connect_timeout: None
[0m12:08:13.055837 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:08:13.055992 [info ] [MainThread]:   retry_all: False
[0m12:08:13.056148 [info ] [MainThread]:   insecure_mode: False
[0m12:08:13.056299 [info ] [MainThread]:   reuse_connections: None
[0m12:08:13.056562 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:08:13.061332 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:08:13.065437 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:08:13.065635 [debug] [MainThread]: On debug: select 1 as id
[0m12:08:13.065822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:14.107680 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m12:08:14.108701 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m12:08:14.109482 [debug] [MainThread]: On debug: No close available on handle
[0m12:08:14.110088 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:08:14.110657 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:08:14.111163 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:08:14.114740 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.3631579, "process_user_time": 1.002181, "process_kernel_time": 0.198284, "process_mem_max_rss": "114638848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:08:14.115692 [debug] [MainThread]: Command `dbt debug` failed at 12:08:14.115459 after 1.36 seconds
[0m12:08:14.116334 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:08:14.116976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109083230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b52930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094088c0>]}
[0m12:08:14.117718 [debug] [MainThread]: Flushing usage events
[0m12:08:30.663071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d37fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d76a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d76690>]}


============================== 12:08:30.666313 | 892906d6-9ce6-45cc-ab78-4c6b93305543 ==============================
[0m12:08:30.666313 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:08:30.666689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:30.667054 [info ] [MainThread]: dbt version: 1.7.11
[0m12:08:30.667257 [info ] [MainThread]: python version: 3.12.2
[0m12:08:30.667449 [info ] [MainThread]: python path: /Users/alessandro.broggio/opt/anaconda3/envs/env/bin/python3.12
[0m12:08:30.667629 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m12:08:30.840219 [info ] [MainThread]: Using profiles dir at ./profiles
[0m12:08:30.840537 [info ] [MainThread]: Using profiles.yml file at ./profiles/profiles.yml
[0m12:08:30.840726 [info ] [MainThread]: Using dbt_project.yml file at /Users/alessandro.broggio/Desktop/deel/github/deel_task/dbt_project.yml
[0m12:08:30.841253 [info ] [MainThread]: adapter type: snowflake
[0m12:08:30.841475 [info ] [MainThread]: adapter version: 1.7.3
[0m12:08:30.873475 [info ] [MainThread]: Configuration:
[0m12:08:30.873729 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:08:30.873918 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:08:30.874096 [info ] [MainThread]: Required dependencies:
[0m12:08:30.874436 [debug] [MainThread]: Executing "git --help"
[0m12:08:30.905200 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:08:30.905810 [debug] [MainThread]: STDERR: "b''"
[0m12:08:30.906037 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:08:30.906236 [info ] [MainThread]: Connection:
[0m12:08:30.906443 [info ] [MainThread]:   account: https://sb10459.eu-west-3.aws.snowflakecomputing.com
[0m12:08:30.906616 [info ] [MainThread]:   user: DEELTESTACCOUNT
[0m12:08:30.906777 [info ] [MainThread]:   database: DEEL_HOME_TEST
[0m12:08:30.906936 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:08:30.907093 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:08:30.907250 [info ] [MainThread]:   schema: RAW
[0m12:08:30.907412 [info ] [MainThread]:   authenticator: None
[0m12:08:30.907570 [info ] [MainThread]:   oauth_client_id: None
[0m12:08:30.907723 [info ] [MainThread]:   query_tag: None
[0m12:08:30.907879 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:08:30.908033 [info ] [MainThread]:   host: None
[0m12:08:30.908188 [info ] [MainThread]:   port: None
[0m12:08:30.908339 [info ] [MainThread]:   proxy_host: None
[0m12:08:30.908492 [info ] [MainThread]:   proxy_port: None
[0m12:08:30.908641 [info ] [MainThread]:   protocol: None
[0m12:08:30.908791 [info ] [MainThread]:   connect_retries: 1
[0m12:08:30.908944 [info ] [MainThread]:   connect_timeout: None
[0m12:08:30.909097 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:08:30.909250 [info ] [MainThread]:   retry_all: False
[0m12:08:30.909401 [info ] [MainThread]:   insecure_mode: False
[0m12:08:30.909552 [info ] [MainThread]:   reuse_connections: None
[0m12:08:30.909825 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:08:30.914172 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:08:30.915253 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:08:30.915453 [debug] [MainThread]: On debug: select 1 as id
[0m12:08:30.915631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:31.951159 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m12:08:31.951954 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m12:08:31.952522 [debug] [MainThread]: On debug: No close available on handle
[0m12:08:31.953726 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:08:31.954552 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:08:31.954956 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:08:31.957550 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.3366349, "process_user_time": 1.003616, "process_kernel_time": 0.194457, "process_mem_max_rss": "118407168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:08:31.958146 [debug] [MainThread]: Command `dbt debug` failed at 12:08:31.957997 after 1.34 seconds
[0m12:08:31.958562 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:08:31.959186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104707110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105228800>]}
[0m12:08:31.959876 [debug] [MainThread]: Flushing usage events
[0m12:10:11.971753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114355e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11175bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114376900>]}


============================== 12:10:11.975131 | ee44b724-c85d-401a-bacb-7e5a49f700c1 ==============================
[0m12:10:11.975131 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:10:11.975498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'profiles_dir': './profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:10:11.975863 [info ] [MainThread]: dbt version: 1.7.11
[0m12:10:11.976055 [info ] [MainThread]: python version: 3.12.2
[0m12:10:11.976231 [info ] [MainThread]: python path: /Users/alessandro.broggio/opt/anaconda3/envs/env/bin/python3.12
[0m12:10:11.976400 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m12:10:12.164806 [info ] [MainThread]: Using profiles dir at ./profiles
[0m12:10:12.165109 [info ] [MainThread]: Using profiles.yml file at ./profiles/profiles.yml
[0m12:10:12.165299 [info ] [MainThread]: Using dbt_project.yml file at /Users/alessandro.broggio/Desktop/deel/github/deel_task/dbt_project.yml
[0m12:10:12.165864 [info ] [MainThread]: adapter type: snowflake
[0m12:10:12.166084 [info ] [MainThread]: adapter version: 1.7.3
[0m12:10:12.197962 [info ] [MainThread]: Configuration:
[0m12:10:12.198224 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:10:12.198433 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:10:12.198608 [info ] [MainThread]: Required dependencies:
[0m12:10:12.198907 [debug] [MainThread]: Executing "git --help"
[0m12:10:12.245835 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:10:12.246479 [debug] [MainThread]: STDERR: "b''"
[0m12:10:12.246707 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:10:12.246915 [info ] [MainThread]: Connection:
[0m12:10:12.247127 [info ] [MainThread]:   account: sb10459.eu-west-3.aws
[0m12:10:12.247310 [info ] [MainThread]:   user: DEELTESTACCOUNT
[0m12:10:12.247475 [info ] [MainThread]:   database: DEEL_HOME_TEST
[0m12:10:12.247633 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:10:12.247789 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:10:12.247951 [info ] [MainThread]:   schema: RAW
[0m12:10:12.248110 [info ] [MainThread]:   authenticator: None
[0m12:10:12.248263 [info ] [MainThread]:   oauth_client_id: None
[0m12:10:12.248425 [info ] [MainThread]:   query_tag: None
[0m12:10:12.248579 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:10:12.248733 [info ] [MainThread]:   host: None
[0m12:10:12.248892 [info ] [MainThread]:   port: None
[0m12:10:12.249044 [info ] [MainThread]:   proxy_host: None
[0m12:10:12.249196 [info ] [MainThread]:   proxy_port: None
[0m12:10:12.249347 [info ] [MainThread]:   protocol: None
[0m12:10:12.249499 [info ] [MainThread]:   connect_retries: 1
[0m12:10:12.249651 [info ] [MainThread]:   connect_timeout: None
[0m12:10:12.249800 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:10:12.249953 [info ] [MainThread]:   retry_all: False
[0m12:10:12.250104 [info ] [MainThread]:   insecure_mode: False
[0m12:10:12.250257 [info ] [MainThread]:   reuse_connections: None
[0m12:10:12.250522 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:10:12.254434 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:10:12.255545 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:10:12.255744 [debug] [MainThread]: On debug: select 1 as id
[0m12:10:12.255926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:12.946964 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:12.950581 [debug] [MainThread]: On debug: Close
[0m12:10:13.066417 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:10:13.067490 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:10:13.072744 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1438366, "process_user_time": 1.102558, "process_kernel_time": 0.212819, "process_mem_max_rss": "122748928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:10:13.073711 [debug] [MainThread]: Command `dbt debug` succeeded at 12:10:13.073468 after 1.14 seconds
[0m12:10:13.074327 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:10:13.074923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11175bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104e6c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143368a0>]}
[0m12:10:13.075589 [debug] [MainThread]: Flushing usage events
[0m12:22:16.626408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b84d70>]}


============================== 12:22:16.629526 | 78a517c8-dd97-493d-be26-207522868a11 ==============================
[0m12:22:16.629526 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:22:16.629918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'profiles_dir': './profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:22:16.643125 [info ] [MainThread]: dbt version: 1.8.0
[0m12:22:16.643422 [info ] [MainThread]: python version: 3.12.2
[0m12:22:16.643600 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m12:22:16.643757 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m12:22:17.209681 [info ] [MainThread]: Using profiles dir at ./profiles
[0m12:22:17.209995 [info ] [MainThread]: Using profiles.yml file at ./profiles/profiles.yml
[0m12:22:17.210178 [info ] [MainThread]: Using dbt_project.yml file at /Users/alessandro.broggio/Desktop/deel/github/deel_task/dbt_project.yml
[0m12:22:17.210827 [info ] [MainThread]: adapter type: snowflake
[0m12:22:17.211003 [info ] [MainThread]: adapter version: 1.8.1
[0m12:22:17.249388 [info ] [MainThread]: Configuration:
[0m12:22:17.249737 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:22:17.249914 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:22:17.250072 [info ] [MainThread]: Required dependencies:
[0m12:22:17.250423 [debug] [MainThread]: Executing "git --help"
[0m12:22:17.285254 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:22:17.285854 [debug] [MainThread]: STDERR: "b''"
[0m12:22:17.286079 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:22:17.286276 [info ] [MainThread]: Connection:
[0m12:22:17.286476 [info ] [MainThread]:   account: sb10459.eu-west-3.aws
[0m12:22:17.286633 [info ] [MainThread]:   user: DEELTESTACCOUNT
[0m12:22:17.286781 [info ] [MainThread]:   database: DEEL_HOME_TEST
[0m12:22:17.286920 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:22:17.287061 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:22:17.287201 [info ] [MainThread]:   schema: RAW
[0m12:22:17.287341 [info ] [MainThread]:   authenticator: None
[0m12:22:17.287480 [info ] [MainThread]:   oauth_client_id: None
[0m12:22:17.287615 [info ] [MainThread]:   query_tag: None
[0m12:22:17.287754 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:22:17.287889 [info ] [MainThread]:   host: None
[0m12:22:17.288027 [info ] [MainThread]:   port: None
[0m12:22:17.288161 [info ] [MainThread]:   proxy_host: None
[0m12:22:17.288295 [info ] [MainThread]:   proxy_port: None
[0m12:22:17.288434 [info ] [MainThread]:   protocol: None
[0m12:22:17.288568 [info ] [MainThread]:   connect_retries: 1
[0m12:22:17.288705 [info ] [MainThread]:   connect_timeout: None
[0m12:22:17.288837 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:22:17.288973 [info ] [MainThread]:   retry_all: False
[0m12:22:17.289107 [info ] [MainThread]:   insecure_mode: False
[0m12:22:17.289239 [info ] [MainThread]:   reuse_connections: None
[0m12:22:17.289635 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:22:17.294344 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:22:17.295871 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:22:17.296096 [debug] [MainThread]: On debug: select 1 as id
[0m12:22:17.296263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:17.802532 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:22:17.806190 [debug] [MainThread]: On debug: Close
[0m12:22:17.913882 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:22:17.914960 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:22:17.920072 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3439302, "process_user_time": 0.843674, "process_kernel_time": 0.243254, "process_mem_max_rss": "123781120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:22:17.921247 [debug] [MainThread]: Command `dbt debug` succeeded at 12:22:17.921066 after 1.35 seconds
[0m12:22:17.921840 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:22:17.922442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2d190>]}
[0m12:22:17.923073 [debug] [MainThread]: Flushing usage events
[0m12:24:57.334507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e05310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5cfb0>]}


============================== 12:24:57.337718 | 7ea52d58-ec45-4390-8c33-959363f6014c ==============================
[0m12:24:57.337718 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:24:57.338105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_globepay_acceptance', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:57.646833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ea52d58-ec45-4390-8c33-959363f6014c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107749280>]}
[0m12:24:57.669524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ea52d58-ec45-4390-8c33-959363f6014c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079841d0>]}
[0m12:24:57.670267 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:24:57.682393 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:24:57.683515 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:24:57.683894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ea52d58-ec45-4390-8c33-959363f6014c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac3ce0>]}
[0m12:24:58.159461 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_globepay_chargeback' in the 'models' section of file 'models/staging/globepay/_stg_globepay_models.yml'
[0m12:24:58.196891 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.deel_task.stg_globepay_acceptance' (models/staging/globepay/stg_globepay_acceptance.sql) depends on a source named 'RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT' which was not found
[0m12:24:58.200634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.90937215, "process_user_time": 1.226797, "process_kernel_time": 0.221495, "process_mem_max_rss": "123682816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:24:58.200991 [debug] [MainThread]: Command `dbt run` failed at 12:24:58.200940 after 0.91 seconds
[0m12:24:58.201229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107987d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2f680>]}
[0m12:24:58.201425 [debug] [MainThread]: Flushing usage events
[0m12:25:21.085435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b48830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ad520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ad250>]}


============================== 12:25:21.088305 | 06b45a74-b053-47d4-93a0-bf6097a6a6d4 ==============================
[0m12:25:21.088305 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:25:21.088661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': './profiles', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_globepay_acceptance', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:25:21.381983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06b45a74-b053-47d4-93a0-bf6097a6a6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d1400>]}
[0m12:25:21.405109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06b45a74-b053-47d4-93a0-bf6097a6a6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ba750>]}
[0m12:25:21.405964 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:25:21.417878 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:25:21.418859 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:25:21.419148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06b45a74-b053-47d4-93a0-bf6097a6a6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d707a0>]}
[0m12:25:21.895162 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_globepay_chargeback' in the 'models' section of file 'models/staging/globepay/_stg_globepay_models.yml'
[0m12:25:21.994512 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:25:21.999584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06b45a74-b053-47d4-93a0-bf6097a6a6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103566ea0>]}
[0m12:25:22.049565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06b45a74-b053-47d4-93a0-bf6097a6a6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059f2720>]}
[0m12:25:22.049873 [info ] [MainThread]: Found 1 model, 2 sources, 444 macros
[0m12:25:22.050154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06b45a74-b053-47d4-93a0-bf6097a6a6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a46f30>]}
[0m12:25:22.050859 [info ] [MainThread]: 
[0m12:25:22.051147 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:22.051579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:25:22.058342 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:25:22.058601 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:25:22.058768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:23.976647 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:25:23.980520 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:25:24.096412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now create_DEEL_HOME_TEST_RAW_STAGING)
[0m12:25:24.097522 [debug] [ThreadPool]: Creating schema "database: "DEEL_HOME_TEST"
schema: "RAW_STAGING"
"
[0m12:25:24.105403 [debug] [ThreadPool]: Using snowflake connection "create_DEEL_HOME_TEST_RAW_STAGING"
[0m12:25:24.106018 [debug] [ThreadPool]: On create_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "create_DEEL_HOME_TEST_RAW_STAGING"} */
create schema if not exists DEEL_HOME_TEST.RAW_STAGING
[0m12:25:24.106525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:24.594500 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:25:24.597817 [debug] [ThreadPool]: On create_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:25:24.709153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW_STAGING'
[0m12:25:24.721896 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:25:24.722455 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:25:24.722893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:25.046013 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m12:25:25.050238 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:25:25.170934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06b45a74-b053-47d4-93a0-bf6097a6a6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587f2c0>]}
[0m12:25:25.172248 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:25.172930 [info ] [MainThread]: 
[0m12:25:25.177851 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_acceptance
[0m12:25:25.178750 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_STAGING.stg_globepay_acceptance ................ [RUN]
[0m12:25:25.179450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_DEEL_HOME_TEST_RAW_STAGING, now model.deel_task.stg_globepay_acceptance)
[0m12:25:25.180032 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_acceptance
[0m12:25:25.190233 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_acceptance"
[0m12:25:25.192670 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_acceptance
[0m12:25:25.219966 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_acceptance"
[0m12:25:25.221840 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_acceptance"
[0m12:25:25.222236 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
  
   as (
    --Load raw data
with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

SELECT * FROM laod_acceptance
  );
[0m12:25:25.222566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:25.786318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:25:25.812534 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: Close
[0m12:25:25.905490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b45a74-b053-47d4-93a0-bf6097a6a6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f5670>]}
[0m12:25:25.906029 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_STAGING.stg_globepay_acceptance ........... [[32mSUCCESS 1[0m in 0.73s]
[0m12:25:25.906426 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_acceptance
[0m12:25:25.907192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:25.907444 [debug] [MainThread]: Connection 'model.deel_task.stg_globepay_acceptance' was properly closed.
[0m12:25:25.907636 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW_STAGING' was properly closed.
[0m12:25:25.907835 [info ] [MainThread]: 
[0m12:25:25.908041 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m12:25:25.908420 [debug] [MainThread]: Command end result
[0m12:25:25.924946 [info ] [MainThread]: 
[0m12:25:25.925284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:25.925473 [info ] [MainThread]: 
[0m12:25:25.925657 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:25:25.927993 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8861356, "process_user_time": 1.731862, "process_kernel_time": 0.267254, "process_mem_max_rss": "131776512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:25:25.928365 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:25.928311 after 4.89 seconds
[0m12:25:25.928596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ad250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ad520>]}
[0m12:25:25.928803 [debug] [MainThread]: Flushing usage events
[0m12:32:12.769720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ab260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060454f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060451f0>]}


============================== 12:32:12.772887 | 58bf8e2b-1a60-4c18-97e9-b9adf3c4294e ==============================
[0m12:32:12.772887 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:32:12.773248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'profiles_dir': './profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_globepay_acceptance', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:13.084624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58bf8e2b-1a60-4c18-97e9-b9adf3c4294e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a90fb0>]}
[0m12:32:13.107899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58bf8e2b-1a60-4c18-97e9-b9adf3c4294e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458b650>]}
[0m12:32:13.108713 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:32:13.118868 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:32:13.204910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:13.205317 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/stg_globepay_acceptance.sql
[0m12:32:13.324744 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:32:13.330612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58bf8e2b-1a60-4c18-97e9-b9adf3c4294e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122af9d00>]}
[0m12:32:13.379183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58bf8e2b-1a60-4c18-97e9-b9adf3c4294e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b0cc80>]}
[0m12:32:13.379492 [info ] [MainThread]: Found 1 model, 2 sources, 444 macros
[0m12:32:13.379772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58bf8e2b-1a60-4c18-97e9-b9adf3c4294e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ccac60>]}
[0m12:32:13.380535 [info ] [MainThread]: 
[0m12:32:13.380848 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:13.381292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:32:13.388026 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:32:13.388300 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:32:13.388468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:13.936737 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:32:13.939849 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:32:14.061777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW_STAGING'
[0m12:32:14.074128 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:32:14.074674 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:32:14.075083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:14.581320 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:14.584931 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:32:14.692260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58bf8e2b-1a60-4c18-97e9-b9adf3c4294e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12282e900>]}
[0m12:32:14.693471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:14.694050 [info ] [MainThread]: 
[0m12:32:14.697156 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_acceptance
[0m12:32:14.698075 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_STAGING.stg_globepay_acceptance ................ [RUN]
[0m12:32:14.698800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now model.deel_task.stg_globepay_acceptance)
[0m12:32:14.699386 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_acceptance
[0m12:32:14.709543 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_acceptance"
[0m12:32:14.710904 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_acceptance
[0m12:32:14.740007 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_acceptance"
[0m12:32:14.741933 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_acceptance"
[0m12:32:14.742442 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
  
   as (
    --Load raw data
with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

SELECT 
    AMOUNT as globepay_acceptance_amount,
    COUNTRY  as globepay_country,
    CURRENCY as  globepay_currency ,
    CVV_PROVIDED as globepay_cvv_provided,
    DATE_TIME  as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    RATES::object as globepay_acceptance_rates, 
    REF as globepay_acceptance_ref,
    SOURCE as globepay_acceptance_source ,
    STATE as  globepay_acceptance_state,
    STATUS as globepay_acceptance_ status
 FROM laod_acceptance
  );
[0m12:32:14.742805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:15.058501 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dbd8-0000-6d29-0000-0000ca6531a1
[0m12:32:15.059333 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 35 unexpected 'status'.
[0m12:32:15.060138 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: Close
[0m12:32:15.172609 [debug] [Thread-1 (]: Database Error in model stg_globepay_acceptance (models/staging/globepay/stg_globepay_acceptance.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 35 unexpected 'status'.
  compiled Code at target/run/deel_task/models/staging/globepay/stg_globepay_acceptance.sql
[0m12:32:15.174775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58bf8e2b-1a60-4c18-97e9-b9adf3c4294e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c4170>]}
[0m12:32:15.175568 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW_STAGING.stg_globepay_acceptance ....... [[31mERROR[0m in 0.47s]
[0m12:32:15.176245 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_acceptance
[0m12:32:15.177981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:15.178335 [debug] [MainThread]: Connection 'model.deel_task.stg_globepay_acceptance' was properly closed.
[0m12:32:15.178632 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW_STAGING' was properly closed.
[0m12:32:15.178966 [info ] [MainThread]: 
[0m12:32:15.179308 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m12:32:15.179944 [debug] [MainThread]: Command end result
[0m12:32:15.205783 [info ] [MainThread]: 
[0m12:32:15.206293 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:32:15.206614 [info ] [MainThread]: 
[0m12:32:15.206979 [error] [MainThread]:   Database Error in model stg_globepay_acceptance (models/staging/globepay/stg_globepay_acceptance.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 35 unexpected 'status'.
  compiled Code at target/run/deel_task/models/staging/globepay/stg_globepay_acceptance.sql
[0m12:32:15.207326 [info ] [MainThread]: 
[0m12:32:15.208091 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:32:15.210947 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.490786, "process_user_time": 1.253509, "process_kernel_time": 0.264104, "process_mem_max_rss": "133431296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:32:15.211608 [debug] [MainThread]: Command `dbt run` failed at 12:32:15.211524 after 2.49 seconds
[0m12:32:15.212036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106045490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060454f0>]}
[0m12:32:15.212452 [debug] [MainThread]: Flushing usage events
[0m12:32:38.157762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082313d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082310d0>]}


============================== 12:32:38.160694 | 2d770f7d-92d7-47c7-929f-0c8c2d0a7b58 ==============================
[0m12:32:38.160694 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:32:38.161045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_globepay_acceptance', 'send_anonymous_usage_stats': 'True'}
[0m12:32:38.450671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d770f7d-92d7-47c7-929f-0c8c2d0a7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846d280>]}
[0m12:32:38.473141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d770f7d-92d7-47c7-929f-0c8c2d0a7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108230fb0>]}
[0m12:32:38.474504 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:32:38.486136 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:32:38.567863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:32:38.568129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:32:38.570504 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:32:38.583317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d770f7d-92d7-47c7-929f-0c8c2d0a7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108230f20>]}
[0m12:32:38.634655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d770f7d-92d7-47c7-929f-0c8c2d0a7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109091550>]}
[0m12:32:38.634963 [info ] [MainThread]: Found 1 model, 2 sources, 444 macros
[0m12:32:38.635154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d770f7d-92d7-47c7-929f-0c8c2d0a7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e46840>]}
[0m12:32:38.636007 [info ] [MainThread]: 
[0m12:32:38.636314 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:38.636752 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:32:38.644502 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:32:38.644918 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:32:38.645142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:39.132289 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:32:39.136721 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:32:39.237889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW_STAGING'
[0m12:32:39.250019 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:32:39.250702 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:32:39.251111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:39.633494 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:32:39.638417 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:32:39.740414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d770f7d-92d7-47c7-929f-0c8c2d0a7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109086ff0>]}
[0m12:32:39.741475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:39.742570 [info ] [MainThread]: 
[0m12:32:39.746850 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_acceptance
[0m12:32:39.747982 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_STAGING.stg_globepay_acceptance ................ [RUN]
[0m12:32:39.748763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now model.deel_task.stg_globepay_acceptance)
[0m12:32:39.749341 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_acceptance
[0m12:32:39.760328 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_acceptance"
[0m12:32:39.762189 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_acceptance
[0m12:32:39.791004 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_acceptance"
[0m12:32:39.796750 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_acceptance"
[0m12:32:39.798100 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
  
   as (
    --Load raw data
with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

SELECT 
    AMOUNT as globepay_acceptance_amount,
    COUNTRY  as globepay_country,
    CURRENCY as  globepay_currency ,
    CVV_PROVIDED as globepay_cvv_provided,
    DATE_TIME  as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    RATES::object as globepay_acceptance_rates, 
    REF as globepay_acceptance_ref,
    SOURCE as globepay_acceptance_source ,
    STATE as  globepay_acceptance_state,
    STATUS as globepay_acceptance_ status
 FROM laod_acceptance
  );
[0m12:32:39.801039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:40.137455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dbd8-0000-6d29-0000-0000ca6531ad
[0m12:32:40.138357 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 35 unexpected 'status'.
[0m12:32:40.139187 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: Close
[0m12:32:40.245622 [debug] [Thread-1 (]: Database Error in model stg_globepay_acceptance (models/staging/globepay/stg_globepay_acceptance.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 35 unexpected 'status'.
  compiled Code at target/run/deel_task/models/staging/globepay/stg_globepay_acceptance.sql
[0m12:32:40.247172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d770f7d-92d7-47c7-929f-0c8c2d0a7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e22a0>]}
[0m12:32:40.247820 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW_STAGING.stg_globepay_acceptance ....... [[31mERROR[0m in 0.50s]
[0m12:32:40.248411 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_acceptance
[0m12:32:40.249976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:40.250337 [debug] [MainThread]: Connection 'model.deel_task.stg_globepay_acceptance' was properly closed.
[0m12:32:40.250596 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW_STAGING' was properly closed.
[0m12:32:40.250874 [info ] [MainThread]: 
[0m12:32:40.251148 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m12:32:40.251665 [debug] [MainThread]: Command end result
[0m12:32:40.270165 [info ] [MainThread]: 
[0m12:32:40.270532 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:32:40.270762 [info ] [MainThread]: 
[0m12:32:40.271038 [error] [MainThread]:   Database Error in model stg_globepay_acceptance (models/staging/globepay/stg_globepay_acceptance.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 35 unexpected 'status'.
  compiled Code at target/run/deel_task/models/staging/globepay/stg_globepay_acceptance.sql
[0m12:32:40.271255 [info ] [MainThread]: 
[0m12:32:40.271467 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:32:40.273914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1570601, "process_user_time": 1.132635, "process_kernel_time": 0.250211, "process_mem_max_rss": "129925120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:32:40.274702 [debug] [MainThread]: Command `dbt run` failed at 12:32:40.274630 after 2.16 seconds
[0m12:32:40.275061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108231460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d86180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d85340>]}
[0m12:32:40.275404 [debug] [MainThread]: Flushing usage events
[0m12:33:20.329931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c89490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106695370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066950a0>]}


============================== 12:33:20.333252 | 49b2ee13-e5ce-4345-a2ab-35c32a69422a ==============================
[0m12:33:20.333252 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:33:20.333623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'profiles_dir': './profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_globepay_acceptance', 'send_anonymous_usage_stats': 'True'}
[0m12:33:20.622786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49b2ee13-e5ce-4345-a2ab-35c32a69422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106121280>]}
[0m12:33:20.645185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49b2ee13-e5ce-4345-a2ab-35c32a69422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6b7d0>]}
[0m12:33:20.646768 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:33:20.659819 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:33:20.740787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:20.741184 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/stg_globepay_acceptance.sql
[0m12:33:20.857365 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:33:20.863578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49b2ee13-e5ce-4345-a2ab-35c32a69422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793bb30>]}
[0m12:33:20.911424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49b2ee13-e5ce-4345-a2ab-35c32a69422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0cc80>]}
[0m12:33:20.911732 [info ] [MainThread]: Found 1 model, 2 sources, 444 macros
[0m12:33:20.912017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b2ee13-e5ce-4345-a2ab-35c32a69422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107961850>]}
[0m12:33:20.912785 [info ] [MainThread]: 
[0m12:33:20.913103 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:20.913518 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:33:20.920320 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:33:20.920598 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:33:20.920774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:21.495416 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:33:21.497615 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:33:21.596270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW_STAGING'
[0m12:33:21.602090 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:33:21.602384 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:33:21.602607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:21.955469 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:33:21.959290 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:33:22.069552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b2ee13-e5ce-4345-a2ab-35c32a69422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a31cd0>]}
[0m12:33:22.070955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:22.072066 [info ] [MainThread]: 
[0m12:33:22.076220 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_acceptance
[0m12:33:22.077216 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_STAGING.stg_globepay_acceptance ................ [RUN]
[0m12:33:22.078097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now model.deel_task.stg_globepay_acceptance)
[0m12:33:22.078826 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_acceptance
[0m12:33:22.089097 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_acceptance"
[0m12:33:22.090385 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_acceptance
[0m12:33:22.119473 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_acceptance"
[0m12:33:22.121107 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_acceptance"
[0m12:33:22.121491 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED as globepay_cvv_provided,
    DATE_TIME as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    RATES::object as globepay_acceptance_rates,
    REF as globepay_acceptance_ref,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m12:33:22.121837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:22.474256 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dbd9-0000-6cfe-0000-0000ca6521cd
[0m12:33:22.475064 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [CAST(LOAD_ACCEPTANCE.RATES AS OBJECT)] for parameter 'TO_OBJECT'
[0m12:33:22.475860 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: Close
[0m12:33:22.583981 [debug] [Thread-1 (]: Database Error in model stg_globepay_acceptance (models/staging/globepay/stg_globepay_acceptance.sql)
  001007 (22023): SQL compilation error:
  invalid type [CAST(LOAD_ACCEPTANCE.RATES AS OBJECT)] for parameter 'TO_OBJECT'
  compiled Code at target/run/deel_task/models/staging/globepay/stg_globepay_acceptance.sql
[0m12:33:22.586567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b2ee13-e5ce-4345-a2ab-35c32a69422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c38230>]}
[0m12:33:22.587637 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW_STAGING.stg_globepay_acceptance ....... [[31mERROR[0m in 0.51s]
[0m12:33:22.588600 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_acceptance
[0m12:33:22.590929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:22.591333 [debug] [MainThread]: Connection 'model.deel_task.stg_globepay_acceptance' was properly closed.
[0m12:33:22.591681 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW_STAGING' was properly closed.
[0m12:33:22.592076 [info ] [MainThread]: 
[0m12:33:22.592496 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m12:33:22.593404 [debug] [MainThread]: Command end result
[0m12:33:22.619785 [info ] [MainThread]: 
[0m12:33:22.620279 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:33:22.620589 [info ] [MainThread]: 
[0m12:33:22.620979 [error] [MainThread]:   Database Error in model stg_globepay_acceptance (models/staging/globepay/stg_globepay_acceptance.sql)
  001007 (22023): SQL compilation error:
  invalid type [CAST(LOAD_ACCEPTANCE.RATES AS OBJECT)] for parameter 'TO_OBJECT'
  compiled Code at target/run/deel_task/models/staging/globepay/stg_globepay_acceptance.sql
[0m12:33:22.621293 [info ] [MainThread]: 
[0m12:33:22.621590 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:33:22.624393 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3342407, "process_user_time": 1.237627, "process_kernel_time": 0.255001, "process_mem_max_rss": "134578176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:33:22.625058 [debug] [MainThread]: Command `dbt run` failed at 12:33:22.624974 after 2.33 seconds
[0m12:33:22.625479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c89490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106695370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066952e0>]}
[0m12:33:22.625844 [debug] [MainThread]: Flushing usage events
[0m12:33:37.953815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065212b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106521040>]}


============================== 12:33:37.956861 | 74328779-5fb2-4e5c-b696-c947ffb86a3e ==============================
[0m12:33:37.956861 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:33:37.957279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_globepay_acceptance', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:33:38.250291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74328779-5fb2-4e5c-b696-c947ffb86a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e91c0>]}
[0m12:33:38.273087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74328779-5fb2-4e5c-b696-c947ffb86a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ef800>]}
[0m12:33:38.274526 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:33:38.286465 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:33:38.368740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:38.369152 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/stg_globepay_acceptance.sql
[0m12:33:38.485432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:33:38.491161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74328779-5fb2-4e5c-b696-c947ffb86a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf9df0>]}
[0m12:33:38.539395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74328779-5fb2-4e5c-b696-c947ffb86a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e08a10>]}
[0m12:33:38.539697 [info ] [MainThread]: Found 1 model, 2 sources, 444 macros
[0m12:33:38.540004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74328779-5fb2-4e5c-b696-c947ffb86a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a51850>]}
[0m12:33:38.540790 [info ] [MainThread]: 
[0m12:33:38.541110 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:38.541555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:33:38.548238 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:33:38.548516 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:33:38.548688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:39.118826 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:33:39.121659 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:33:39.215093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW_STAGING'
[0m12:33:39.224413 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:33:39.224958 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:33:39.225420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:39.573549 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:33:39.576047 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:33:39.703250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74328779-5fb2-4e5c-b696-c947ffb86a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d71f40>]}
[0m12:33:39.704304 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:39.704862 [info ] [MainThread]: 
[0m12:33:39.708618 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_acceptance
[0m12:33:39.709515 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_STAGING.stg_globepay_acceptance ................ [RUN]
[0m12:33:39.710285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now model.deel_task.stg_globepay_acceptance)
[0m12:33:39.710973 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_acceptance
[0m12:33:39.720077 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_acceptance"
[0m12:33:39.721260 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_acceptance
[0m12:33:39.749346 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_acceptance"
[0m12:33:39.750852 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_acceptance"
[0m12:33:39.751251 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED as globepay_cvv_provided,
    DATE_TIME as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    RATES::variant as globepay_acceptance_rates,
    REF as globepay_acceptance_ref,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m12:33:39.751566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:40.312898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:33:40.345798 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: Close
[0m12:33:40.439771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74328779-5fb2-4e5c-b696-c947ffb86a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b41d0>]}
[0m12:33:40.440806 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_STAGING.stg_globepay_acceptance ........... [[32mSUCCESS 1[0m in 0.73s]
[0m12:33:40.441800 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_acceptance
[0m12:33:40.443309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:40.443821 [debug] [MainThread]: Connection 'model.deel_task.stg_globepay_acceptance' was properly closed.
[0m12:33:40.444173 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW_STAGING' was properly closed.
[0m12:33:40.444565 [info ] [MainThread]: 
[0m12:33:40.444926 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m12:33:40.445584 [debug] [MainThread]: Command end result
[0m12:33:40.468568 [info ] [MainThread]: 
[0m12:33:40.469013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:40.469293 [info ] [MainThread]: 
[0m12:33:40.469581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:33:40.472376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5562575, "process_user_time": 1.222042, "process_kernel_time": 0.242243, "process_mem_max_rss": "132612096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:33:40.472872 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:40.472802 after 2.56 seconds
[0m12:33:40.473205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106521370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c70b00>]}
[0m12:33:40.473509 [debug] [MainThread]: Flushing usage events
[0m12:35:14.114124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c9c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff8f80>]}


============================== 12:35:14.117560 | 23a1c974-f0da-4fae-a673-7fc0d3e29f49 ==============================
[0m12:35:14.117560 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:35:14.118005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'profiles_dir': './profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_globepay_acceptance', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:35:14.415779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23a1c974-f0da-4fae-a673-7fc0d3e29f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027bf770>]}
[0m12:35:14.439013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23a1c974-f0da-4fae-a673-7fc0d3e29f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7d1c0>]}
[0m12:35:14.439815 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:35:14.457840 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:35:14.541308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:35:14.541757 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/stg_globepay_acceptance.sql
[0m12:35:14.665981 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:35:14.671882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23a1c974-f0da-4fae-a673-7fc0d3e29f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff5bb0>]}
[0m12:35:14.720162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23a1c974-f0da-4fae-a673-7fc0d3e29f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105008cb0>]}
[0m12:35:14.720468 [info ] [MainThread]: Found 1 model, 2 sources, 444 macros
[0m12:35:14.720747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23a1c974-f0da-4fae-a673-7fc0d3e29f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fea7e0>]}
[0m12:35:14.721593 [info ] [MainThread]: 
[0m12:35:14.721964 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:14.722515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:35:14.729562 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:35:14.729845 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:35:14.730013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:15.221675 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:35:15.224632 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:35:15.324054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW_STAGING'
[0m12:35:15.336377 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:35:15.336930 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:35:15.337330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:15.814684 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:35:15.819222 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:35:15.931179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23a1c974-f0da-4fae-a673-7fc0d3e29f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051095e0>]}
[0m12:35:15.932504 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:15.934987 [info ] [MainThread]: 
[0m12:35:15.938555 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_acceptance
[0m12:35:15.939573 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_STAGING.stg_globepay_acceptance ................ [RUN]
[0m12:35:15.940589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now model.deel_task.stg_globepay_acceptance)
[0m12:35:15.941248 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_acceptance
[0m12:35:15.951400 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_acceptance"
[0m12:35:15.952734 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_acceptance
[0m12:35:15.982739 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_acceptance"
[0m12:35:15.984350 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_acceptance"
[0m12:35:15.984760 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED as is_globepay_cvv_provided,
    DATE_TIME as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_TO_OBJECT(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m12:35:15.985117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:16.461381 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dbdb-0000-6d29-0000-0000ca6531f9
[0m12:35:16.462283 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function TRY_TO_OBJECT
[0m12:35:16.463118 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: Close
[0m12:35:16.594363 [debug] [Thread-1 (]: Database Error in model stg_globepay_acceptance (models/staging/globepay/stg_globepay_acceptance.sql)
  002140 (42601): SQL compilation error:
  Unknown function TRY_TO_OBJECT
  compiled Code at target/run/deel_task/models/staging/globepay/stg_globepay_acceptance.sql
[0m12:35:16.596471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23a1c974-f0da-4fae-a673-7fc0d3e29f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035842c0>]}
[0m12:35:16.597334 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW_STAGING.stg_globepay_acceptance ....... [[31mERROR[0m in 0.65s]
[0m12:35:16.598101 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_acceptance
[0m12:35:16.600143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:16.600636 [debug] [MainThread]: Connection 'model.deel_task.stg_globepay_acceptance' was properly closed.
[0m12:35:16.601006 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW_STAGING' was properly closed.
[0m12:35:16.601405 [info ] [MainThread]: 
[0m12:35:16.601836 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m12:35:16.602594 [debug] [MainThread]: Command end result
[0m12:35:16.628420 [info ] [MainThread]: 
[0m12:35:16.628863 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:35:16.629141 [info ] [MainThread]: 
[0m12:35:16.629474 [error] [MainThread]:   Database Error in model stg_globepay_acceptance (models/staging/globepay/stg_globepay_acceptance.sql)
  002140 (42601): SQL compilation error:
  Unknown function TRY_TO_OBJECT
  compiled Code at target/run/deel_task/models/staging/globepay/stg_globepay_acceptance.sql
[0m12:35:16.629734 [info ] [MainThread]: 
[0m12:35:16.629994 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:35:16.632602 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5604951, "process_user_time": 1.251793, "process_kernel_time": 0.261221, "process_mem_max_rss": "134365184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:35:16.633149 [debug] [MainThread]: Command `dbt run` failed at 12:35:16.633075 after 2.56 seconds
[0m12:35:16.633503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c9c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff9190>]}
[0m12:35:16.633823 [debug] [MainThread]: Flushing usage events
[0m12:35:39.439459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107854fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c16cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f1100>]}


============================== 12:35:39.442529 | 4f2bdbd8-7f45-421c-bb43-2125034662d9 ==============================
[0m12:35:39.442529 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:35:39.442921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'profiles_dir': './profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_globepay_acceptance', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:35:39.745969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f2bdbd8-7f45-421c-bb43-2125034662d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a9010>]}
[0m12:35:39.768673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f2bdbd8-7f45-421c-bb43-2125034662d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860ee40>]}
[0m12:35:39.769395 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:35:39.780763 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:35:39.864977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:35:39.865375 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/stg_globepay_acceptance.sql
[0m12:35:39.982946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:35:39.988751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f2bdbd8-7f45-421c-bb43-2125034662d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109152ea0>]}
[0m12:35:40.038009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f2bdbd8-7f45-421c-bb43-2125034662d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109214bf0>]}
[0m12:35:40.038313 [info ] [MainThread]: Found 1 model, 2 sources, 444 macros
[0m12:35:40.038589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f2bdbd8-7f45-421c-bb43-2125034662d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b56090>]}
[0m12:35:40.039426 [info ] [MainThread]: 
[0m12:35:40.040067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:40.040631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:35:40.047384 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:35:40.047620 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:35:40.047780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:40.522279 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:35:40.526037 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:35:40.627754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m12:35:40.640449 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:35:40.641164 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:35:40.641677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:41.095882 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:35:41.101798 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:35:41.198742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f2bdbd8-7f45-421c-bb43-2125034662d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f85490>]}
[0m12:35:41.200025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:41.200603 [info ] [MainThread]: 
[0m12:35:41.204692 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_acceptance
[0m12:35:41.205620 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_STAGING.stg_globepay_acceptance ................ [RUN]
[0m12:35:41.206423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now model.deel_task.stg_globepay_acceptance)
[0m12:35:41.207193 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_acceptance
[0m12:35:41.217705 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_acceptance"
[0m12:35:41.219119 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_acceptance
[0m12:35:41.248005 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_acceptance"
[0m12:35:41.249583 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_acceptance"
[0m12:35:41.249986 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED as is_globepay_cvv_provided,
    DATE_TIME as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m12:35:41.250348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:41.799466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:35:41.832655 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: Close
[0m12:35:41.927885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f2bdbd8-7f45-421c-bb43-2125034662d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c11760>]}
[0m12:35:41.928951 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_STAGING.stg_globepay_acceptance ........... [[32mSUCCESS 1[0m in 0.72s]
[0m12:35:41.929766 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_acceptance
[0m12:35:41.931103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:41.931591 [debug] [MainThread]: Connection 'model.deel_task.stg_globepay_acceptance' was properly closed.
[0m12:35:41.932032 [info ] [MainThread]: 
[0m12:35:41.932485 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m12:35:41.933288 [debug] [MainThread]: Command end result
[0m12:35:41.959926 [info ] [MainThread]: 
[0m12:35:41.960382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:41.960661 [info ] [MainThread]: 
[0m12:35:41.960940 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:35:41.963751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5683842, "process_user_time": 1.275938, "process_kernel_time": 0.252734, "process_mem_max_rss": "134463488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:35:41.964270 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:41.964195 after 2.57 seconds
[0m12:35:41.964614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e14c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c42d50>]}
[0m12:35:41.964925 [debug] [MainThread]: Flushing usage events
[0m12:36:29.148097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107133110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107421040>]}


============================== 12:36:29.151112 | a5bb242d-c140-462f-8b02-b37846d292e1 ==============================
[0m12:36:29.151112 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:36:29.151500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': './profiles', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_globepay_acceptance', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:36:29.459170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5bb242d-c140-462f-8b02-b37846d292e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c9130>]}
[0m12:36:29.481601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5bb242d-c140-462f-8b02-b37846d292e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11149a930>]}
[0m12:36:29.482334 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:36:29.494017 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:36:29.576399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:29.576824 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/stg_globepay_acceptance.sql
[0m12:36:29.693572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:36:29.699284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5bb242d-c140-462f-8b02-b37846d292e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef9f10>]}
[0m12:36:29.749104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5bb242d-c140-462f-8b02-b37846d292e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f08bc0>]}
[0m12:36:29.749410 [info ] [MainThread]: Found 1 model, 2 sources, 444 macros
[0m12:36:29.749686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5bb242d-c140-462f-8b02-b37846d292e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d32ab0>]}
[0m12:36:29.750463 [info ] [MainThread]: 
[0m12:36:29.750776 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:36:29.751193 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:36:29.758109 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:36:29.758413 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:36:29.758596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:30.363926 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:36:30.366768 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:36:30.494365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW_STAGING'
[0m12:36:30.506943 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:36:30.507600 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:36:30.508033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:30.952518 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:36:30.957419 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:36:31.080313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5bb242d-c140-462f-8b02-b37846d292e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a0c830>]}
[0m12:36:31.081227 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:31.081767 [info ] [MainThread]: 
[0m12:36:31.085824 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_acceptance
[0m12:36:31.086688 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_STAGING.stg_globepay_acceptance ................ [RUN]
[0m12:36:31.087441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now model.deel_task.stg_globepay_acceptance)
[0m12:36:31.088222 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_acceptance
[0m12:36:31.098115 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_acceptance"
[0m12:36:31.099663 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_acceptance
[0m12:36:31.128320 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_acceptance"
[0m12:36:31.129952 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_acceptance"
[0m12:36:31.130359 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m12:36:31.130710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:31.699781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:36:31.733161 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: Close
[0m12:36:31.828921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5bb242d-c140-462f-8b02-b37846d292e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ac380>]}
[0m12:36:31.830009 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_STAGING.stg_globepay_acceptance ........... [[32mSUCCESS 1[0m in 0.74s]
[0m12:36:31.830792 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_acceptance
[0m12:36:31.832149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:31.832634 [debug] [MainThread]: Connection 'model.deel_task.stg_globepay_acceptance' was properly closed.
[0m12:36:31.833022 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW_STAGING' was properly closed.
[0m12:36:31.833443 [info ] [MainThread]: 
[0m12:36:31.833868 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m12:36:31.834614 [debug] [MainThread]: Command end result
[0m12:36:31.860406 [info ] [MainThread]: 
[0m12:36:31.860829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:31.861098 [info ] [MainThread]: 
[0m12:36:31.861370 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:36:31.863987 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7776785, "process_user_time": 1.278197, "process_kernel_time": 0.251923, "process_mem_max_rss": "134922240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:36:31.864467 [debug] [MainThread]: Command `dbt run` succeeded at 12:36:31.864400 after 2.78 seconds
[0m12:36:31.864790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e62f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107133110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107421220>]}
[0m12:36:31.865092 [debug] [MainThread]: Flushing usage events
[0m12:39:51.976753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fdefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce5490>]}


============================== 12:39:51.979804 | 1a3dc94d-f7eb-478c-a126-074ccff5dfa7 ==============================
[0m12:39:51.979804 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:39:51.980193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': './profiles', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -s stg_globepay_acceptance', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:52.288565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a3dc94d-f7eb-478c-a126-074ccff5dfa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b45280>]}
[0m12:39:52.311327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a3dc94d-f7eb-478c-a126-074ccff5dfa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581ab70>]}
[0m12:39:52.312005 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:39:52.322400 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:39:52.405789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:39:52.406239 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/_stg_globepay_models.yml
[0m12:39:52.501159 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:39:52.501533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a3dc94d-f7eb-478c-a126-074ccff5dfa7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596b9b0>]}
[0m12:39:52.577729 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:39:52.583505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a3dc94d-f7eb-478c-a126-074ccff5dfa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd41d0>]}
[0m12:39:52.649249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a3dc94d-f7eb-478c-a126-074ccff5dfa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed3710>]}
[0m12:39:52.649565 [info ] [MainThread]: Found 1 model, 2 data tests, 2 sources, 444 macros
[0m12:39:52.650519 [info ] [MainThread]: 
[0m12:39:52.650828 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:52.651262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:39:52.658457 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:39:52.658762 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:39:52.658944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:54.137846 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:39:54.141439 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:39:54.349881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m12:39:54.362341 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:39:54.362899 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:39:54.363342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:54.995085 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:39:54.999640 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:39:55.173244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a3dc94d-f7eb-478c-a126-074ccff5dfa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db5970>]}
[0m12:39:55.173829 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:55.174119 [info ] [MainThread]: 
[0m12:39:55.176563 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_acceptance
[0m12:39:55.176986 [info ] [Thread-1 (]: 1 of 3 START sql view model RAW_STAGING.stg_globepay_acceptance ................ [RUN]
[0m12:39:55.177303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now model.deel_task.stg_globepay_acceptance)
[0m12:39:55.177553 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_acceptance
[0m12:39:55.183040 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_acceptance"
[0m12:39:55.184069 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_acceptance
[0m12:39:55.237944 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_acceptance"
[0m12:39:55.239117 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_acceptance"
[0m12:39:55.239377 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m12:39:55.239594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:55.960637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:39:55.979549 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_acceptance: Close
[0m12:39:56.156191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a3dc94d-f7eb-478c-a126-074ccff5dfa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427c4a0>]}
[0m12:39:56.156924 [info ] [Thread-1 (]: 1 of 3 OK created sql view model RAW_STAGING.stg_globepay_acceptance ........... [[32mSUCCESS 1[0m in 0.98s]
[0m12:39:56.157573 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_acceptance
[0m12:39:56.158295 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256
[0m12:39:56.158767 [info ] [Thread-1 (]: 2 of 3 START test not_null_stg_globepay_acceptance_globepay_acceptance_id ...... [RUN]
[0m12:39:56.159213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay_acceptance, now test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256)
[0m12:39:56.159548 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256
[0m12:39:56.168406 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256"
[0m12:39:56.169589 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256
[0m12:39:56.180980 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256"
[0m12:39:56.182363 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256"
[0m12:39:56.182669 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m12:39:56.182920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:56.865093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:39:56.871054 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256: Close
[0m12:39:57.108181 [info ] [Thread-1 (]: 2 of 3 PASS not_null_stg_globepay_acceptance_globepay_acceptance_id ............ [[32mPASS[0m in 0.95s]
[0m12:39:57.109359 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256
[0m12:39:57.110055 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d
[0m12:39:57.110815 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_globepay_acceptance_globepay_acceptance_id ........ [RUN]
[0m12:39:57.111629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay_acceptance_globepay_acceptance_id.01388c8256, now test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d)
[0m12:39:57.112253 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d
[0m12:39:57.121493 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d"
[0m12:39:57.122901 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d
[0m12:39:57.127231 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d"
[0m12:39:57.129052 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d"
[0m12:39:57.129578 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay_acceptance
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:39:57.130000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:58.332302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:39:58.337558 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d: Close
[0m12:39:58.515193 [info ] [Thread-1 (]: 3 of 3 PASS unique_stg_globepay_acceptance_globepay_acceptance_id .............. [[32mPASS[0m in 1.40s]
[0m12:39:58.516580 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d
[0m12:39:58.518142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:58.518670 [debug] [MainThread]: Connection 'test.deel_task.unique_stg_globepay_acceptance_globepay_acceptance_id.42d2dffe7d' was properly closed.
[0m12:39:58.519189 [info ] [MainThread]: 
[0m12:39:58.519679 [info ] [MainThread]: Finished running 1 view model, 2 data tests in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m12:39:58.520915 [debug] [MainThread]: Command end result
[0m12:39:58.552851 [info ] [MainThread]: 
[0m12:39:58.553343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:58.553656 [info ] [MainThread]: 
[0m12:39:58.553962 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:39:58.556230 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.630505, "process_user_time": 1.552944, "process_kernel_time": 0.252896, "process_mem_max_rss": "139296768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:39:58.556926 [debug] [MainThread]: Command `dbt build` succeeded at 12:39:58.556848 after 6.63 seconds
[0m12:39:58.557298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a38f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fdefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2f140>]}
[0m12:39:58.557637 [debug] [MainThread]: Flushing usage events
[0m12:44:34.453704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1d280>]}


============================== 12:44:34.456895 | 3438b40e-4114-41e0-9dd0-dad8abf327bc ==============================
[0m12:44:34.456895 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:44:34.457245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -s stg_globepay_chargeback', 'send_anonymous_usage_stats': 'True'}
[0m12:44:34.764130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3438b40e-4114-41e0-9dd0-dad8abf327bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076561b0>]}
[0m12:44:34.786798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3438b40e-4114-41e0-9dd0-dad8abf327bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a9130>]}
[0m12:44:34.787570 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:44:34.798859 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:44:34.853534 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading deel_task: staging/globepay/_stg_globepay_models.yml - Runtime Error
    Syntax error near line 44
    ------------------------------
    41 |         data_type: varchar
    42 |   - name: stg_globepay_chargeback
    43 |     description: "Model to process and document the Globepay chargeback data for Deel clients."
    44 |         columns:
    45 |           - name: globepay_acceptance_id
    46 |             description: "The external reference ID for the accepted transaction, linking to the acceptance report."
    47 |             data_type: varchar
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 42, column 5
    did not find expected key
      in "<unicode string>", line 44, column 9
[0m12:44:34.855878 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.44414088, "process_user_time": 0.807099, "process_kernel_time": 0.199252, "process_mem_max_rss": "117686272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:44:34.856259 [debug] [MainThread]: Command `dbt build` failed at 12:44:34.856204 after 0.44 seconds
[0m12:44:34.856496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d0680>]}
[0m12:44:34.856705 [debug] [MainThread]: Flushing usage events
[0m12:45:18.384963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109047a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad5100>]}


============================== 12:45:18.388117 | 3d549b3b-bbbc-43e7-ae94-c192374740a1 ==============================
[0m12:45:18.388117 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:45:18.388516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'profiles_dir': './profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s stg_globepay_chargeback', 'send_anonymous_usage_stats': 'True'}
[0m12:45:18.707716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d549b3b-bbbc-43e7-ae94-c192374740a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f92e0>]}
[0m12:45:18.730535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d549b3b-bbbc-43e7-ae94-c192374740a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c961550>]}
[0m12:45:18.731211 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:45:18.745379 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:45:18.842301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:45:18.842644 [debug] [MainThread]: Partial parsing: added file: deel_task://models/staging/globepay/stg_globepay_chargeback.sql
[0m12:45:18.842908 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/_stg_globepay_models.yml
[0m12:45:18.939055 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:45:18.940216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d549b3b-bbbc-43e7-ae94-c192374740a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d075400>]}
[0m12:45:19.009477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:45:19.015257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d549b3b-bbbc-43e7-ae94-c192374740a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d001a30>]}
[0m12:45:19.080684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d549b3b-bbbc-43e7-ae94-c192374740a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db8bce0>]}
[0m12:45:19.080995 [info ] [MainThread]: Found 2 models, 4 data tests, 2 sources, 444 macros
[0m12:45:19.081869 [info ] [MainThread]: 
[0m12:45:19.082188 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:19.082620 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:45:19.089638 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:45:19.089948 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:45:19.090133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:20.087234 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:45:20.090405 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:45:20.271527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m12:45:20.283437 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:45:20.283965 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:45:20.284384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:21.071318 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:21.076524 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:45:21.273458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d549b3b-bbbc-43e7-ae94-c192374740a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd13f20>]}
[0m12:45:21.274775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:21.275577 [info ] [MainThread]: 
[0m12:45:21.279539 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_chargeback
[0m12:45:21.280389 [info ] [Thread-1 (]: 1 of 3 START sql view model RAW_STAGING.stg_globepay_chargeback ................ [RUN]
[0m12:45:21.281127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now model.deel_task.stg_globepay_chargeback)
[0m12:45:21.281841 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_chargeback
[0m12:45:21.293062 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_chargeback"
[0m12:45:21.294740 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_chargeback
[0m12:45:21.357666 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_chargeback"
[0m12:45:21.358770 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_chargeback"
[0m12:45:21.359046 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_acceptance
  );
[0m12:45:21.359277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:21.907580 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dbe5-0000-6d00-0000-0000ca654275
[0m12:45:21.908286 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEEL_HOME_TEST.RAW_STAGING.LOAD_ACCEPTANCE' does not exist or not authorized.
[0m12:45:21.908937 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_chargeback: Close
[0m12:45:22.093673 [debug] [Thread-1 (]: Database Error in model stg_globepay_chargeback (models/staging/globepay/stg_globepay_chargeback.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEEL_HOME_TEST.RAW_STAGING.LOAD_ACCEPTANCE' does not exist or not authorized.
  compiled Code at target/run/deel_task/models/staging/globepay/stg_globepay_chargeback.sql
[0m12:45:22.096103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d549b3b-bbbc-43e7-ae94-c192374740a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca41a0>]}
[0m12:45:22.096960 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model RAW_STAGING.stg_globepay_chargeback ....... [[31mERROR[0m in 0.81s]
[0m12:45:22.097745 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_chargeback
[0m12:45:22.099002 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155
[0m12:45:22.099649 [info ] [Thread-1 (]: 2 of 3 SKIP test not_null_stg_globepay_chargeback_globepay_acceptance_id ....... [[33mSKIP[0m]
[0m12:45:22.100293 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155
[0m12:45:22.100922 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c
[0m12:45:22.101498 [info ] [Thread-1 (]: 3 of 3 SKIP test unique_stg_globepay_chargeback_globepay_acceptance_id ......... [[33mSKIP[0m]
[0m12:45:22.102012 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c
[0m12:45:22.103364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:22.103847 [debug] [MainThread]: Connection 'model.deel_task.stg_globepay_chargeback' was properly closed.
[0m12:45:22.104290 [info ] [MainThread]: 
[0m12:45:22.104710 [info ] [MainThread]: Finished running 1 view model, 2 data tests in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m12:45:22.105563 [debug] [MainThread]: Command end result
[0m12:45:22.130936 [info ] [MainThread]: 
[0m12:45:22.131376 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:45:22.131656 [info ] [MainThread]: 
[0m12:45:22.131987 [error] [MainThread]:   Database Error in model stg_globepay_chargeback (models/staging/globepay/stg_globepay_chargeback.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEEL_HOME_TEST.RAW_STAGING.LOAD_ACCEPTANCE' does not exist or not authorized.
  compiled Code at target/run/deel_task/models/staging/globepay/stg_globepay_chargeback.sql
[0m12:45:22.132263 [info ] [MainThread]: 
[0m12:45:22.132520 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m12:45:22.135848 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 3.7925267, "process_user_time": 1.420359, "process_kernel_time": 0.269073, "process_mem_max_rss": "137117696", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:45:22.136412 [debug] [MainThread]: Command `dbt build` failed at 12:45:22.136338 after 3.79 seconds
[0m12:45:22.136758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1e1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d075790>]}
[0m12:45:22.137055 [debug] [MainThread]: Flushing usage events
[0m12:45:33.243028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046686b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b52b0>]}


============================== 12:45:33.246084 | 2232a1f3-8889-49be-b604-f37f04b16279 ==============================
[0m12:45:33.246084 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:45:33.246478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -s stg_globepay_chargeback', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:33.544637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2232a1f3-8889-49be-b604-f37f04b16279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d13d0>]}
[0m12:45:33.567238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2232a1f3-8889-49be-b604-f37f04b16279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109624d40>]}
[0m12:45:33.568711 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:45:33.581074 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:45:33.673616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:33.674024 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/stg_globepay_chargeback.sql
[0m12:45:33.765023 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:45:33.765388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2232a1f3-8889-49be-b604-f37f04b16279', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106758d40>]}
[0m12:45:33.834646 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.deel_task.mart.product
[0m12:45:33.840383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2232a1f3-8889-49be-b604-f37f04b16279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e19a0>]}
[0m12:45:33.906417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2232a1f3-8889-49be-b604-f37f04b16279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab8be90>]}
[0m12:45:33.906804 [info ] [MainThread]: Found 2 models, 4 data tests, 2 sources, 444 macros
[0m12:45:33.908228 [info ] [MainThread]: 
[0m12:45:33.908590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:33.909054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:45:33.916191 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:45:33.916523 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:45:33.916702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:34.719696 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:45:34.722710 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:45:34.901128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m12:45:34.912767 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:45:34.913313 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:45:34.913763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:35.766036 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:35.769529 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:45:35.971103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2232a1f3-8889-49be-b604-f37f04b16279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fad970>]}
[0m12:45:35.972379 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:35.973078 [info ] [MainThread]: 
[0m12:45:35.977110 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay_chargeback
[0m12:45:35.977981 [info ] [Thread-1 (]: 1 of 3 START sql view model RAW_STAGING.stg_globepay_chargeback ................ [RUN]
[0m12:45:35.978745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now model.deel_task.stg_globepay_chargeback)
[0m12:45:35.979455 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay_chargeback
[0m12:45:35.990847 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay_chargeback"
[0m12:45:35.992257 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay_chargeback
[0m12:45:36.055138 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay_chargeback"
[0m12:45:36.056169 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay_chargeback"
[0m12:45:36.056456 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay_chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay_chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_chargeback
  );
[0m12:45:36.056705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:36.711735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:36.739107 [debug] [Thread-1 (]: On model.deel_task.stg_globepay_chargeback: Close
[0m12:45:36.904700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2232a1f3-8889-49be-b604-f37f04b16279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f480b0>]}
[0m12:45:36.905646 [info ] [Thread-1 (]: 1 of 3 OK created sql view model RAW_STAGING.stg_globepay_chargeback ........... [[32mSUCCESS 1[0m in 0.92s]
[0m12:45:36.906346 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay_chargeback
[0m12:45:36.907228 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155
[0m12:45:36.907787 [info ] [Thread-1 (]: 2 of 3 START test not_null_stg_globepay_chargeback_globepay_acceptance_id ...... [RUN]
[0m12:45:36.908289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay_chargeback, now test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155)
[0m12:45:36.908677 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155
[0m12:45:36.923779 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155"
[0m12:45:36.925224 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155
[0m12:45:36.942281 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155"
[0m12:45:36.943584 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155"
[0m12:45:36.944048 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay_chargeback
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m12:45:36.944432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:37.796632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:37.805548 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155: Close
[0m12:45:37.982597 [info ] [Thread-1 (]: 2 of 3 PASS not_null_stg_globepay_chargeback_globepay_acceptance_id ............ [[32mPASS[0m in 1.07s]
[0m12:45:37.984270 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155
[0m12:45:37.985470 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c
[0m12:45:37.986313 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_globepay_chargeback_globepay_acceptance_id ........ [RUN]
[0m12:45:37.987138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay_chargeback_globepay_acceptance_id.e1a1b7a155, now test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c)
[0m12:45:37.987763 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c
[0m12:45:37.997787 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c"
[0m12:45:37.999239 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c
[0m12:45:38.003223 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c"
[0m12:45:38.005157 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c"
[0m12:45:38.005794 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay_chargeback
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:45:38.006315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:38.694599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:38.697873 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c: Close
[0m12:45:38.867642 [info ] [Thread-1 (]: 3 of 3 PASS unique_stg_globepay_chargeback_globepay_acceptance_id .............. [[32mPASS[0m in 0.88s]
[0m12:45:38.869478 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c
[0m12:45:38.871315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:38.871844 [debug] [MainThread]: Connection 'test.deel_task.unique_stg_globepay_chargeback_globepay_acceptance_id.b6c213077c' was properly closed.
[0m12:45:38.872350 [info ] [MainThread]: 
[0m12:45:38.872842 [info ] [MainThread]: Finished running 1 view model, 2 data tests in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m12:45:38.874229 [debug] [MainThread]: Command end result
[0m12:45:38.906740 [info ] [MainThread]: 
[0m12:45:38.907236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:38.907560 [info ] [MainThread]: 
[0m12:45:38.907879 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:45:38.910205 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.714812, "process_user_time": 1.639614, "process_kernel_time": 0.263823, "process_mem_max_rss": "138493952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:45:38.910813 [debug] [MainThread]: Command `dbt build` succeeded at 12:45:38.910727 after 5.72 seconds
[0m12:45:38.911191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097678f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064063f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd44d0>]}
[0m12:45:38.911541 [debug] [MainThread]: Flushing usage events
[0m12:56:05.531972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104591340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104591070>]}


============================== 12:56:05.534930 | 4eb2b917-0e1e-4b4a-96a1-29e198137f68 ==============================
[0m12:56:05.534930 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:56:05.535284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'profiles_dir': './profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -s +fct_globepay__transactions', 'send_anonymous_usage_stats': 'True'}
[0m12:56:05.845206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eb2b917-0e1e-4b4a-96a1-29e198137f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d67920>]}
[0m12:56:05.867968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eb2b917-0e1e-4b4a-96a1-29e198137f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104591940>]}
[0m12:56:05.868716 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:56:05.881799 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:56:05.973648 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 4 files added, 1 files changed.
[0m12:56:05.974018 [debug] [MainThread]: Partial parsing: added file: deel_task://models/mart/product/fct_globepay__transactions.sql
[0m12:56:05.974224 [debug] [MainThread]: Partial parsing: added file: deel_task://models/mart/product/_mart_product_models.yml
[0m12:56:05.974397 [debug] [MainThread]: Partial parsing: added file: deel_task://models/staging/globepay/stg_globepay__acceptance.sql
[0m12:56:05.974558 [debug] [MainThread]: Partial parsing: added file: deel_task://models/staging/globepay/stg_globepay__chargeback.sql
[0m12:56:05.974829 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/_stg_globepay_models.yml
[0m12:56:05.974993 [debug] [MainThread]: Partial parsing: deleted file: deel_task://models/staging/globepay/stg_globepay_chargeback.sql
[0m12:56:05.975135 [debug] [MainThread]: Partial parsing: deleted file: deel_task://models/staging/globepay/stg_globepay_acceptance.sql
[0m12:56:06.077467 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:56:06.077842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4eb2b917-0e1e-4b4a-96a1-29e198137f68', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b4fb0>]}
[0m12:56:06.155918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eb2b917-0e1e-4b4a-96a1-29e198137f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558f9e0>]}
[0m12:56:06.218092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eb2b917-0e1e-4b4a-96a1-29e198137f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568a870>]}
[0m12:56:06.218497 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 444 macros
[0m12:56:06.219627 [info ] [MainThread]: 
[0m12:56:06.219963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:06.221964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:56:06.229313 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:56:06.229588 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:56:06.229777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:07.162713 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:56:07.166850 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:56:07.343661 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:56:07.344355 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:56:07.344874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:07.972592 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:56:07.976977 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:56:08.143784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now create_DEEL_HOME_TEST_RAW_MART)
[0m12:56:08.144812 [debug] [ThreadPool]: Creating schema "database: "DEEL_HOME_TEST"
schema: "RAW_MART"
"
[0m12:56:08.203402 [debug] [ThreadPool]: Using snowflake connection "create_DEEL_HOME_TEST_RAW_MART"
[0m12:56:08.203838 [debug] [ThreadPool]: On create_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "create_DEEL_HOME_TEST_RAW_MART"} */
create schema if not exists DEEL_HOME_TEST.RAW_MART
[0m12:56:08.204082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:08.804424 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:08.807799 [debug] [ThreadPool]: On create_DEEL_HOME_TEST_RAW_MART: Close
[0m12:56:08.983784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW_STAGING'
[0m12:56:08.996698 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:56:08.997269 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:56:08.997683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:09.749711 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:56:09.754174 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:56:09.921705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now list_DEEL_HOME_TEST_RAW_MART)
[0m12:56:09.926131 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m12:56:09.927092 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m12:56:09.927594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:10.506365 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m12:56:10.507519 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m12:56:10.673496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb2b917-0e1e-4b4a-96a1-29e198137f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dc9310>]}
[0m12:56:10.674504 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:10.675075 [info ] [MainThread]: 
[0m12:56:10.678494 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__acceptance
[0m12:56:10.679240 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW_STAGING.stg_globepay__acceptance ............... [RUN]
[0m12:56:10.679829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_DEEL_HOME_TEST_RAW_MART, now model.deel_task.stg_globepay__acceptance)
[0m12:56:10.680308 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__acceptance
[0m12:56:10.690527 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__acceptance"
[0m12:56:10.691898 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__acceptance
[0m12:56:10.719373 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__acceptance"
[0m12:56:10.721077 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__acceptance"
[0m12:56:10.721469 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m12:56:10.721781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:11.451149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:11.478852 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: Close
[0m12:56:11.685982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eb2b917-0e1e-4b4a-96a1-29e198137f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b34200>]}
[0m12:56:11.687294 [info ] [Thread-1 (]: 1 of 7 OK created sql view model RAW_STAGING.stg_globepay__acceptance .......... [[32mSUCCESS 1[0m in 1.00s]
[0m12:56:11.688246 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__acceptance
[0m12:56:11.688940 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__chargeback
[0m12:56:11.689851 [info ] [Thread-1 (]: 2 of 7 START sql view model RAW_STAGING.stg_globepay__chargeback ............... [RUN]
[0m12:56:11.690848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__acceptance, now model.deel_task.stg_globepay__chargeback)
[0m12:56:11.691509 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__chargeback
[0m12:56:11.695912 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__chargeback"
[0m12:56:11.697374 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__chargeback
[0m12:56:11.702494 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__chargeback"
[0m12:56:11.704258 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__chargeback"
[0m12:56:11.704874 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_chargeback
  );
[0m12:56:11.705412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:12.381076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:12.384559 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: Close
[0m12:56:12.600413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eb2b917-0e1e-4b4a-96a1-29e198137f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551d5b0>]}
[0m12:56:12.602140 [info ] [Thread-1 (]: 2 of 7 OK created sql view model RAW_STAGING.stg_globepay__chargeback .......... [[32mSUCCESS 1[0m in 0.91s]
[0m12:56:12.603425 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__chargeback
[0m12:56:12.604303 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m12:56:12.605169 [info ] [Thread-1 (]: 3 of 7 START test not_null_stg_globepay__acceptance_globepay_acceptance_id ..... [RUN]
[0m12:56:12.605910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__chargeback, now test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f)
[0m12:56:12.606479 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m12:56:12.623639 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m12:56:12.626131 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m12:56:12.642646 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m12:56:12.644151 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m12:56:12.644634 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m12:56:12.645007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:13.280095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:13.286439 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: Close
[0m12:56:13.457005 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stg_globepay__acceptance_globepay_acceptance_id ........... [[32mPASS[0m in 0.85s]
[0m12:56:13.458804 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m12:56:13.459692 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m12:56:13.460477 [info ] [Thread-1 (]: 4 of 7 START test unique_stg_globepay__acceptance_globepay_acceptance_id ....... [RUN]
[0m12:56:13.461320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f, now test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4)
[0m12:56:13.461963 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m12:56:13.472041 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m12:56:13.473464 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m12:56:13.476783 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m12:56:13.478821 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m12:56:13.479457 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:56:13.479977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:14.126539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:14.130447 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: Close
[0m12:56:14.318428 [info ] [Thread-1 (]: 4 of 7 PASS unique_stg_globepay__acceptance_globepay_acceptance_id ............. [[32mPASS[0m in 0.86s]
[0m12:56:14.319970 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m12:56:14.320697 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m12:56:14.321464 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_globepay__chargeback_globepay_acceptance_id ..... [RUN]
[0m12:56:14.322319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4, now test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657)
[0m12:56:14.322938 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m12:56:14.329777 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m12:56:14.331208 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m12:56:14.335110 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m12:56:14.336894 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m12:56:14.337438 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m12:56:14.337919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:14.988940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:14.991030 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: Close
[0m12:56:15.164443 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_globepay__chargeback_globepay_acceptance_id ........... [[32mPASS[0m in 0.84s]
[0m12:56:15.165600 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m12:56:15.166219 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m12:56:15.166856 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_globepay__chargeback_globepay_acceptance_id ....... [RUN]
[0m12:56:15.169550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657, now test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec)
[0m12:56:15.170068 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m12:56:15.172803 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m12:56:15.173486 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m12:56:15.175309 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m12:56:15.176819 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m12:56:15.177747 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:56:15.178029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:15.822170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:15.824870 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: Close
[0m12:56:16.000241 [info ] [Thread-1 (]: 6 of 7 PASS unique_stg_globepay__chargeback_globepay_acceptance_id ............. [[32mPASS[0m in 0.83s]
[0m12:56:16.001770 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m12:56:16.002854 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay__transactions
[0m12:56:16.004806 [info ] [Thread-1 (]: 7 of 7 START sql view model RAW_MART.fct_globepay__transactions ................ [RUN]
[0m12:56:16.005670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec, now model.deel_task.fct_globepay__transactions)
[0m12:56:16.006287 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay__transactions
[0m12:56:16.011046 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay__transactions"
[0m12:56:16.013137 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay__transactions
[0m12:56:16.018613 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay__transactions"
[0m12:56:16.021381 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay__transactions"
[0m12:56:16.021972 [debug] [Thread-1 (]: On model.deel_task.fct_globepay__transactions: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay__transactions"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay__transactions
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_status,
    acceptance.globepay_chargeback_status,
    chargeback.is_globepay_chargeback,
    chargeback.is_globepay_cvv_provided
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m12:56:16.022507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:16.667839 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dbf0-0000-6d00-0000-0000ca6542b5
[0m12:56:16.668550 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 4
invalid identifier 'ACCEPTANCE.GLOBEPAY_CHARGEBACK_STATUS'
[0m12:56:16.669222 [debug] [Thread-1 (]: On model.deel_task.fct_globepay__transactions: Close
[0m12:56:16.870849 [debug] [Thread-1 (]: Database Error in model fct_globepay__transactions (models/mart/product/fct_globepay__transactions.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'ACCEPTANCE.GLOBEPAY_CHARGEBACK_STATUS'
  compiled Code at target/run/deel_task/models/mart/product/fct_globepay__transactions.sql
[0m12:56:16.871522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eb2b917-0e1e-4b4a-96a1-29e198137f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1018ca030>]}
[0m12:56:16.871967 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model RAW_MART.fct_globepay__transactions ....... [[31mERROR[0m in 0.87s]
[0m12:56:16.872377 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay__transactions
[0m12:56:16.873395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:16.873637 [debug] [MainThread]: Connection 'model.deel_task.fct_globepay__transactions' was properly closed.
[0m12:56:16.873807 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW_MART' was properly closed.
[0m12:56:16.874026 [info ] [MainThread]: 
[0m12:56:16.874377 [info ] [MainThread]: Finished running 3 view models, 4 data tests in 0 hours 0 minutes and 10.65 seconds (10.65s).
[0m12:56:16.875182 [debug] [MainThread]: Command end result
[0m12:56:16.898192 [info ] [MainThread]: 
[0m12:56:16.898625 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:56:16.898814 [info ] [MainThread]: 
[0m12:56:16.899044 [error] [MainThread]:   Database Error in model fct_globepay__transactions (models/mart/product/fct_globepay__transactions.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'ACCEPTANCE.GLOBEPAY_CHARGEBACK_STATUS'
  compiled Code at target/run/deel_task/models/mart/product/fct_globepay__transactions.sql
[0m12:56:16.899222 [info ] [MainThread]: 
[0m12:56:16.899402 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:56:16.901764 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.413462, "process_user_time": 2.241581, "process_kernel_time": 0.367537, "process_mem_max_rss": "135446528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:56:16.902782 [debug] [MainThread]: Command `dbt build` failed at 12:56:16.902702 after 11.41 seconds
[0m12:56:16.903135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10401d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dea20>]}
[0m12:56:16.903400 [debug] [MainThread]: Flushing usage events
[0m12:56:37.059726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cf7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104781640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104781370>]}


============================== 12:56:37.062764 | 00fa8a05-61a7-4a36-be41-7bfb52ff89cc ==============================
[0m12:56:37.062764 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:56:37.063127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'profiles_dir': './profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -s +fct_globepay__transactions', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:56:37.364472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00fa8a05-61a7-4a36-be41-7bfb52ff89cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f57a70>]}
[0m12:56:37.386967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00fa8a05-61a7-4a36-be41-7bfb52ff89cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069046b0>]}
[0m12:56:37.387647 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m12:56:37.398386 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:56:37.492907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:56:37.493313 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/mart/product/fct_globepay__transactions.sql
[0m12:56:37.619596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00fa8a05-61a7-4a36-be41-7bfb52ff89cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812ae10>]}
[0m12:56:37.681203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00fa8a05-61a7-4a36-be41-7bfb52ff89cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d6240>]}
[0m12:56:37.681512 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 444 macros
[0m12:56:37.682647 [info ] [MainThread]: 
[0m12:56:37.682971 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:37.684910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m12:56:37.692063 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:56:37.692464 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:56:37.692662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:38.715670 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:56:38.719808 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:56:38.928472 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m12:56:38.929213 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m12:56:38.929737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:39.493211 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:56:39.497235 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m12:56:39.678812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m12:56:39.691596 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m12:56:39.692271 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m12:56:39.692676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:40.336677 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:56:40.341677 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m12:56:40.542465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now list_DEEL_HOME_TEST_RAW_MART)
[0m12:56:40.546967 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m12:56:40.547529 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m12:56:40.548003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:41.185326 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m12:56:41.189792 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m12:56:41.358039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00fa8a05-61a7-4a36-be41-7bfb52ff89cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107699f40>]}
[0m12:56:41.358842 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:41.359251 [info ] [MainThread]: 
[0m12:56:41.361984 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__acceptance
[0m12:56:41.362584 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW_STAGING.stg_globepay__acceptance ............... [RUN]
[0m12:56:41.363069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now model.deel_task.stg_globepay__acceptance)
[0m12:56:41.363469 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__acceptance
[0m12:56:41.373467 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__acceptance"
[0m12:56:41.374654 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__acceptance
[0m12:56:41.404479 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__acceptance"
[0m12:56:41.406026 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__acceptance"
[0m12:56:41.406451 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m12:56:41.406798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:42.274774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:42.306668 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: Close
[0m12:56:42.504366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fa8a05-61a7-4a36-be41-7bfb52ff89cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a1eb0>]}
[0m12:56:42.505605 [info ] [Thread-1 (]: 1 of 7 OK created sql view model RAW_STAGING.stg_globepay__acceptance .......... [[32mSUCCESS 1[0m in 1.14s]
[0m12:56:42.506561 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__acceptance
[0m12:56:42.507272 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__chargeback
[0m12:56:42.508203 [info ] [Thread-1 (]: 2 of 7 START sql view model RAW_STAGING.stg_globepay__chargeback ............... [RUN]
[0m12:56:42.509204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__acceptance, now model.deel_task.stg_globepay__chargeback)
[0m12:56:42.509941 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__chargeback
[0m12:56:42.514234 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__chargeback"
[0m12:56:42.515761 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__chargeback
[0m12:56:42.520722 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__chargeback"
[0m12:56:42.522701 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__chargeback"
[0m12:56:42.523291 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_chargeback
  );
[0m12:56:42.523778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:43.168296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:43.173649 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: Close
[0m12:56:43.354532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fa8a05-61a7-4a36-be41-7bfb52ff89cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762a0c0>]}
[0m12:56:43.356270 [info ] [Thread-1 (]: 2 of 7 OK created sql view model RAW_STAGING.stg_globepay__chargeback .......... [[32mSUCCESS 1[0m in 0.85s]
[0m12:56:43.357531 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__chargeback
[0m12:56:43.358352 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m12:56:43.359135 [info ] [Thread-1 (]: 3 of 7 START test not_null_stg_globepay__acceptance_globepay_acceptance_id ..... [RUN]
[0m12:56:43.360097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__chargeback, now test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f)
[0m12:56:43.360710 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m12:56:43.376734 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m12:56:43.378080 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m12:56:43.394059 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m12:56:43.395516 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m12:56:43.395929 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m12:56:43.396285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:44.010318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:44.017466 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: Close
[0m12:56:44.187874 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stg_globepay__acceptance_globepay_acceptance_id ........... [[32mPASS[0m in 0.83s]
[0m12:56:44.189021 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m12:56:44.189716 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m12:56:44.190430 [info ] [Thread-1 (]: 4 of 7 START test unique_stg_globepay__acceptance_globepay_acceptance_id ....... [RUN]
[0m12:56:44.191274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f, now test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4)
[0m12:56:44.191900 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m12:56:44.200576 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m12:56:44.201971 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m12:56:44.205103 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m12:56:44.206529 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m12:56:44.207000 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:56:44.207445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:44.973011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:44.978023 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: Close
[0m12:56:45.155922 [info ] [Thread-1 (]: 4 of 7 PASS unique_stg_globepay__acceptance_globepay_acceptance_id ............. [[32mPASS[0m in 0.96s]
[0m12:56:45.162915 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m12:56:45.164190 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m12:56:45.164737 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_globepay__chargeback_globepay_acceptance_id ..... [RUN]
[0m12:56:45.165300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4, now test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657)
[0m12:56:45.165829 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m12:56:45.173317 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m12:56:45.174459 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m12:56:45.176763 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m12:56:45.178158 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m12:56:45.178616 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m12:56:45.178985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:45.844067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:45.846223 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: Close
[0m12:56:46.008256 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_globepay__chargeback_globepay_acceptance_id ........... [[32mPASS[0m in 0.84s]
[0m12:56:46.009355 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m12:56:46.010002 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m12:56:46.010625 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_globepay__chargeback_globepay_acceptance_id ....... [RUN]
[0m12:56:46.011278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657, now test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec)
[0m12:56:46.011820 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m12:56:46.014991 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m12:56:46.016884 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m12:56:46.018908 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m12:56:46.020240 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m12:56:46.020610 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:56:46.020872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:46.603790 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:46.606139 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: Close
[0m12:56:46.772667 [info ] [Thread-1 (]: 6 of 7 PASS unique_stg_globepay__chargeback_globepay_acceptance_id ............. [[32mPASS[0m in 0.76s]
[0m12:56:46.773793 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m12:56:46.774722 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay__transactions
[0m12:56:46.775753 [info ] [Thread-1 (]: 7 of 7 START sql view model RAW_MART.fct_globepay__transactions ................ [RUN]
[0m12:56:46.776695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec, now model.deel_task.fct_globepay__transactions)
[0m12:56:46.777410 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay__transactions
[0m12:56:46.781859 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay__transactions"
[0m12:56:46.783132 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay__transactions
[0m12:56:46.786977 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay__transactions"
[0m12:56:46.789289 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay__transactions"
[0m12:56:46.789785 [debug] [Thread-1 (]: On model.deel_task.fct_globepay__transactions: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay__transactions"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay__transactions
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_status,
    chargeback.globepay_chargeback_status,
    chargeback.is_globepay_chargeback,
    acceptance.is_globepay_cvv_provided
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m12:56:46.790254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:47.695869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:47.700925 [debug] [Thread-1 (]: On model.deel_task.fct_globepay__transactions: Close
[0m12:56:47.867304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fa8a05-61a7-4a36-be41-7bfb52ff89cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d2300>]}
[0m12:56:47.868989 [info ] [Thread-1 (]: 7 of 7 OK created sql view model RAW_MART.fct_globepay__transactions ........... [[32mSUCCESS 1[0m in 1.09s]
[0m12:56:47.870120 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay__transactions
[0m12:56:47.871874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:47.872477 [debug] [MainThread]: Connection 'model.deel_task.fct_globepay__transactions' was properly closed.
[0m12:56:47.873074 [info ] [MainThread]: 
[0m12:56:47.873672 [info ] [MainThread]: Finished running 3 view models, 4 data tests in 0 hours 0 minutes and 10.19 seconds (10.19s).
[0m12:56:47.875852 [debug] [MainThread]: Command end result
[0m12:56:47.909058 [info ] [MainThread]: 
[0m12:56:47.909597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:47.909920 [info ] [MainThread]: 
[0m12:56:47.910288 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:56:47.913189 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.89294, "process_user_time": 2.150519, "process_kernel_time": 0.360066, "process_mem_max_rss": "138166272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:56:47.913649 [debug] [MainThread]: Command `dbt build` succeeded at 12:56:47.913580 after 10.89 seconds
[0m12:56:47.913962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104781700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104781370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107778d10>]}
[0m12:56:47.914279 [debug] [MainThread]: Flushing usage events
[0m13:00:52.165316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105538530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189e5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189e5010>]}


============================== 13:00:52.168523 | f25e1d9d-085a-48c1-a275-b1f8b0f2f499 ==============================
[0m13:00:52.168523 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:00:52.168897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_globepay', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:00:52.480721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f25e1d9d-085a-48c1-a275-b1f8b0f2f499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079758b0>]}
[0m13:00:52.503539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f25e1d9d-085a-48c1-a275-b1f8b0f2f499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189e5640>]}
[0m13:00:52.504258 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m13:00:52.521257 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:00:52.621873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:00:52.622225 [debug] [MainThread]: Partial parsing: added file: deel_task://models/mart/product/dim_globepay.sql
[0m13:00:52.725776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f25e1d9d-085a-48c1-a275-b1f8b0f2f499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8af2f0>]}
[0m13:00:52.780874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f25e1d9d-085a-48c1-a275-b1f8b0f2f499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a693590>]}
[0m13:00:52.781188 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 444 macros
[0m13:00:52.781391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f25e1d9d-085a-48c1-a275-b1f8b0f2f499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118805f40>]}
[0m13:00:52.782179 [info ] [MainThread]: 
[0m13:00:52.782497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:52.782915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m13:00:52.789585 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:00:52.789860 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:00:52.790040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:53.892120 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:00:53.895686 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:00:54.078139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m13:00:54.089513 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m13:00:54.090046 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m13:00:54.090461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:54.672024 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:00:54.677964 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m13:00:54.851008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now list_DEEL_HOME_TEST_RAW_MART)
[0m13:00:54.856463 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m13:00:54.857053 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m13:00:54.857538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:55.464057 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:00:55.468592 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m13:00:55.642776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f25e1d9d-085a-48c1-a275-b1f8b0f2f499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9157f0>]}
[0m13:00:55.644028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:00:55.644639 [info ] [MainThread]: 
[0m13:00:55.648736 [debug] [Thread-1 (]: Began running node model.deel_task.dim_globepay
[0m13:00:55.649640 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_MART.dim_globepay .............................. [RUN]
[0m13:00:55.650420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now model.deel_task.dim_globepay)
[0m13:00:55.651037 [debug] [Thread-1 (]: Began compiling node model.deel_task.dim_globepay
[0m13:00:55.660923 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.dim_globepay"
[0m13:00:55.662482 [debug] [Thread-1 (]: Began executing node model.deel_task.dim_globepay
[0m13:00:55.690355 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.dim_globepay"
[0m13:00:55.692190 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.dim_globepay"
[0m13:00:55.692703 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.dim_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.dim_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    chargeback.globepay_chargeback_source,
    acceptance.globepay_country,
    acceptance.globepay_currency,
    acceptance.globepay_acceptance_rates,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_source,
    acceptance.globepay_acceptance_state
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:00:55.693084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:56.322927 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dbf4-0000-6d29-0000-0000ca653419
[0m13:00:56.323708 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'GLOBEPAY_ACCEPTANCE_EVENT_ID'
[0m13:00:56.324362 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: Close
[0m13:00:56.509463 [debug] [Thread-1 (]: Database Error in model dim_globepay (models/mart/product/dim_globepay.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'GLOBEPAY_ACCEPTANCE_EVENT_ID'
  compiled Code at target/run/deel_task/models/mart/product/dim_globepay.sql
[0m13:00:56.512029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25e1d9d-085a-48c1-a275-b1f8b0f2f499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a00b0>]}
[0m13:00:56.513073 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW_MART.dim_globepay ..................... [[31mERROR[0m in 0.86s]
[0m13:00:56.514031 [debug] [Thread-1 (]: Finished running node model.deel_task.dim_globepay
[0m13:00:56.516315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:56.516750 [debug] [MainThread]: Connection 'model.deel_task.dim_globepay' was properly closed.
[0m13:00:56.517157 [info ] [MainThread]: 
[0m13:00:56.517584 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m13:00:56.518347 [debug] [MainThread]: Command end result
[0m13:00:56.548103 [info ] [MainThread]: 
[0m13:00:56.548538 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:00:56.548810 [info ] [MainThread]: 
[0m13:00:56.549126 [error] [MainThread]:   Database Error in model dim_globepay (models/mart/product/dim_globepay.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'GLOBEPAY_ACCEPTANCE_EVENT_ID'
  compiled Code at target/run/deel_task/models/mart/product/dim_globepay.sql
[0m13:00:56.549377 [info ] [MainThread]: 
[0m13:00:56.549635 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:00:56.552407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4343176, "process_user_time": 1.419938, "process_kernel_time": 0.289436, "process_mem_max_rss": "135626752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:00:56.552881 [debug] [MainThread]: Command `dbt run` failed at 13:00:56.552817 after 4.43 seconds
[0m13:00:56.553201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189e5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a74b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2f9640>]}
[0m13:00:56.553509 [debug] [MainThread]: Flushing usage events
[0m13:01:08.884536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d11370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d110a0>]}


============================== 13:01:08.887869 | 0d51a2d0-d2f6-4fb7-9249-f358efe71a65 ==============================
[0m13:01:08.887869 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:01:08.888248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_globepay', 'send_anonymous_usage_stats': 'True'}
[0m13:01:09.185250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d51a2d0-d2f6-4fb7-9249-f358efe71a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133815e0>]}
[0m13:01:09.207915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d51a2d0-d2f6-4fb7-9249-f358efe71a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106736cf0>]}
[0m13:01:09.209516 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m13:01:09.221768 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:01:09.317736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:09.318149 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/mart/product/dim_globepay.sql
[0m13:01:09.421804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d51a2d0-d2f6-4fb7-9249-f358efe71a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137af230>]}
[0m13:01:09.474693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d51a2d0-d2f6-4fb7-9249-f358efe71a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11349f6b0>]}
[0m13:01:09.474995 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 444 macros
[0m13:01:09.475192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d51a2d0-d2f6-4fb7-9249-f358efe71a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11347b410>]}
[0m13:01:09.475989 [info ] [MainThread]: 
[0m13:01:09.476302 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:09.476725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m13:01:09.483462 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:01:09.483774 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:01:09.483956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:10.196758 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:01:10.199561 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:01:10.400796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m13:01:10.412629 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m13:01:10.413179 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m13:01:10.413607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:11.215921 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:01:11.221209 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m13:01:11.407345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now list_DEEL_HOME_TEST_RAW_MART)
[0m13:01:11.413099 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m13:01:11.413764 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m13:01:11.414335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:11.993760 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:01:11.998398 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m13:01:12.174865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d51a2d0-d2f6-4fb7-9249-f358efe71a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113325910>]}
[0m13:01:12.176105 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:12.176850 [info ] [MainThread]: 
[0m13:01:12.180448 [debug] [Thread-1 (]: Began running node model.deel_task.dim_globepay
[0m13:01:12.181265 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_MART.dim_globepay .............................. [RUN]
[0m13:01:12.181926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now model.deel_task.dim_globepay)
[0m13:01:12.182477 [debug] [Thread-1 (]: Began compiling node model.deel_task.dim_globepay
[0m13:01:12.193567 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.dim_globepay"
[0m13:01:12.194995 [debug] [Thread-1 (]: Began executing node model.deel_task.dim_globepay
[0m13:01:12.222965 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.dim_globepay"
[0m13:01:12.224776 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.dim_globepay"
[0m13:01:12.225195 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.dim_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.dim_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    chargeback.globepay_chargeback_source,
    acceptance.globepay_country,
    acceptance.globepay_currency,
    acceptance.globepay_acceptance_rates,
    acceptance.globepay_acceptance_source,
    acceptance.globepay_acceptance_state
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:01:12.225549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:13.011688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:01:13.042221 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: Close
[0m13:01:13.264177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d51a2d0-d2f6-4fb7-9249-f358efe71a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132fd3d0>]}
[0m13:01:13.265685 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_MART.dim_globepay ......................... [[32mSUCCESS 1[0m in 1.08s]
[0m13:01:13.266657 [debug] [Thread-1 (]: Finished running node model.deel_task.dim_globepay
[0m13:01:13.268337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:13.268836 [debug] [MainThread]: Connection 'model.deel_task.dim_globepay' was properly closed.
[0m13:01:13.269342 [info ] [MainThread]: 
[0m13:01:13.269849 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m13:01:13.270791 [debug] [MainThread]: Command end result
[0m13:01:13.303179 [info ] [MainThread]: 
[0m13:01:13.303665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:13.303978 [info ] [MainThread]: 
[0m13:01:13.304300 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:13.307340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.472484, "process_user_time": 1.421381, "process_kernel_time": 0.255828, "process_mem_max_rss": "133677056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:01:13.307900 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:13.307816 after 4.47 seconds
[0m13:01:13.308262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106762720>]}
[0m13:01:13.308579 [debug] [MainThread]: Flushing usage events
[0m13:11:34.941835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108236030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108721220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108720f50>]}


============================== 13:11:34.945693 | ea72d5e6-dcd1-4923-9f18-49145d390f3e ==============================
[0m13:11:34.945693 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:11:34.946073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_globepay', 'send_anonymous_usage_stats': 'True'}
[0m13:11:35.250930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea72d5e6-dcd1-4923-9f18-49145d390f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a174d0>]}
[0m13:11:35.273601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea72d5e6-dcd1-4923-9f18-49145d390f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb72f0>]}
[0m13:11:35.274379 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m13:11:35.285331 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:11:35.381614 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m13:11:35.381975 [debug] [MainThread]: Partial parsing: added file: deel_task://models/mart/product/fct_globepay.sql
[0m13:11:35.382226 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/mart/product/_mart_product_models.yml
[0m13:11:35.382384 [debug] [MainThread]: Partial parsing: deleted file: deel_task://models/mart/product/fct_globepay__transactions.sql
[0m13:11:35.382576 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/mart/product/dim_globepay.sql
[0m13:11:35.513931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea72d5e6-dcd1-4923-9f18-49145d390f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c47b230>]}
[0m13:11:35.568883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea72d5e6-dcd1-4923-9f18-49145d390f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3869c0>]}
[0m13:11:35.569203 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 444 macros
[0m13:11:35.569398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea72d5e6-dcd1-4923-9f18-49145d390f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f2060>]}
[0m13:11:35.570190 [info ] [MainThread]: 
[0m13:11:35.570516 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:11:35.570941 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m13:11:35.577499 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:11:35.577751 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:11:35.577927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:36.538379 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:11:36.541018 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:11:36.715272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW_MART)
[0m13:11:36.727039 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m13:11:36.727554 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m13:11:36.727976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:37.304948 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:11:37.311688 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m13:11:37.487678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m13:11:37.492415 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m13:11:37.493395 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m13:11:37.493916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:38.080211 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:11:38.084790 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m13:11:38.304414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea72d5e6-dcd1-4923-9f18-49145d390f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e1370>]}
[0m13:11:38.305630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:11:38.306235 [info ] [MainThread]: 
[0m13:11:38.309602 [debug] [Thread-1 (]: Began running node model.deel_task.dim_globepay
[0m13:11:38.310475 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_MART.dim_globepay .............................. [RUN]
[0m13:11:38.311143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now model.deel_task.dim_globepay)
[0m13:11:38.312006 [debug] [Thread-1 (]: Began compiling node model.deel_task.dim_globepay
[0m13:11:38.321936 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.dim_globepay"
[0m13:11:38.323895 [debug] [Thread-1 (]: Began executing node model.deel_task.dim_globepay
[0m13:11:38.350209 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.dim_globepay"
[0m13:11:38.352602 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.dim_globepay"
[0m13:11:38.353069 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.dim_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.dim_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    chargeback.globepay_chargeback_source,
    acceptance.globepay_country,
    acceptance.globepay_currency,
    acceptance.globepay_acceptance_source,
    acceptance.globepay_acceptance_state,
    --Getting the correct rate for country amounts
    case
        when (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency] is not null
        then (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency]::string::float
        else null
    end as country_rate
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:11:38.353417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:39.073724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:11:39.105112 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: Close
[0m13:11:39.293215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea72d5e6-dcd1-4923-9f18-49145d390f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcf9580>]}
[0m13:11:39.294742 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_MART.dim_globepay ......................... [[32mSUCCESS 1[0m in 0.98s]
[0m13:11:39.295747 [debug] [Thread-1 (]: Finished running node model.deel_task.dim_globepay
[0m13:11:39.297304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:39.297774 [debug] [MainThread]: Connection 'model.deel_task.dim_globepay' was properly closed.
[0m13:11:39.298241 [info ] [MainThread]: 
[0m13:11:39.298724 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m13:11:39.299648 [debug] [MainThread]: Command end result
[0m13:11:39.369065 [info ] [MainThread]: 
[0m13:11:39.369396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:39.369601 [info ] [MainThread]: 
[0m13:11:39.369791 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:39.372166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4807615, "process_user_time": 1.472659, "process_kernel_time": 0.280483, "process_mem_max_rss": "130367488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:11:39.372494 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:39.372448 after 4.48 seconds
[0m13:11:39.372711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108062f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080624e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c728fe0>]}
[0m13:11:39.372916 [debug] [MainThread]: Flushing usage events
[0m13:19:31.558578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2cfb0>]}


============================== 13:19:31.561789 | f1d77226-0447-441d-9289-db7ca2311e61 ==============================
[0m13:19:31.561789 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:19:31.562150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s fct_globepay', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:19:31.874757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1d77226-0447-441d-9289-db7ca2311e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a15ee0>]}
[0m13:19:31.897257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1d77226-0447-441d-9289-db7ca2311e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf5370>]}
[0m13:19:31.897915 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m13:19:31.909038 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:19:32.007641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:19:32.008061 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/mart/product/dim_globepay.sql
[0m13:19:32.008281 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/mart/product/fct_globepay.sql
[0m13:19:32.141447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1d77226-0447-441d-9289-db7ca2311e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dab590>]}
[0m13:19:32.197190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1d77226-0447-441d-9289-db7ca2311e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ccdd60>]}
[0m13:19:32.197519 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 444 macros
[0m13:19:32.197737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1d77226-0447-441d-9289-db7ca2311e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035f72c0>]}
[0m13:19:32.198538 [info ] [MainThread]: 
[0m13:19:32.198853 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:19:32.199270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m13:19:32.205898 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:19:32.206174 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:19:32.206349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:33.324420 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:19:33.326384 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:19:33.499367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW_MART)
[0m13:19:33.507540 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m13:19:33.507994 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m13:19:33.508300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:34.126592 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:19:34.130861 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m13:19:34.300678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m13:19:34.305333 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m13:19:34.306305 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m13:19:34.306819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:34.865850 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:19:34.870703 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m13:19:35.046070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1d77226-0447-441d-9289-db7ca2311e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a232c0>]}
[0m13:19:35.047214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:35.047786 [info ] [MainThread]: 
[0m13:19:35.051936 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay
[0m13:19:35.052788 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_MART.fct_globepay .............................. [RUN]
[0m13:19:35.053479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now model.deel_task.fct_globepay)
[0m13:19:35.054051 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay
[0m13:19:35.064614 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay"
[0m13:19:35.066144 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay
[0m13:19:35.093868 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay"
[0m13:19:35.095639 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay"
[0m13:19:35.096030 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_status,
    chargeback.globepay_chargeback_status,
    acceptance.globepay_acceptance_state,
    chargeback.is_globepay_chargeback,
    acceptance.is_globepay_cvv_provided
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:19:35.096364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:35.961408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:19:35.987335 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: Close
[0m13:19:36.146510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d77226-0447-441d-9289-db7ca2311e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057415b0>]}
[0m13:19:36.147587 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_MART.fct_globepay ......................... [[32mSUCCESS 1[0m in 1.09s]
[0m13:19:36.148397 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay
[0m13:19:36.149716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:36.150103 [debug] [MainThread]: Connection 'model.deel_task.fct_globepay' was properly closed.
[0m13:19:36.150445 [info ] [MainThread]: 
[0m13:19:36.150812 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m13:19:36.151479 [debug] [MainThread]: Command end result
[0m13:19:36.220451 [info ] [MainThread]: 
[0m13:19:36.220764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:36.220959 [info ] [MainThread]: 
[0m13:19:36.221141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:19:36.223421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7064333, "process_user_time": 1.416463, "process_kernel_time": 0.281151, "process_mem_max_rss": "133906432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:19:36.223768 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:36.223717 after 4.71 seconds
[0m13:19:36.223991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f48da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f48bc0>]}
[0m13:19:36.224192 [debug] [MainThread]: Flushing usage events
[0m13:40:11.661159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e8fb0>]}


============================== 13:40:11.664279 | a71ebbd5-60ad-43fd-85e4-90d687cb47aa ==============================
[0m13:40:11.664279 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:40:11.664621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s fct_globepay', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:40:11.971288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a71ebbd5-60ad-43fd-85e4-90d687cb47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb34a0>]}
[0m13:40:11.993891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a71ebbd5-60ad-43fd-85e4-90d687cb47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109343770>]}
[0m13:40:11.994607 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m13:40:12.009640 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:40:12.105360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m13:40:12.105715 [debug] [MainThread]: Partial parsing: added file: deel_task://models/semantic/product/rpt_globepay__declined_countries_greater_25_mil.sql
[0m13:40:12.105906 [debug] [MainThread]: Partial parsing: added file: deel_task://models/semantic/product/rpt_globepay__daily_acceptance_rate.sql
[0m13:40:12.106123 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/mart/product/dim_globepay.sql
[0m13:40:12.106331 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/mart/product/fct_globepay.sql
[0m13:40:12.239640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a71ebbd5-60ad-43fd-85e4-90d687cb47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986bef0>]}
[0m13:40:12.296825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a71ebbd5-60ad-43fd-85e4-90d687cb47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109788290>]}
[0m13:40:12.297161 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 444 macros
[0m13:40:12.297361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71ebbd5-60ad-43fd-85e4-90d687cb47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944df40>]}
[0m13:40:12.298170 [info ] [MainThread]: 
[0m13:40:12.298486 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:40:12.298911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m13:40:12.305550 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:40:12.305814 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:40:12.305990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:13.477989 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:40:13.481367 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:40:13.646294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW)
[0m13:40:13.657611 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW"
[0m13:40:13.658136 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW"} */
show terse objects in DEEL_HOME_TEST.RAW limit 10000
[0m13:40:13.658557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:14.220542 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:40:14.223150 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: Close
[0m13:40:14.379031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m13:40:14.381212 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m13:40:14.381721 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m13:40:14.381993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:14.943986 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:40:14.949292 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m13:40:15.114348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now list_DEEL_HOME_TEST_RAW_MART)
[0m13:40:15.119303 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m13:40:15.119903 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m13:40:15.120397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:15.702672 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:40:15.706883 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m13:40:15.867196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71ebbd5-60ad-43fd-85e4-90d687cb47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109311a60>]}
[0m13:40:15.868549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:15.869402 [info ] [MainThread]: 
[0m13:40:15.872502 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay
[0m13:40:15.873308 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_MART.fct_globepay .............................. [RUN]
[0m13:40:15.873984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now model.deel_task.fct_globepay)
[0m13:40:15.874537 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay
[0m13:40:15.885741 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay"
[0m13:40:15.887593 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay
[0m13:40:15.917459 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay"
[0m13:40:15.919413 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay"
[0m13:40:15.919811 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_state,
    --Getting the correct rate for country amounts
    case
        when (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency] is not null
        then (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency]::string::float
        else null
    end as country_rate_to_usd,
    acceptance.globepay_acceptance_amount/country_rate_to_usd as globepay_acceptance_amount_usd
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:40:15.920190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:16.633073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:16.664712 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: Close
[0m13:40:16.884253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71ebbd5-60ad-43fd-85e4-90d687cb47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fd5b0>]}
[0m13:40:16.885674 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_MART.fct_globepay ......................... [[32mSUCCESS 1[0m in 1.01s]
[0m13:40:16.886651 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay
[0m13:40:16.888328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:16.888916 [debug] [MainThread]: Connection 'model.deel_task.fct_globepay' was properly closed.
[0m13:40:16.889436 [info ] [MainThread]: 
[0m13:40:16.889961 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m13:40:16.890918 [debug] [MainThread]: Command end result
[0m13:40:16.960408 [info ] [MainThread]: 
[0m13:40:16.960757 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:16.960959 [info ] [MainThread]: 
[0m13:40:16.961150 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:40:16.962859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.343037, "process_user_time": 1.54933, "process_kernel_time": 0.294532, "process_mem_max_rss": "136708096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:40:16.963195 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:16.963145 after 5.34 seconds
[0m13:40:16.963426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10980f3e0>]}
[0m13:40:16.963641 [debug] [MainThread]: Flushing usage events
[0m13:43:26.623744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d5220>]}


============================== 13:43:26.626837 | 0155b0a2-783d-41e2-9bc7-33e4db41e5d6 ==============================
[0m13:43:26.626837 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:43:26.627200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'profiles_dir': './profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:26.932170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f859d0>]}
[0m13:43:26.954684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eba7e0>]}
[0m13:43:26.955401 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m13:43:26.968307 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:43:27.062783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:27.063176 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/semantic/product/rpt_globepay__declined_countries_greater_25_mil.sql
[0m13:43:27.184211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c4410>]}
[0m13:43:27.249913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110479d60>]}
[0m13:43:27.250223 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 444 macros
[0m13:43:27.251496 [info ] [MainThread]: 
[0m13:43:27.251827 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:43:27.253856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m13:43:27.261037 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:43:27.261478 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:43:27.261707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:28.269568 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:43:28.272241 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:43:28.449230 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:43:28.449745 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:43:28.450063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:29.004812 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:43:29.009253 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:43:29.183808 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:43:29.186426 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:43:29.187046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:29.697179 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:43:29.701603 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:43:29.895903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW_MART'
[0m13:43:29.909076 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m13:43:29.909613 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m13:43:29.910075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:30.454612 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:43:30.459420 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m13:43:30.626302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m13:43:30.631826 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m13:43:30.632458 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m13:43:30.632953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:31.431862 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:43:31.436478 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m13:43:31.607297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now list_DEEL_HOME_TEST_RAW)
[0m13:43:31.613113 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW"
[0m13:43:31.613711 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW"} */
show terse objects in DEEL_HOME_TEST.RAW limit 10000
[0m13:43:31.614219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:32.155793 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:43:32.159890 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: Close
[0m13:43:32.388364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104cfe60>]}
[0m13:43:32.389547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:32.390131 [info ] [MainThread]: 
[0m13:43:32.394287 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__acceptance
[0m13:43:32.395114 [info ] [Thread-1 (]: 1 of 10 START sql view model RAW_STAGING.stg_globepay__acceptance .............. [RUN]
[0m13:43:32.395867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now model.deel_task.stg_globepay__acceptance)
[0m13:43:32.396602 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__acceptance
[0m13:43:32.407291 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__acceptance"
[0m13:43:32.409279 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__acceptance
[0m13:43:32.436927 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__acceptance"
[0m13:43:32.438611 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__acceptance"
[0m13:43:32.439026 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m13:43:32.439376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:33.137532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:33.208151 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: Close
[0m13:43:33.369137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d64080>]}
[0m13:43:33.369921 [info ] [Thread-1 (]: 1 of 10 OK created sql view model RAW_STAGING.stg_globepay__acceptance ......... [[32mSUCCESS 1[0m in 0.97s]
[0m13:43:33.370508 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__acceptance
[0m13:43:33.370931 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__chargeback
[0m13:43:33.371498 [info ] [Thread-1 (]: 2 of 10 START sql view model RAW_STAGING.stg_globepay__chargeback .............. [RUN]
[0m13:43:33.371974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__acceptance, now model.deel_task.stg_globepay__chargeback)
[0m13:43:33.372378 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__chargeback
[0m13:43:33.374724 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__chargeback"
[0m13:43:33.376300 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__chargeback
[0m13:43:33.378639 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__chargeback"
[0m13:43:33.379779 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__chargeback"
[0m13:43:33.380119 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_chargeback
  );
[0m13:43:33.380393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:34.161260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:34.166145 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: Close
[0m13:43:34.341527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110309040>]}
[0m13:43:34.343076 [info ] [Thread-1 (]: 2 of 10 OK created sql view model RAW_STAGING.stg_globepay__chargeback ......... [[32mSUCCESS 1[0m in 0.97s]
[0m13:43:34.344227 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__chargeback
[0m13:43:34.345212 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:43:34.346154 [info ] [Thread-1 (]: 3 of 10 START test not_null_stg_globepay__acceptance_globepay_acceptance_id .... [RUN]
[0m13:43:34.346857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__chargeback, now test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f)
[0m13:43:34.347421 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:43:34.364098 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:43:34.365445 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:43:34.382921 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:43:34.384237 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:43:34.384641 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m13:43:34.384999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:35.010568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:35.018728 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: Close
[0m13:43:35.195906 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stg_globepay__acceptance_globepay_acceptance_id .......... [[32mPASS[0m in 0.85s]
[0m13:43:35.197526 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:43:35.198448 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:43:35.199402 [info ] [Thread-1 (]: 4 of 10 START test unique_stg_globepay__acceptance_globepay_acceptance_id ...... [RUN]
[0m13:43:35.200232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f, now test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4)
[0m13:43:35.200896 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:43:35.211293 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:43:35.212814 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:43:35.216254 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:43:35.218075 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:43:35.218671 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:43:35.219177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:35.831943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:35.836142 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: Close
[0m13:43:36.011010 [info ] [Thread-1 (]: 4 of 10 PASS unique_stg_globepay__acceptance_globepay_acceptance_id ............ [[32mPASS[0m in 0.81s]
[0m13:43:36.012162 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:43:36.012850 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:43:36.013515 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_globepay__chargeback_globepay_acceptance_id .... [RUN]
[0m13:43:36.014144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4, now test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657)
[0m13:43:36.014721 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:43:36.021105 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:43:36.023229 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:43:36.029112 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:43:36.030759 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:43:36.031321 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m13:43:36.031814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:36.592995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:36.596452 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: Close
[0m13:43:36.817662 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_globepay__chargeback_globepay_acceptance_id .......... [[32mPASS[0m in 0.80s]
[0m13:43:36.818808 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:43:36.819484 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:43:36.820254 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_globepay__chargeback_globepay_acceptance_id ...... [RUN]
[0m13:43:36.821060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657, now test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec)
[0m13:43:36.821688 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:43:36.827929 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:43:36.829176 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:43:36.832284 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:43:36.833950 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:43:36.834481 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:43:36.834993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:37.461717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:37.465700 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: Close
[0m13:43:37.650679 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_globepay__chargeback_globepay_acceptance_id ............ [[32mPASS[0m in 0.83s]
[0m13:43:37.651841 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:43:37.652994 [debug] [Thread-1 (]: Began running node model.deel_task.dim_globepay
[0m13:43:37.653778 [info ] [Thread-1 (]: 7 of 10 START sql view model RAW_MART.dim_globepay ............................. [RUN]
[0m13:43:37.654447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec, now model.deel_task.dim_globepay)
[0m13:43:37.654993 [debug] [Thread-1 (]: Began compiling node model.deel_task.dim_globepay
[0m13:43:37.659418 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.dim_globepay"
[0m13:43:37.660766 [debug] [Thread-1 (]: Began executing node model.deel_task.dim_globepay
[0m13:43:37.665658 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.dim_globepay"
[0m13:43:37.668753 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.dim_globepay"
[0m13:43:37.669340 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.dim_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.dim_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    chargeback.globepay_chargeback_source,
    acceptance.globepay_country,
    acceptance.globepay_currency,
    acceptance.globepay_acceptance_source,
    chargeback.is_globepay_chargeback,
    acceptance.is_globepay_cvv_provided,
    acceptance.globepay_acceptance_status,
    chargeback.globepay_chargeback_status,
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:43:37.669844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:38.595272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:38.601750 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: Close
[0m13:43:38.768246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046d940>]}
[0m13:43:38.769653 [info ] [Thread-1 (]: 7 of 10 OK created sql view model RAW_MART.dim_globepay ........................ [[32mSUCCESS 1[0m in 1.11s]
[0m13:43:38.770676 [debug] [Thread-1 (]: Finished running node model.deel_task.dim_globepay
[0m13:43:38.771327 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay
[0m13:43:38.772224 [info ] [Thread-1 (]: 8 of 10 START sql view model RAW_MART.fct_globepay ............................. [RUN]
[0m13:43:38.773063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.dim_globepay, now model.deel_task.fct_globepay)
[0m13:43:38.773701 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay
[0m13:43:38.778786 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay"
[0m13:43:38.780568 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay
[0m13:43:38.784071 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay"
[0m13:43:38.786873 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay"
[0m13:43:38.787731 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_state,
    --Getting the correct rate for country amounts
    case
        when (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency] is not null
        then (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency]::string::float
        else null
    end as country_rate_to_usd,
    acceptance.globepay_acceptance_amount/country_rate_to_usd as globepay_acceptance_amount_usd
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:43:38.788331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:39.589837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:39.595467 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: Close
[0m13:43:39.758102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104cf350>]}
[0m13:43:39.759257 [info ] [Thread-1 (]: 8 of 10 OK created sql view model RAW_MART.fct_globepay ........................ [[32mSUCCESS 1[0m in 0.99s]
[0m13:43:39.760236 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay
[0m13:43:39.761363 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:43:39.762282 [info ] [Thread-1 (]: 9 of 10 START sql view model RAW.rpt_globepay__daily_acceptance_rate ........... [RUN]
[0m13:43:39.763045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.fct_globepay, now model.deel_task.rpt_globepay__daily_acceptance_rate)
[0m13:43:39.763634 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:43:39.766960 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:43:39.768470 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:43:39.772543 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:43:39.774596 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:43:39.775109 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__daily_acceptance_rate"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__daily_acceptance_rate
  
   as (
    --1. What is the acceptance rate over time?
with load_fct_globepay as (
    SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
)
SELECT
--DAILY GRAIN
DATE_TRUNC(day,GLOBEPAY_ACCEPTANCE_AT)::date GLOBEPAY_ACCEPTANCE_DATE,
COUNT_IF(GLOBEPAY_ACCEPTANCE_STATE = 'ACCEPTED') as count_acceptance,
COUNT(*) total_count,
count_acceptance/total_count as daily_acceptance_rate
FROM Dload_fct_globepay
GROUP BY GLOBEPAY_ACCEPTANCE_DATE
  );
[0m13:43:39.775576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:40.340581 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dc1f-0000-6d00-0000-0000ca654605
[0m13:43:40.341479 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEEL_HOME_TEST.RAW.DLOAD_FCT_GLOBEPAY' does not exist or not authorized.
[0m13:43:40.342262 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: Close
[0m13:43:40.527949 [debug] [Thread-1 (]: Database Error in model rpt_globepay__daily_acceptance_rate (models/semantic/product/rpt_globepay__daily_acceptance_rate.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEEL_HOME_TEST.RAW.DLOAD_FCT_GLOBEPAY' does not exist or not authorized.
  compiled Code at target/run/deel_task/models/semantic/product/rpt_globepay__daily_acceptance_rate.sql
[0m13:43:40.529003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110161850>]}
[0m13:43:40.530014 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model RAW.rpt_globepay__daily_acceptance_rate .. [[31mERROR[0m in 0.77s]
[0m13:43:40.530943 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:43:40.531619 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:43:40.532915 [info ] [Thread-1 (]: 10 of 10 START sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [RUN]
[0m13:43:40.533672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__daily_acceptance_rate, now model.deel_task.rpt_globepay__declined_countries_greater_25_mil)
[0m13:43:40.534184 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:43:40.537909 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:43:40.539122 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:43:40.543241 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:43:40.545055 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:43:40.545580 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__declined_countries_greater_25_mil
  
   as (
    --2. List the countries where the amount of declined transactions went over $25M
with load_fct_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
     where FCT_GLOBEPAY.GLOBEPAY_ACCEPTANCE_STATE = 'DECLINED'

),

load_dim_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay
),

join_tables as (
    SELECT *  
    FROM load_fct_globepay FCT_GLOBEPAY
    LEFT JOIN load_dim_globepay  DIM_GLOBEPAY
    ON FCT_GLOBEPAY.GLOBEPAY_ACCEPTANCE_ID = DIM_GLOBEPAY.GLOBEPAY_ACCEPTANCE_ID
)

SELECT 
GLOBEPAY_COUNTRY,
SUM(GLOBEPAY_ACCEPTANCE_AMOUNT_USD) total_amount
GROUP BY 1
--Over 25 millions
HAVING total_amount > 25000000
  );
[0m13:43:40.546040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:41.227514 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dc1f-0000-6d00-0000-0000ca654609
[0m13:43:41.228377 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 0
invalid identifier 'GLOBEPAY_COUNTRY'
[0m13:43:41.229171 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: Close
[0m13:43:41.421284 [debug] [Thread-1 (]: Database Error in model rpt_globepay__declined_countries_greater_25_mil (models/semantic/product/rpt_globepay__declined_countries_greater_25_mil.sql)
  000904 (42000): SQL compilation error: error line 23 at position 0
  invalid identifier 'GLOBEPAY_COUNTRY'
  compiled Code at target/run/deel_task/models/semantic/product/rpt_globepay__declined_countries_greater_25_mil.sql
[0m13:43:41.422314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0155b0a2-783d-41e2-9bc7-33e4db41e5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043adc70>]}
[0m13:43:41.423288 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [[31mERROR[0m in 0.89s]
[0m13:43:41.424221 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:43:41.425952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:41.426553 [debug] [MainThread]: Connection 'model.deel_task.rpt_globepay__declined_countries_greater_25_mil' was properly closed.
[0m13:43:41.427035 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW' was properly closed.
[0m13:43:41.427637 [info ] [MainThread]: 
[0m13:43:41.428199 [info ] [MainThread]: Finished running 6 view models, 4 data tests in 0 hours 0 minutes and 14.18 seconds (14.18s).
[0m13:43:41.431028 [debug] [MainThread]: Command end result
[0m13:43:41.462513 [info ] [MainThread]: 
[0m13:43:41.462946 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:43:41.463347 [info ] [MainThread]: 
[0m13:43:41.464011 [error] [MainThread]:   Database Error in model rpt_globepay__daily_acceptance_rate (models/semantic/product/rpt_globepay__daily_acceptance_rate.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEEL_HOME_TEST.RAW.DLOAD_FCT_GLOBEPAY' does not exist or not authorized.
  compiled Code at target/run/deel_task/models/semantic/product/rpt_globepay__daily_acceptance_rate.sql
[0m13:43:41.464426 [info ] [MainThread]: 
[0m13:43:41.465011 [error] [MainThread]:   Database Error in model rpt_globepay__declined_countries_greater_25_mil (models/semantic/product/rpt_globepay__declined_countries_greater_25_mil.sql)
  000904 (42000): SQL compilation error: error line 23 at position 0
  invalid identifier 'GLOBEPAY_COUNTRY'
  compiled Code at target/run/deel_task/models/semantic/product/rpt_globepay__declined_countries_greater_25_mil.sql
[0m13:43:41.465387 [info ] [MainThread]: 
[0m13:43:41.465699 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m13:43:41.467916 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 14.88093, "process_user_time": 2.585759, "process_kernel_time": 0.388181, "process_mem_max_rss": "139526144", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:43:41.468398 [debug] [MainThread]: Command `dbt build` failed at 13:43:41.468323 after 14.88 seconds
[0m13:43:41.468789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cebcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11038b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca6270>]}
[0m13:43:41.469134 [debug] [MainThread]: Flushing usage events
[0m13:44:12.016988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10384f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1d2e0>]}


============================== 13:44:12.020089 | 9561da69-0125-4dae-a0fc-04b3adc3acce ==============================
[0m13:44:12.020089 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:44:12.020452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m13:44:12.322807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1cbc0>]}
[0m13:44:12.346428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106010110>]}
[0m13:44:12.348013 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m13:44:12.361123 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:44:12.456157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:44:12.456562 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/semantic/product/rpt_globepay__declined_countries_greater_25_mil.sql
[0m13:44:12.558430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c4410>]}
[0m13:44:12.619968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659e300>]}
[0m13:44:12.620285 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 444 macros
[0m13:44:12.621583 [info ] [MainThread]: 
[0m13:44:12.621907 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:44:12.623976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m13:44:12.631406 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:44:12.631858 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:44:12.632142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:13.713242 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:44:13.718105 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:44:13.896705 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:44:13.897520 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:44:13.898038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:14.630712 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:44:14.635274 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:44:14.805855 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:44:14.808334 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:44:14.808979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:15.394381 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:44:15.399204 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:44:15.563592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW_STAGING'
[0m13:44:15.573372 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m13:44:15.573934 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m13:44:15.574287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:16.113777 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:44:16.116529 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m13:44:16.286969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now list_DEEL_HOME_TEST_RAW_MART)
[0m13:44:16.292421 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m13:44:16.293010 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m13:44:16.293515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:16.890588 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:44:16.896127 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m13:44:17.126536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now list_DEEL_HOME_TEST_RAW)
[0m13:44:17.128392 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW"
[0m13:44:17.128616 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW"} */
show terse objects in DEEL_HOME_TEST.RAW limit 10000
[0m13:44:17.128804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:17.618413 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:44:17.622337 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: Close
[0m13:44:17.791593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104482de0>]}
[0m13:44:17.793135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:17.794048 [info ] [MainThread]: 
[0m13:44:17.798307 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__acceptance
[0m13:44:17.799142 [info ] [Thread-1 (]: 1 of 10 START sql view model RAW_STAGING.stg_globepay__acceptance .............. [RUN]
[0m13:44:17.799824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now model.deel_task.stg_globepay__acceptance)
[0m13:44:17.800544 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__acceptance
[0m13:44:17.811175 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__acceptance"
[0m13:44:17.812627 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__acceptance
[0m13:44:17.840958 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__acceptance"
[0m13:44:17.842608 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__acceptance"
[0m13:44:17.843027 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m13:44:17.843389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:18.501682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:44:18.574149 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: Close
[0m13:44:18.746744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032ebe90>]}
[0m13:44:18.747799 [info ] [Thread-1 (]: 1 of 10 OK created sql view model RAW_STAGING.stg_globepay__acceptance ......... [[32mSUCCESS 1[0m in 0.95s]
[0m13:44:18.748585 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__acceptance
[0m13:44:18.749148 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__chargeback
[0m13:44:18.749917 [info ] [Thread-1 (]: 2 of 10 START sql view model RAW_STAGING.stg_globepay__chargeback .............. [RUN]
[0m13:44:18.750493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__acceptance, now model.deel_task.stg_globepay__chargeback)
[0m13:44:18.750952 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__chargeback
[0m13:44:18.754213 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__chargeback"
[0m13:44:18.755274 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__chargeback
[0m13:44:18.758253 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__chargeback"
[0m13:44:18.759927 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__chargeback"
[0m13:44:18.760601 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_chargeback
  );
[0m13:44:18.761058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:19.524682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:44:19.528296 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: Close
[0m13:44:19.693376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106456780>]}
[0m13:44:19.695049 [info ] [Thread-1 (]: 2 of 10 OK created sql view model RAW_STAGING.stg_globepay__chargeback ......... [[32mSUCCESS 1[0m in 0.94s]
[0m13:44:19.696033 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__chargeback
[0m13:44:19.696738 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:44:19.697550 [info ] [Thread-1 (]: 3 of 10 START test not_null_stg_globepay__acceptance_globepay_acceptance_id .... [RUN]
[0m13:44:19.698220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__chargeback, now test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f)
[0m13:44:19.698797 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:44:19.715266 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:44:19.716724 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:44:19.733804 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:44:19.735189 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:44:19.735616 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m13:44:19.735991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:20.336360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:44:20.344081 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: Close
[0m13:44:20.508320 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stg_globepay__acceptance_globepay_acceptance_id .......... [[32mPASS[0m in 0.81s]
[0m13:44:20.509489 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:44:20.510169 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:44:20.510935 [info ] [Thread-1 (]: 4 of 10 START test unique_stg_globepay__acceptance_globepay_acceptance_id ...... [RUN]
[0m13:44:20.511765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f, now test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4)
[0m13:44:20.512396 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:44:20.522226 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:44:20.523734 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:44:20.527111 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:44:20.528701 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:44:20.529181 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:20.529609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.082353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:44:21.086159 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: Close
[0m13:44:21.257308 [info ] [Thread-1 (]: 4 of 10 PASS unique_stg_globepay__acceptance_globepay_acceptance_id ............ [[32mPASS[0m in 0.75s]
[0m13:44:21.258505 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:44:21.259191 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:44:21.259962 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_globepay__chargeback_globepay_acceptance_id .... [RUN]
[0m13:44:21.260800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4, now test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657)
[0m13:44:21.261436 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:44:21.268308 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:44:21.269649 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:44:21.274909 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:44:21.276492 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:44:21.277048 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m13:44:21.277547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.859061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:44:21.862589 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: Close
[0m13:44:22.029977 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_globepay__chargeback_globepay_acceptance_id .......... [[32mPASS[0m in 0.77s]
[0m13:44:22.031256 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:44:22.031980 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:44:22.032714 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_globepay__chargeback_globepay_acceptance_id ...... [RUN]
[0m13:44:22.033495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657, now test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec)
[0m13:44:22.034101 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:44:22.039796 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:44:22.040975 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:44:22.044208 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:44:22.045821 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:44:22.046310 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:22.046742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:22.665601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:44:22.669084 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: Close
[0m13:44:22.836129 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_globepay__chargeback_globepay_acceptance_id ............ [[32mPASS[0m in 0.80s]
[0m13:44:22.837320 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:44:22.838527 [debug] [Thread-1 (]: Began running node model.deel_task.dim_globepay
[0m13:44:22.839469 [info ] [Thread-1 (]: 7 of 10 START sql view model RAW_MART.dim_globepay ............................. [RUN]
[0m13:44:22.840288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec, now model.deel_task.dim_globepay)
[0m13:44:22.840943 [debug] [Thread-1 (]: Began compiling node model.deel_task.dim_globepay
[0m13:44:22.845170 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.dim_globepay"
[0m13:44:22.846537 [debug] [Thread-1 (]: Began executing node model.deel_task.dim_globepay
[0m13:44:22.850510 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.dim_globepay"
[0m13:44:22.853019 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.dim_globepay"
[0m13:44:22.854013 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.dim_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.dim_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    chargeback.globepay_chargeback_source,
    acceptance.globepay_country,
    acceptance.globepay_currency,
    acceptance.globepay_acceptance_source,
    chargeback.is_globepay_chargeback,
    acceptance.is_globepay_cvv_provided,
    acceptance.globepay_acceptance_status,
    chargeback.globepay_chargeback_status,
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:44:22.854529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:23.620561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:44:23.624587 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: Close
[0m13:44:23.813241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012518e0>]}
[0m13:44:23.814458 [info ] [Thread-1 (]: 7 of 10 OK created sql view model RAW_MART.dim_globepay ........................ [[32mSUCCESS 1[0m in 0.97s]
[0m13:44:23.815367 [debug] [Thread-1 (]: Finished running node model.deel_task.dim_globepay
[0m13:44:23.816017 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay
[0m13:44:23.816852 [info ] [Thread-1 (]: 8 of 10 START sql view model RAW_MART.fct_globepay ............................. [RUN]
[0m13:44:23.817641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.dim_globepay, now model.deel_task.fct_globepay)
[0m13:44:23.818241 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay
[0m13:44:23.823224 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay"
[0m13:44:23.824482 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay
[0m13:44:23.828548 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay"
[0m13:44:23.831225 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay"
[0m13:44:23.831923 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_state,
    --Getting the correct rate for country amounts
    case
        when (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency] is not null
        then (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency]::string::float
        else null
    end as country_rate_to_usd,
    acceptance.globepay_acceptance_amount/country_rate_to_usd as globepay_acceptance_amount_usd
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:44:23.832481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:24.503974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:44:24.506475 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: Close
[0m13:44:24.666693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b4b30>]}
[0m13:44:24.667598 [info ] [Thread-1 (]: 8 of 10 OK created sql view model RAW_MART.fct_globepay ........................ [[32mSUCCESS 1[0m in 0.85s]
[0m13:44:24.668235 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay
[0m13:44:24.669042 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:44:24.669631 [info ] [Thread-1 (]: 9 of 10 START sql view model RAW.rpt_globepay__daily_acceptance_rate ........... [RUN]
[0m13:44:24.670114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.fct_globepay, now model.deel_task.rpt_globepay__daily_acceptance_rate)
[0m13:44:24.670519 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:44:24.673477 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:44:24.674448 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:44:24.678461 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:44:24.679794 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:44:24.680785 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__daily_acceptance_rate"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__daily_acceptance_rate
  
   as (
    --1. What is the acceptance rate over time?
with load_fct_globepay as (
    SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
)
SELECT
--DAILY GRAIN
DATE_TRUNC(day,GLOBEPAY_ACCEPTANCE_AT)::date GLOBEPAY_ACCEPTANCE_DATE,
COUNT_IF(GLOBEPAY_ACCEPTANCE_STATE = 'ACCEPTED') as count_acceptance,
COUNT(*) total_count,
count_acceptance/total_count as daily_acceptance_rate
FROM Dload_fct_globepay
GROUP BY GLOBEPAY_ACCEPTANCE_DATE
  );
[0m13:44:24.681222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:25.460342 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dc20-0000-6d29-0000-0000ca65361d
[0m13:44:25.461083 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEEL_HOME_TEST.RAW.DLOAD_FCT_GLOBEPAY' does not exist or not authorized.
[0m13:44:25.461763 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: Close
[0m13:44:25.649538 [debug] [Thread-1 (]: Database Error in model rpt_globepay__daily_acceptance_rate (models/semantic/product/rpt_globepay__daily_acceptance_rate.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEEL_HOME_TEST.RAW.DLOAD_FCT_GLOBEPAY' does not exist or not authorized.
  compiled Code at target/run/deel_task/models/semantic/product/rpt_globepay__daily_acceptance_rate.sql
[0m13:44:25.650603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106467110>]}
[0m13:44:25.651602 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model RAW.rpt_globepay__daily_acceptance_rate .. [[31mERROR[0m in 0.98s]
[0m13:44:25.652520 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:44:25.653177 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:44:25.654292 [info ] [Thread-1 (]: 10 of 10 START sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [RUN]
[0m13:44:25.654936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__daily_acceptance_rate, now model.deel_task.rpt_globepay__declined_countries_greater_25_mil)
[0m13:44:25.655458 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:44:25.659148 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:44:25.660414 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:44:25.664687 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:44:25.666545 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:44:25.667071 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__declined_countries_greater_25_mil
  
   as (
    --2. List the countries where the amount of declined transactions went over $25M
with load_fct_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
     where FCT_GLOBEPAY.GLOBEPAY_ACCEPTANCE_STATE = 'DECLINED'

),

load_dim_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay
),

join_tables as (
    SELECT *  
    FROM load_fct_globepay 
    LEFT JOIN load_dim_globepay  
    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID
)

SELECT 
GLOBEPAY_COUNTRY,
SUM(GLOBEPAY_ACCEPTANCE_AMOUNT_USD) total_amount
FROM join_tables
GROUP BY 1
--Over 25 millions
HAVING total_amount > 25000000
  );
[0m13:44:25.667519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:26.657789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:44:26.659197 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: Close
[0m13:44:26.828164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9561da69-0125-4dae-a0fc-04b3adc3acce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106309be0>]}
[0m13:44:26.828860 [info ] [Thread-1 (]: 10 of 10 OK created sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [[32mSUCCESS 1[0m in 1.17s]
[0m13:44:26.829604 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:44:26.832002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:26.832687 [debug] [MainThread]: Connection 'model.deel_task.rpt_globepay__declined_countries_greater_25_mil' was properly closed.
[0m13:44:26.833477 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW' was properly closed.
[0m13:44:26.834118 [info ] [MainThread]: 
[0m13:44:26.834527 [info ] [MainThread]: Finished running 6 view models, 4 data tests in 0 hours 0 minutes and 14.21 seconds (14.21s).
[0m13:44:26.835823 [debug] [MainThread]: Command end result
[0m13:44:26.855935 [info ] [MainThread]: 
[0m13:44:26.856256 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:44:26.856451 [info ] [MainThread]: 
[0m13:44:26.856691 [error] [MainThread]:   Database Error in model rpt_globepay__daily_acceptance_rate (models/semantic/product/rpt_globepay__daily_acceptance_rate.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEEL_HOME_TEST.RAW.DLOAD_FCT_GLOBEPAY' does not exist or not authorized.
  compiled Code at target/run/deel_task/models/semantic/product/rpt_globepay__daily_acceptance_rate.sql
[0m13:44:26.856887 [info ] [MainThread]: 
[0m13:44:26.857075 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m13:44:26.859526 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 14.886671, "process_user_time": 2.3651, "process_kernel_time": 0.333649, "process_mem_max_rss": "138903552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:44:26.859912 [debug] [MainThread]: Command `dbt build` failed at 13:44:26.859856 after 14.89 seconds
[0m13:44:26.860160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a3e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bef9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10384f740>]}
[0m13:44:26.860383 [debug] [MainThread]: Flushing usage events
[0m13:45:11.567469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10252f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042111c0>]}


============================== 13:45:11.570552 | f0c2405c-54b9-49cd-84fc-0d55b70a61a3 ==============================
[0m13:45:11.570552 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:45:11.570918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'profiles_dir': './profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:11.878481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0d220>]}
[0m13:45:11.901422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104211b20>]}
[0m13:45:11.902164 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m13:45:11.915250 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:45:12.013076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:45:12.013442 [debug] [MainThread]: Partial parsing: added file: deel_task://models/semantic/product/_rpt_globepay__models.yml
[0m13:45:12.013676 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/semantic/product/rpt_globepay__daily_acceptance_rate.sql
[0m13:45:12.143156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105483ef0>]}
[0m13:45:12.207963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547e9f0>]}
[0m13:45:12.208273 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 444 macros
[0m13:45:12.209543 [info ] [MainThread]: 
[0m13:45:12.209876 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:45:12.211910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m13:45:12.218865 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:45:12.219190 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:45:12.219463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:13.216894 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:45:13.218780 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:45:13.407189 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:45:13.407765 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:45:13.408135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:14.124891 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:45:14.129039 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:45:14.304426 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:45:14.305304 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:45:14.306231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:14.926630 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:45:14.929694 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:45:15.099212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW)
[0m13:45:15.104409 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW"
[0m13:45:15.104713 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW"} */
show terse objects in DEEL_HOME_TEST.RAW limit 10000
[0m13:45:15.104896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:15.667528 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:45:15.671942 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: Close
[0m13:45:15.846250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW, now list_DEEL_HOME_TEST_RAW_MART)
[0m13:45:15.851791 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m13:45:15.852506 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m13:45:15.853040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:16.477591 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:45:16.482348 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m13:45:16.651658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m13:45:16.656865 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m13:45:16.657483 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m13:45:16.657969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:17.229356 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:45:17.234585 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m13:45:17.412237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b1340>]}
[0m13:45:17.413499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:17.414197 [info ] [MainThread]: 
[0m13:45:17.418235 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__acceptance
[0m13:45:17.419115 [info ] [Thread-1 (]: 1 of 10 START sql view model RAW_STAGING.stg_globepay__acceptance .............. [RUN]
[0m13:45:17.419833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now model.deel_task.stg_globepay__acceptance)
[0m13:45:17.420654 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__acceptance
[0m13:45:17.431015 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__acceptance"
[0m13:45:17.433420 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__acceptance
[0m13:45:17.462024 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__acceptance"
[0m13:45:17.463903 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__acceptance"
[0m13:45:17.464292 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m13:45:17.464634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:18.176080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:18.201779 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: Close
[0m13:45:18.371128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105682510>]}
[0m13:45:18.372253 [info ] [Thread-1 (]: 1 of 10 OK created sql view model RAW_STAGING.stg_globepay__acceptance ......... [[32mSUCCESS 1[0m in 0.95s]
[0m13:45:18.373237 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__acceptance
[0m13:45:18.373758 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__chargeback
[0m13:45:18.374290 [info ] [Thread-1 (]: 2 of 10 START sql view model RAW_STAGING.stg_globepay__chargeback .............. [RUN]
[0m13:45:18.374831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__acceptance, now model.deel_task.stg_globepay__chargeback)
[0m13:45:18.375152 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__chargeback
[0m13:45:18.377197 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__chargeback"
[0m13:45:18.378651 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__chargeback
[0m13:45:18.381030 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__chargeback"
[0m13:45:18.382070 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__chargeback"
[0m13:45:18.382415 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_chargeback
  );
[0m13:45:18.382715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:19.074800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:19.079158 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: Close
[0m13:45:19.244540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fea5a0>]}
[0m13:45:19.245338 [info ] [Thread-1 (]: 2 of 10 OK created sql view model RAW_STAGING.stg_globepay__chargeback ......... [[32mSUCCESS 1[0m in 0.87s]
[0m13:45:19.245912 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__chargeback
[0m13:45:19.246298 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:45:19.246751 [info ] [Thread-1 (]: 3 of 10 START test not_null_stg_globepay__acceptance_globepay_acceptance_id .... [RUN]
[0m13:45:19.247116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__chargeback, now test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f)
[0m13:45:19.247474 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:45:19.257738 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:45:19.258577 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:45:19.269743 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:45:19.270789 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:45:19.271094 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m13:45:19.271338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:19.868531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:19.876087 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: Close
[0m13:45:20.056912 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stg_globepay__acceptance_globepay_acceptance_id .......... [[32mPASS[0m in 0.81s]
[0m13:45:20.057872 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:45:20.058427 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:45:20.059160 [info ] [Thread-1 (]: 4 of 10 START test unique_stg_globepay__acceptance_globepay_acceptance_id ...... [RUN]
[0m13:45:20.059984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f, now test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4)
[0m13:45:20.060504 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:45:20.068740 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:45:20.070122 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:45:20.073885 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:45:20.076204 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:45:20.076799 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:45:20.077298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:20.720824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:20.724038 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: Close
[0m13:45:20.893546 [info ] [Thread-1 (]: 4 of 10 PASS unique_stg_globepay__acceptance_globepay_acceptance_id ............ [[32mPASS[0m in 0.83s]
[0m13:45:20.894738 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:45:20.895430 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:45:20.896175 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_globepay__chargeback_globepay_acceptance_id .... [RUN]
[0m13:45:20.896971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4, now test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657)
[0m13:45:20.897621 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:45:20.904178 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:45:20.906810 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:45:20.910365 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:45:20.912571 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:45:20.913169 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m13:45:20.913682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:21.607005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:21.610177 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: Close
[0m13:45:21.799851 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_globepay__chargeback_globepay_acceptance_id .......... [[32mPASS[0m in 0.90s]
[0m13:45:21.801794 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:45:21.802761 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:45:21.803572 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_globepay__chargeback_globepay_acceptance_id ...... [RUN]
[0m13:45:21.804495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657, now test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec)
[0m13:45:21.805134 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:45:21.811656 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:45:21.813175 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:45:21.817205 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:45:21.819340 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:45:21.819998 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:45:21.820507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:22.461063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:22.462758 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: Close
[0m13:45:22.619914 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_globepay__chargeback_globepay_acceptance_id ............ [[32mPASS[0m in 0.82s]
[0m13:45:22.620477 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:45:22.621066 [debug] [Thread-1 (]: Began running node model.deel_task.dim_globepay
[0m13:45:22.621565 [info ] [Thread-1 (]: 7 of 10 START sql view model RAW_MART.dim_globepay ............................. [RUN]
[0m13:45:22.621963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec, now model.deel_task.dim_globepay)
[0m13:45:22.622258 [debug] [Thread-1 (]: Began compiling node model.deel_task.dim_globepay
[0m13:45:22.624400 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.dim_globepay"
[0m13:45:22.626438 [debug] [Thread-1 (]: Began executing node model.deel_task.dim_globepay
[0m13:45:22.628636 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.dim_globepay"
[0m13:45:22.629887 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.dim_globepay"
[0m13:45:22.630196 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.dim_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.dim_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    chargeback.globepay_chargeback_source,
    acceptance.globepay_country,
    acceptance.globepay_currency,
    acceptance.globepay_acceptance_source,
    chargeback.is_globepay_chargeback,
    acceptance.is_globepay_cvv_provided,
    acceptance.globepay_acceptance_status,
    chargeback.globepay_chargeback_status,
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:45:22.630475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:23.579100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:23.585678 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: Close
[0m13:45:23.788129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106092030>]}
[0m13:45:23.789527 [info ] [Thread-1 (]: 7 of 10 OK created sql view model RAW_MART.dim_globepay ........................ [[32mSUCCESS 1[0m in 1.17s]
[0m13:45:23.790652 [debug] [Thread-1 (]: Finished running node model.deel_task.dim_globepay
[0m13:45:23.791426 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay
[0m13:45:23.792272 [info ] [Thread-1 (]: 8 of 10 START sql view model RAW_MART.fct_globepay ............................. [RUN]
[0m13:45:23.793077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.dim_globepay, now model.deel_task.fct_globepay)
[0m13:45:23.793709 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay
[0m13:45:23.798952 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay"
[0m13:45:23.801452 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay
[0m13:45:23.805835 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay"
[0m13:45:23.808820 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay"
[0m13:45:23.809531 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_state,
    --Getting the correct rate for country amounts
    case
        when (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency] is not null
        then (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency]::string::float
        else null
    end as country_rate_to_usd,
    acceptance.globepay_acceptance_amount/country_rate_to_usd as globepay_acceptance_amount_usd
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:45:23.810066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:24.659325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:24.664787 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: Close
[0m13:45:24.836186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fea5a0>]}
[0m13:45:24.837868 [info ] [Thread-1 (]: 8 of 10 OK created sql view model RAW_MART.fct_globepay ........................ [[32mSUCCESS 1[0m in 1.04s]
[0m13:45:24.839078 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay
[0m13:45:24.840353 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:45:24.841239 [info ] [Thread-1 (]: 9 of 10 START sql view model RAW.rpt_globepay__daily_acceptance_rate ........... [RUN]
[0m13:45:24.841983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.fct_globepay, now model.deel_task.rpt_globepay__daily_acceptance_rate)
[0m13:45:24.842556 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:45:24.847128 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:45:24.849470 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:45:24.854569 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:45:24.856833 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:45:24.857493 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__daily_acceptance_rate"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__daily_acceptance_rate
  
   as (
    --1. What is the acceptance rate over time?
with load_fct_globepay as (
    SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
)
SELECT
--DAILY GRAIN
DATE_TRUNC(day,GLOBEPAY_ACCEPTANCE_AT)::date GLOBEPAY_ACCEPTANCE_DATE,
COUNT_IF(GLOBEPAY_ACCEPTANCE_STATE = 'ACCEPTED') as count_acceptance,
COUNT(*) total_count,
count_acceptance/total_count as daily_acceptance_rate
FROM load_fct_globepay
GROUP BY GLOBEPAY_ACCEPTANCE_DATE
  );
[0m13:45:24.858031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:25.677590 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:25.681363 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: Close
[0m13:45:25.855338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060be630>]}
[0m13:45:25.857188 [info ] [Thread-1 (]: 9 of 10 OK created sql view model RAW.rpt_globepay__daily_acceptance_rate ...... [[32mSUCCESS 1[0m in 1.01s]
[0m13:45:25.858146 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:45:25.859102 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:45:25.860333 [info ] [Thread-1 (]: 10 of 10 START sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [RUN]
[0m13:45:25.861194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__daily_acceptance_rate, now model.deel_task.rpt_globepay__declined_countries_greater_25_mil)
[0m13:45:25.861836 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:45:25.866594 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:45:25.868046 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:45:25.873406 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:45:25.876100 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:45:25.876754 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__declined_countries_greater_25_mil
  
   as (
    --2. List the countries where the amount of declined transactions went over $25M
with load_fct_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
     where FCT_GLOBEPAY.GLOBEPAY_ACCEPTANCE_STATE = 'DECLINED'

),

load_dim_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay
),

join_tables as (
    SELECT *  
    FROM load_fct_globepay 
    LEFT JOIN load_dim_globepay  
    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID
)

SELECT 
GLOBEPAY_COUNTRY,
SUM(GLOBEPAY_ACCEPTANCE_AMOUNT_USD) total_amount
FROM join_tables
GROUP BY 1
--Over 25 millions
HAVING total_amount > 25000000
  );
[0m13:45:25.877292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:26.701339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:26.705241 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: Close
[0m13:45:26.925000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c2405c-54b9-49cd-84fc-0d55b70a61a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105118bc0>]}
[0m13:45:26.926929 [info ] [Thread-1 (]: 10 of 10 OK created sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [[32mSUCCESS 1[0m in 1.06s]
[0m13:45:26.927933 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:45:26.929629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:26.930133 [debug] [MainThread]: Connection 'model.deel_task.rpt_globepay__declined_countries_greater_25_mil' was properly closed.
[0m13:45:26.930569 [info ] [MainThread]: 
[0m13:45:26.930957 [info ] [MainThread]: Finished running 6 view models, 4 data tests in 0 hours 0 minutes and 14.72 seconds (14.72s).
[0m13:45:26.932706 [debug] [MainThread]: Command end result
[0m13:45:26.961885 [info ] [MainThread]: 
[0m13:45:26.962317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:26.962598 [info ] [MainThread]: 
[0m13:45:26.962873 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:45:26.964949 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.438816, "process_user_time": 2.424748, "process_kernel_time": 0.374982, "process_mem_max_rss": "135856128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:45:26.965464 [debug] [MainThread]: Command `dbt build` succeeded at 13:45:26.965387 after 15.44 seconds
[0m13:45:26.965799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d36960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10252f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b01a0>]}
[0m13:45:26.966078 [debug] [MainThread]: Flushing usage events
[0m13:52:04.779842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdf7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a1130>]}


============================== 13:52:04.783124 | d58b5117-4f64-478d-b168-b2b4d7de3091 ==============================
[0m13:52:04.783124 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:52:04.783492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'fail_fast': 'False', 'profiles_dir': './profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m13:52:05.090146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107077920>]}
[0m13:52:05.113394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922e810>]}
[0m13:52:05.114176 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m13:52:05.124557 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:52:05.223309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:52:05.223792 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/staging/globepay/_stg_globepay_models.yml
[0m13:52:05.318196 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:52:05.318583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10919df70>]}
[0m13:52:05.401148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967a510>]}
[0m13:52:05.466511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10999ad80>]}
[0m13:52:05.466841 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 444 macros
[0m13:52:05.468120 [info ] [MainThread]: 
[0m13:52:05.468459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:52:05.470481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m13:52:05.477334 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:52:05.477669 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:52:05.477920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:06.485166 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:52:06.489530 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:52:06.662712 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:52:06.663586 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:52:06.664146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:07.238921 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:52:07.243357 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:52:07.404530 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m13:52:07.405788 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m13:52:07.406313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:08.012792 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:52:08.017040 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m13:52:08.199670 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST_RAW'
[0m13:52:08.212261 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW"
[0m13:52:08.212796 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW"} */
show terse objects in DEEL_HOME_TEST.RAW limit 10000
[0m13:52:08.213210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:08.801383 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:52:08.806162 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: Close
[0m13:52:08.976891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m13:52:08.982046 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m13:52:08.982613 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m13:52:08.983099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:09.546072 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:52:09.547135 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m13:52:09.708071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now list_DEEL_HOME_TEST_RAW_MART)
[0m13:52:09.713895 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m13:52:09.714545 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m13:52:09.715032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:10.297715 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:52:10.303009 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m13:52:10.473269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098942c0>]}
[0m13:52:10.474894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:10.475723 [info ] [MainThread]: 
[0m13:52:10.480119 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__acceptance
[0m13:52:10.480970 [info ] [Thread-1 (]: 1 of 11 START sql view model RAW_STAGING.stg_globepay__acceptance .............. [RUN]
[0m13:52:10.481779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now model.deel_task.stg_globepay__acceptance)
[0m13:52:10.482516 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__acceptance
[0m13:52:10.493048 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__acceptance"
[0m13:52:10.494920 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__acceptance
[0m13:52:10.524694 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__acceptance"
[0m13:52:10.526295 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__acceptance"
[0m13:52:10.526714 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m13:52:10.527042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:11.199891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:11.231493 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: Close
[0m13:52:11.397988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976b080>]}
[0m13:52:11.399547 [info ] [Thread-1 (]: 1 of 11 OK created sql view model RAW_STAGING.stg_globepay__acceptance ......... [[32mSUCCESS 1[0m in 0.91s]
[0m13:52:11.400504 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__acceptance
[0m13:52:11.401182 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__chargeback
[0m13:52:11.402094 [info ] [Thread-1 (]: 2 of 11 START sql view model RAW_STAGING.stg_globepay__chargeback .............. [RUN]
[0m13:52:11.403070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__acceptance, now model.deel_task.stg_globepay__chargeback)
[0m13:52:11.403667 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__chargeback
[0m13:52:11.407796 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__chargeback"
[0m13:52:11.410547 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__chargeback
[0m13:52:11.414438 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__chargeback"
[0m13:52:11.416767 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__chargeback"
[0m13:52:11.417510 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_chargeback
  );
[0m13:52:11.418168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.102994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:12.106827 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: Close
[0m13:52:12.273661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10970a930>]}
[0m13:52:12.275324 [info ] [Thread-1 (]: 2 of 11 OK created sql view model RAW_STAGING.stg_globepay__chargeback ......... [[32mSUCCESS 1[0m in 0.87s]
[0m13:52:12.276291 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__chargeback
[0m13:52:12.277001 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:52:12.277849 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_globepay__acceptance_globepay_acceptance_id .... [RUN]
[0m13:52:12.278668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__chargeback, now test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f)
[0m13:52:12.279345 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:52:12.291277 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:52:12.292689 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:52:12.309729 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:52:12.311420 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m13:52:12.311864 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m13:52:12.312238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:13.139728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:13.148702 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: Close
[0m13:52:13.318922 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_globepay__acceptance_globepay_acceptance_id .......... [[32mPASS[0m in 1.04s]
[0m13:52:13.320606 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m13:52:13.321448 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:52:13.322262 [info ] [Thread-1 (]: 4 of 11 START test unique_stg_globepay__acceptance_globepay_acceptance_id ...... [RUN]
[0m13:52:13.323120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f, now test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4)
[0m13:52:13.323767 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:52:13.333656 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:52:13.336414 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:52:13.341435 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:52:13.343124 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m13:52:13.343666 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:52:13.344109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:14.009908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:14.012216 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: Close
[0m13:52:14.193587 [info ] [Thread-1 (]: 4 of 11 PASS unique_stg_globepay__acceptance_globepay_acceptance_id ............ [[32mPASS[0m in 0.87s]
[0m13:52:14.195194 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m13:52:14.195930 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:52:14.196792 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_globepay__chargeback_globepay_acceptance_id .... [RUN]
[0m13:52:14.197675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4, now test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657)
[0m13:52:14.198336 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:52:14.205023 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:52:14.207179 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:52:14.210884 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:52:14.212769 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m13:52:14.213383 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m13:52:14.213912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:14.806601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:14.809803 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: Close
[0m13:52:14.974238 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_globepay__chargeback_globepay_acceptance_id .......... [[32mPASS[0m in 0.78s]
[0m13:52:14.975344 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m13:52:14.976066 [debug] [Thread-1 (]: Began running node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m13:52:14.976869 [info ] [Thread-1 (]: 6 of 11 START test relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_  [RUN]
[0m13:52:14.977675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657, now test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c)
[0m13:52:14.978322 [debug] [Thread-1 (]: Began compiling node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m13:52:14.985644 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m13:52:14.987128 [debug] [Thread-1 (]: Began executing node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m13:52:14.990120 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m13:52:14.991789 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m13:52:14.992294 [debug] [Thread-1 (]: On test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select globepay_acceptance_id as from_field
    from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
    where globepay_acceptance_id is not null
),

parent as (
    select globepay_acceptance_id as to_field
    from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:52:14.992779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:15.686867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:15.690051 [debug] [Thread-1 (]: On test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c: Close
[0m13:52:15.856108 [info ] [Thread-1 (]: 6 of 11 PASS relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_  [[32mPASS[0m in 0.88s]
[0m13:52:15.857663 [debug] [Thread-1 (]: Finished running node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m13:52:15.858400 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:52:15.859182 [info ] [Thread-1 (]: 7 of 11 START test unique_stg_globepay__chargeback_globepay_acceptance_id ...... [RUN]
[0m13:52:15.860129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c, now test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec)
[0m13:52:15.860789 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:52:15.867516 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:52:15.868839 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:52:15.872952 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:52:15.874915 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m13:52:15.875487 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:52:15.875990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:16.481274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:16.484850 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: Close
[0m13:52:16.652456 [info ] [Thread-1 (]: 7 of 11 PASS unique_stg_globepay__chargeback_globepay_acceptance_id ............ [[32mPASS[0m in 0.79s]
[0m13:52:16.653598 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m13:52:16.654823 [debug] [Thread-1 (]: Began running node model.deel_task.dim_globepay
[0m13:52:16.655672 [info ] [Thread-1 (]: 8 of 11 START sql view model RAW_MART.dim_globepay ............................. [RUN]
[0m13:52:16.656388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec, now model.deel_task.dim_globepay)
[0m13:52:16.656951 [debug] [Thread-1 (]: Began compiling node model.deel_task.dim_globepay
[0m13:52:16.660974 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.dim_globepay"
[0m13:52:16.663383 [debug] [Thread-1 (]: Began executing node model.deel_task.dim_globepay
[0m13:52:16.669216 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.dim_globepay"
[0m13:52:16.671630 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.dim_globepay"
[0m13:52:16.672302 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.dim_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.dim_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    chargeback.globepay_chargeback_source,
    acceptance.globepay_country,
    acceptance.globepay_currency,
    acceptance.globepay_acceptance_source,
    chargeback.is_globepay_chargeback,
    acceptance.is_globepay_cvv_provided,
    acceptance.globepay_acceptance_status,
    chargeback.globepay_chargeback_status,
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:52:16.672872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:17.427844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:17.432228 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: Close
[0m13:52:17.599489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109437920>]}
[0m13:52:17.601309 [info ] [Thread-1 (]: 8 of 11 OK created sql view model RAW_MART.dim_globepay ........................ [[32mSUCCESS 1[0m in 0.94s]
[0m13:52:17.602359 [debug] [Thread-1 (]: Finished running node model.deel_task.dim_globepay
[0m13:52:17.603028 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay
[0m13:52:17.603890 [info ] [Thread-1 (]: 9 of 11 START sql view model RAW_MART.fct_globepay ............................. [RUN]
[0m13:52:17.604841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.dim_globepay, now model.deel_task.fct_globepay)
[0m13:52:17.605473 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay
[0m13:52:17.610543 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay"
[0m13:52:17.612959 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay
[0m13:52:17.617164 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay"
[0m13:52:17.620928 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay"
[0m13:52:17.621573 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_state,
    --Getting the correct rate for country amounts
    case
        when (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency] is not null
        then (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency]::string::float
        else null
    end as country_rate_to_usd,
    acceptance.globepay_acceptance_amount/country_rate_to_usd as globepay_acceptance_amount_usd
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m13:52:17.622140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:18.355400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:18.357306 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: Close
[0m13:52:18.523567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095cb170>]}
[0m13:52:18.525209 [info ] [Thread-1 (]: 9 of 11 OK created sql view model RAW_MART.fct_globepay ........................ [[32mSUCCESS 1[0m in 0.92s]
[0m13:52:18.526189 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay
[0m13:52:18.527285 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:52:18.528173 [info ] [Thread-1 (]: 10 of 11 START sql view model RAW.rpt_globepay__daily_acceptance_rate .......... [RUN]
[0m13:52:18.528868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.fct_globepay, now model.deel_task.rpt_globepay__daily_acceptance_rate)
[0m13:52:18.529446 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:52:18.533977 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:52:18.536335 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:52:18.540165 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:52:18.542723 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m13:52:18.543401 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__daily_acceptance_rate"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__daily_acceptance_rate
  
   as (
    --1. What is the acceptance rate over time?
with load_fct_globepay as (
    SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
)
SELECT
--DAILY GRAIN
DATE_TRUNC(day,GLOBEPAY_ACCEPTANCE_AT)::date GLOBEPAY_ACCEPTANCE_DATE,
COUNT_IF(GLOBEPAY_ACCEPTANCE_STATE = 'ACCEPTED') as count_acceptance,
COUNT(*) total_count,
count_acceptance/total_count as daily_acceptance_rate
FROM load_fct_globepay
GROUP BY GLOBEPAY_ACCEPTANCE_DATE
  );
[0m13:52:18.543920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:19.265731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:19.270755 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: Close
[0m13:52:19.443315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719ff80>]}
[0m13:52:19.444000 [info ] [Thread-1 (]: 10 of 11 OK created sql view model RAW.rpt_globepay__daily_acceptance_rate ..... [[32mSUCCESS 1[0m in 0.91s]
[0m13:52:19.444477 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m13:52:19.444820 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:52:19.445223 [info ] [Thread-1 (]: 11 of 11 START sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [RUN]
[0m13:52:19.445601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__daily_acceptance_rate, now model.deel_task.rpt_globepay__declined_countries_greater_25_mil)
[0m13:52:19.445872 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:52:19.447985 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:52:19.448598 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:52:19.450574 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:52:19.452059 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m13:52:19.452497 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__declined_countries_greater_25_mil
  
   as (
    --2. List the countries where the amount of declined transactions went over $25M
with load_fct_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
     where FCT_GLOBEPAY.GLOBEPAY_ACCEPTANCE_STATE = 'DECLINED'

),

load_dim_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay
),

join_tables as (
    SELECT *  
    FROM load_fct_globepay 
    LEFT JOIN load_dim_globepay  
    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID
)

SELECT 
GLOBEPAY_COUNTRY,
SUM(GLOBEPAY_ACCEPTANCE_AMOUNT_USD) total_amount
FROM join_tables
GROUP BY 1
--Over 25 millions
HAVING total_amount > 25000000
  );
[0m13:52:19.452870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:20.505565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:20.509538 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: Close
[0m13:52:20.674517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58b5117-4f64-478d-b168-b2b4d7de3091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109817aa0>]}
[0m13:52:20.675889 [info ] [Thread-1 (]: 11 of 11 OK created sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [[32mSUCCESS 1[0m in 1.23s]
[0m13:52:20.676849 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m13:52:20.678457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:20.678992 [debug] [MainThread]: Connection 'model.deel_task.rpt_globepay__declined_countries_greater_25_mil' was properly closed.
[0m13:52:20.679427 [debug] [MainThread]: Connection 'list_DEEL_HOME_TEST_RAW_MART' was properly closed.
[0m13:52:20.679971 [info ] [MainThread]: 
[0m13:52:20.680494 [info ] [MainThread]: Finished running 6 view models, 5 data tests in 0 hours 0 minutes and 15.21 seconds (15.21s).
[0m13:52:20.683057 [debug] [MainThread]: Command end result
[0m13:52:20.715415 [info ] [MainThread]: 
[0m13:52:20.715900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:20.716223 [info ] [MainThread]: 
[0m13:52:20.716502 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:52:20.718610 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.982854, "process_user_time": 2.758871, "process_kernel_time": 0.394782, "process_mem_max_rss": "138395648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:52:20.719094 [debug] [MainThread]: Command `dbt build` succeeded at 13:52:20.719019 after 15.98 seconds
[0m13:52:20.719441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10999acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f2e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10981cbf0>]}
[0m13:52:20.719765 [debug] [MainThread]: Flushing usage events
[0m14:16:17.099409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10695f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c45580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c45280>]}


============================== 14:16:17.102769 | 4abcaf01-c6fa-4b71-ac65-f745770b03a1 ==============================
[0m14:16:17.102769 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:16:17.103128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'profiles_dir': './profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:16:17.416225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffb0b0>]}
[0m14:16:17.438714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1dd30>]}
[0m14:16:17.439404 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m14:16:17.451122 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:16:17.549693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:16:17.550063 [debug] [MainThread]: Partial parsing: added file: deel_task://models/semantic/product/rpt_globepay__no_chargeback_transactions.sql
[0m14:16:17.550383 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/mart/product/_mart_product_models.yml
[0m14:16:17.646757 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:16:17.647127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa3ef0>]}
[0m14:16:17.727225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b9c980>]}
[0m14:16:17.794154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c10d10>]}
[0m14:16:17.794478 [info ] [MainThread]: Found 7 models, 9 data tests, 2 sources, 444 macros
[0m14:16:17.795949 [info ] [MainThread]: 
[0m14:16:17.796276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:16:17.798336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m14:16:17.804957 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m14:16:17.805186 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m14:16:17.805369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:19.019745 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:16:19.021286 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m14:16:19.194687 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m14:16:19.195542 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m14:16:19.196060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:19.943022 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:16:19.947398 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m14:16:20.127316 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m14:16:20.128345 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m14:16:20.128835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:20.672424 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:16:20.677019 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m14:16:20.853822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW)
[0m14:16:20.866081 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW"
[0m14:16:20.866603 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW"} */
show terse objects in DEEL_HOME_TEST.RAW limit 10000
[0m14:16:20.867019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:21.444418 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:16:21.449687 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: Close
[0m14:16:21.609112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m14:16:21.611400 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m14:16:21.611675 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m14:16:21.611906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:22.128446 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:16:22.133018 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m14:16:22.304374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now list_DEEL_HOME_TEST_RAW_MART)
[0m14:16:22.310186 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m14:16:22.310779 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m14:16:22.311271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:22.932066 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:16:22.938476 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m14:16:23.107105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3f2c0>]}
[0m14:16:23.108370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:23.108995 [info ] [MainThread]: 
[0m14:16:23.112406 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__acceptance
[0m14:16:23.113183 [info ] [Thread-1 (]: 1 of 16 START sql view model RAW_STAGING.stg_globepay__acceptance .............. [RUN]
[0m14:16:23.113788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now model.deel_task.stg_globepay__acceptance)
[0m14:16:23.114267 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__acceptance
[0m14:16:23.123068 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__acceptance"
[0m14:16:23.125197 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__acceptance
[0m14:16:23.153432 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__acceptance"
[0m14:16:23.155333 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__acceptance"
[0m14:16:23.155750 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m14:16:23.156105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:23.827364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:23.858420 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: Close
[0m14:16:24.028696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f9610>]}
[0m14:16:24.029973 [info ] [Thread-1 (]: 1 of 16 OK created sql view model RAW_STAGING.stg_globepay__acceptance ......... [[32mSUCCESS 1[0m in 0.91s]
[0m14:16:24.030981 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__acceptance
[0m14:16:24.031653 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__chargeback
[0m14:16:24.032638 [info ] [Thread-1 (]: 2 of 16 START sql view model RAW_STAGING.stg_globepay__chargeback .............. [RUN]
[0m14:16:24.033459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__acceptance, now model.deel_task.stg_globepay__chargeback)
[0m14:16:24.034073 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__chargeback
[0m14:16:24.037930 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__chargeback"
[0m14:16:24.039954 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__chargeback
[0m14:16:24.045475 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__chargeback"
[0m14:16:24.047671 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__chargeback"
[0m14:16:24.048320 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_chargeback
  );
[0m14:16:24.048770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:24.739754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:24.744470 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: Close
[0m14:16:24.920367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106cd4f0>]}
[0m14:16:24.922331 [info ] [Thread-1 (]: 2 of 16 OK created sql view model RAW_STAGING.stg_globepay__chargeback ......... [[32mSUCCESS 1[0m in 0.89s]
[0m14:16:24.923360 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__chargeback
[0m14:16:24.924092 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:16:24.924891 [info ] [Thread-1 (]: 3 of 16 START test not_null_stg_globepay__acceptance_globepay_acceptance_id .... [RUN]
[0m14:16:24.925877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__chargeback, now test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f)
[0m14:16:24.926475 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:16:24.944341 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m14:16:24.945486 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:16:24.963109 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m14:16:24.964780 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m14:16:24.965172 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:16:24.965497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:25.983913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:25.992759 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: Close
[0m14:16:26.159960 [info ] [Thread-1 (]: 3 of 16 PASS not_null_stg_globepay__acceptance_globepay_acceptance_id .......... [[32mPASS[0m in 1.23s]
[0m14:16:26.161359 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:16:26.162651 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:16:26.163635 [info ] [Thread-1 (]: 4 of 16 START test unique_stg_globepay__acceptance_globepay_acceptance_id ...... [RUN]
[0m14:16:26.164518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f, now test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4)
[0m14:16:26.165154 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:16:26.175377 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m14:16:26.177447 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:16:26.180870 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m14:16:26.182457 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m14:16:26.183029 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:16:26.183547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:27.150141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:27.154993 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: Close
[0m14:16:27.327357 [info ] [Thread-1 (]: 4 of 16 PASS unique_stg_globepay__acceptance_globepay_acceptance_id ............ [[32mPASS[0m in 1.16s]
[0m14:16:27.328863 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:16:27.329744 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:16:27.330743 [info ] [Thread-1 (]: 5 of 16 START test not_null_stg_globepay__chargeback_globepay_acceptance_id .... [RUN]
[0m14:16:27.331621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4, now test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657)
[0m14:16:27.332267 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:16:27.338973 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m14:16:27.340452 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:16:27.344868 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m14:16:27.346663 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m14:16:27.347299 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:16:27.347810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:27.984625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:27.986860 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: Close
[0m14:16:28.147549 [info ] [Thread-1 (]: 5 of 16 PASS not_null_stg_globepay__chargeback_globepay_acceptance_id .......... [[32mPASS[0m in 0.82s]
[0m14:16:28.148674 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:16:28.149364 [debug] [Thread-1 (]: Began running node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:16:28.150156 [info ] [Thread-1 (]: 6 of 16 START test relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_  [RUN]
[0m14:16:28.150988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657, now test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c)
[0m14:16:28.151659 [debug] [Thread-1 (]: Began compiling node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:16:28.163867 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m14:16:28.166679 [debug] [Thread-1 (]: Began executing node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:16:28.169600 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m14:16:28.171226 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m14:16:28.171744 [debug] [Thread-1 (]: On test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select globepay_acceptance_id as from_field
    from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
    where globepay_acceptance_id is not null
),

parent as (
    select globepay_acceptance_id as to_field
    from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:16:28.172197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:29.003200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:29.008342 [debug] [Thread-1 (]: On test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c: Close
[0m14:16:29.172841 [info ] [Thread-1 (]: 6 of 16 PASS relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_  [[32mPASS[0m in 1.02s]
[0m14:16:29.176249 [debug] [Thread-1 (]: Finished running node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:16:29.177264 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:16:29.179867 [info ] [Thread-1 (]: 7 of 16 START test unique_stg_globepay__chargeback_globepay_acceptance_id ...... [RUN]
[0m14:16:29.180590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c, now test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec)
[0m14:16:29.181164 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:16:29.188126 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m14:16:29.189896 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:16:29.195805 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m14:16:29.198310 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m14:16:29.198980 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:16:29.199514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:29.871288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:29.875797 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: Close
[0m14:16:30.043144 [info ] [Thread-1 (]: 7 of 16 PASS unique_stg_globepay__chargeback_globepay_acceptance_id ............ [[32mPASS[0m in 0.86s]
[0m14:16:30.044389 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:16:30.045567 [debug] [Thread-1 (]: Began running node model.deel_task.dim_globepay
[0m14:16:30.046340 [info ] [Thread-1 (]: 8 of 16 START sql view model RAW_MART.dim_globepay ............................. [RUN]
[0m14:16:30.046997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec, now model.deel_task.dim_globepay)
[0m14:16:30.047558 [debug] [Thread-1 (]: Began compiling node model.deel_task.dim_globepay
[0m14:16:30.052076 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.dim_globepay"
[0m14:16:30.054508 [debug] [Thread-1 (]: Began executing node model.deel_task.dim_globepay
[0m14:16:30.059935 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.dim_globepay"
[0m14:16:30.062694 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.dim_globepay"
[0m14:16:30.063327 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.dim_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.dim_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    chargeback.globepay_chargeback_source,
    acceptance.globepay_country,
    acceptance.globepay_currency,
    acceptance.globepay_acceptance_source,
    chargeback.is_globepay_chargeback,
    acceptance.is_globepay_cvv_provided,
    acceptance.globepay_acceptance_status,
    chargeback.globepay_chargeback_status,
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m14:16:30.063869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:31.001155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:31.008250 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: Close
[0m14:16:31.182381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110381220>]}
[0m14:16:31.183866 [info ] [Thread-1 (]: 8 of 16 OK created sql view model RAW_MART.dim_globepay ........................ [[32mSUCCESS 1[0m in 1.14s]
[0m14:16:31.185079 [debug] [Thread-1 (]: Finished running node model.deel_task.dim_globepay
[0m14:16:31.185911 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay
[0m14:16:31.186864 [info ] [Thread-1 (]: 9 of 16 START sql view model RAW_MART.fct_globepay ............................. [RUN]
[0m14:16:31.187618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.dim_globepay, now model.deel_task.fct_globepay)
[0m14:16:31.188163 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay
[0m14:16:31.193275 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay"
[0m14:16:31.195926 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay
[0m14:16:31.200379 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay"
[0m14:16:31.203221 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay"
[0m14:16:31.203838 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_state,
    --Getting the correct rate for country amounts
    case
        when (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency] is not null
        then (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency]::string::float
        else null
    end as country_rate_to_usd,
    acceptance.globepay_acceptance_amount/country_rate_to_usd as globepay_acceptance_amount_usd
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m14:16:31.204369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:32.127192 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:32.131295 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: Close
[0m14:16:32.296859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3d580>]}
[0m14:16:32.298612 [info ] [Thread-1 (]: 9 of 16 OK created sql view model RAW_MART.fct_globepay ........................ [[32mSUCCESS 1[0m in 1.11s]
[0m14:16:32.299967 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay
[0m14:16:32.300691 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:16:32.301448 [info ] [Thread-1 (]: 10 of 16 START test not_null_dim_globepay_globepay_acceptance_id ............... [RUN]
[0m14:16:32.302417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.fct_globepay, now test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc)
[0m14:16:32.303024 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:16:32.309678 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"
[0m14:16:32.311278 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:16:32.315238 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"
[0m14:16:32.317180 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"
[0m14:16:32.317742 [debug] [Thread-1 (]: On test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_MART.dim_globepay
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:16:32.318236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:33.042773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:33.046204 [debug] [Thread-1 (]: On test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc: Close
[0m14:16:33.214773 [info ] [Thread-1 (]: 10 of 16 PASS not_null_dim_globepay_globepay_acceptance_id ..................... [[32mPASS[0m in 0.91s]
[0m14:16:33.216367 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:16:33.217297 [debug] [Thread-1 (]: Began running node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:16:33.218247 [info ] [Thread-1 (]: 11 of 16 START test unique_dim_globepay_globepay_acceptance_id ................. [RUN]
[0m14:16:33.219151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc, now test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd)
[0m14:16:33.219808 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:16:33.226502 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"
[0m14:16:33.228523 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:16:33.233953 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"
[0m14:16:33.236043 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"
[0m14:16:33.236611 [debug] [Thread-1 (]: On test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_MART.dim_globepay
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:16:33.237139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:33.963719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:33.967303 [debug] [Thread-1 (]: On test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd: Close
[0m14:16:34.130343 [info ] [Thread-1 (]: 11 of 16 PASS unique_dim_globepay_globepay_acceptance_id ....................... [[32mPASS[0m in 0.91s]
[0m14:16:34.131431 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:16:34.132109 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:16:34.132853 [info ] [Thread-1 (]: 12 of 16 START test not_null_fct_globepay_globepay_acceptance_id ............... [RUN]
[0m14:16:34.133673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd, now test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77)
[0m14:16:34.134327 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:16:34.140866 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"
[0m14:16:34.142140 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:16:34.146372 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"
[0m14:16:34.148149 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"
[0m14:16:34.148684 [debug] [Thread-1 (]: On test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_MART.fct_globepay
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:16:34.149154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:34.781913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:34.785344 [debug] [Thread-1 (]: On test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77: Close
[0m14:16:34.946132 [info ] [Thread-1 (]: 12 of 16 PASS not_null_fct_globepay_globepay_acceptance_id ..................... [[32mPASS[0m in 0.81s]
[0m14:16:34.947267 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:16:34.947833 [debug] [Thread-1 (]: Began running node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:16:34.948415 [info ] [Thread-1 (]: 13 of 16 START test unique_fct_globepay_globepay_acceptance_id ................. [RUN]
[0m14:16:34.949087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77, now test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182)
[0m14:16:34.949602 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:16:34.955027 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"
[0m14:16:34.956353 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:16:34.959334 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"
[0m14:16:34.960810 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"
[0m14:16:34.961805 [debug] [Thread-1 (]: On test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_MART.fct_globepay
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:16:34.962288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:35.643324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:35.646889 [debug] [Thread-1 (]: On test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182: Close
[0m14:16:35.819408 [info ] [Thread-1 (]: 13 of 16 PASS unique_fct_globepay_globepay_acceptance_id ....................... [[32mPASS[0m in 0.87s]
[0m14:16:35.821104 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:16:35.823064 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:16:35.823915 [info ] [Thread-1 (]: 14 of 16 START sql view model RAW.rpt_globepay__daily_acceptance_rate .......... [RUN]
[0m14:16:35.824666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182, now model.deel_task.rpt_globepay__daily_acceptance_rate)
[0m14:16:35.825256 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:16:35.829283 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m14:16:35.831773 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:16:35.836751 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m14:16:35.838694 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m14:16:35.839254 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__daily_acceptance_rate"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__daily_acceptance_rate
  
   as (
    --1. What is the acceptance rate over time?
with load_fct_globepay as (
    SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
)
SELECT
--DAILY GRAIN
DATE_TRUNC(day,GLOBEPAY_ACCEPTANCE_AT)::date GLOBEPAY_ACCEPTANCE_DATE,
COUNT_IF(GLOBEPAY_ACCEPTANCE_STATE = 'ACCEPTED') as count_acceptance,
COUNT(*) total_count,
count_acceptance/total_count as daily_acceptance_rate
FROM load_fct_globepay
GROUP BY GLOBEPAY_ACCEPTANCE_DATE
  );
[0m14:16:35.839749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:36.571448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:36.573225 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: Close
[0m14:16:36.739410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110460b00>]}
[0m14:16:36.740615 [info ] [Thread-1 (]: 14 of 16 OK created sql view model RAW.rpt_globepay__daily_acceptance_rate ..... [[32mSUCCESS 1[0m in 0.91s]
[0m14:16:36.741541 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:16:36.742198 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:16:36.743054 [info ] [Thread-1 (]: 15 of 16 START sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [RUN]
[0m14:16:36.743864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__daily_acceptance_rate, now model.deel_task.rpt_globepay__declined_countries_greater_25_mil)
[0m14:16:36.744555 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:16:36.749576 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m14:16:36.751006 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:16:36.757881 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m14:16:36.760576 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m14:16:36.761157 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__declined_countries_greater_25_mil
  
   as (
    --2. List the countries where the amount of declined transactions went over $25M
with load_fct_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
     where FCT_GLOBEPAY.GLOBEPAY_ACCEPTANCE_STATE = 'DECLINED'

),

load_dim_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay
),

join_tables as (
    SELECT *  
    FROM load_fct_globepay 
    LEFT JOIN load_dim_globepay  
    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID
)

SELECT 
GLOBEPAY_COUNTRY,
SUM(GLOBEPAY_ACCEPTANCE_AMOUNT_USD) total_amount
FROM join_tables
GROUP BY 1
--Over 25 millions
HAVING total_amount > 25000000
  );
[0m14:16:36.761657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:37.564466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:16:37.570281 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: Close
[0m14:16:37.737330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160747a0>]}
[0m14:16:37.738963 [info ] [Thread-1 (]: 15 of 16 OK created sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [[32mSUCCESS 1[0m in 0.99s]
[0m14:16:37.739969 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:16:37.740684 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:16:37.741544 [info ] [Thread-1 (]: 16 of 16 START sql view model RAW.rpt_globepay__no_chargeback_transactions ..... [RUN]
[0m14:16:37.742407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__declined_countries_greater_25_mil, now model.deel_task.rpt_globepay__no_chargeback_transactions)
[0m14:16:37.743072 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:16:37.747942 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__no_chargeback_transactions"
[0m14:16:37.749486 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:16:37.754036 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__no_chargeback_transactions"
[0m14:16:37.756310 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__no_chargeback_transactions"
[0m14:16:37.756972 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__no_chargeback_transactions: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__no_chargeback_transactions"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__no_chargeback_transactions
  
   as (
    with load_dim_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay
     where not is_globepay_chargeback 
),
load_fct_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay

),

join_tables as (
    SELECT *  
    FROM load_dim_globepay 
    LEFT JOIN load_fct_globepay  
    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID
)

SELECT * FROM join_tables
  );
[0m14:16:37.757687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:38.481259 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b5dc40-0000-6d00-0000-0000ca65473d
[0m14:16:38.481988 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'GLOBEPAY_ACCEPTANCE_ID'
[0m14:16:38.482653 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__no_chargeback_transactions: Close
[0m14:16:38.675762 [debug] [Thread-1 (]: Database Error in model rpt_globepay__no_chargeback_transactions (models/semantic/product/rpt_globepay__no_chargeback_transactions.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'GLOBEPAY_ACCEPTANCE_ID'
  compiled Code at target/run/deel_task/models/semantic/product/rpt_globepay__no_chargeback_transactions.sql
[0m14:16:38.676754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abcaf01-c6fa-4b71-ac65-f745770b03a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160827e0>]}
[0m14:16:38.677761 [error] [Thread-1 (]: 16 of 16 ERROR creating sql view model RAW.rpt_globepay__no_chargeback_transactions  [[31mERROR[0m in 0.93s]
[0m14:16:38.678686 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:16:38.680610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:38.681200 [debug] [MainThread]: Connection 'model.deel_task.rpt_globepay__no_chargeback_transactions' was properly closed.
[0m14:16:38.681779 [info ] [MainThread]: 
[0m14:16:38.682302 [info ] [MainThread]: Finished running 7 view models, 9 data tests in 0 hours 0 minutes and 20.89 seconds (20.89s).
[0m14:16:38.685114 [debug] [MainThread]: Command end result
[0m14:16:38.717135 [info ] [MainThread]: 
[0m14:16:38.717586 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:16:38.717851 [info ] [MainThread]: 
[0m14:16:38.718185 [error] [MainThread]:   Database Error in model rpt_globepay__no_chargeback_transactions (models/semantic/product/rpt_globepay__no_chargeback_transactions.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'GLOBEPAY_ACCEPTANCE_ID'
  compiled Code at target/run/deel_task/models/semantic/product/rpt_globepay__no_chargeback_transactions.sql
[0m14:16:38.718458 [info ] [MainThread]: 
[0m14:16:38.718718 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m14:16:38.721399 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 21.66161, "process_user_time": 3.254454, "process_kernel_time": 0.438777, "process_mem_max_rss": "137576448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:16:38.721867 [debug] [MainThread]: Command `dbt build` failed at 14:16:38.721794 after 21.66 seconds
[0m14:16:38.722194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10695f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11068b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100fb890>]}
[0m14:16:38.722679 [debug] [MainThread]: Flushing usage events
[0m14:17:20.878880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108357920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d987a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de12b0>]}


============================== 14:17:20.881947 | 4816184a-0db9-408a-8532-aae36ecb84c3 ==============================
[0m14:17:20.881947 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:17:20.882348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:17:21.185024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af9fad0>]}
[0m14:17:21.207698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827b650>]}
[0m14:17:21.208416 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m14:17:21.219769 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:17:21.318281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:17:21.318687 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/semantic/product/rpt_globepay__no_chargeback_transactions.sql
[0m14:17:21.422801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f6b10>]}
[0m14:17:21.487466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b49e090>]}
[0m14:17:21.487778 [info ] [MainThread]: Found 7 models, 9 data tests, 2 sources, 444 macros
[0m14:17:21.489233 [info ] [MainThread]: 
[0m14:17:21.489570 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:21.491608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m14:17:21.500192 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m14:17:21.500643 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m14:17:21.500828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:22.432438 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:17:22.436546 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m14:17:22.605195 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m14:17:22.605852 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m14:17:22.606354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:23.134202 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:17:23.139845 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m14:17:23.363540 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m14:17:23.364356 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m14:17:23.365451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:23.926081 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:17:23.930946 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m14:17:24.105007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW_MART)
[0m14:17:24.118168 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m14:17:24.118717 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m14:17:24.119151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:24.834590 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:17:24.838959 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m14:17:25.004397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now list_DEEL_HOME_TEST_RAW)
[0m14:17:25.009520 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW"
[0m14:17:25.010085 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW"} */
show terse objects in DEEL_HOME_TEST.RAW limit 10000
[0m14:17:25.010590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:25.540036 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:17:25.542644 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: Close
[0m14:17:25.700455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m14:17:25.702983 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m14:17:25.703302 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m14:17:25.703562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:26.283330 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:17:26.287831 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m14:17:26.463113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af25d60>]}
[0m14:17:26.464406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:26.465113 [info ] [MainThread]: 
[0m14:17:26.469490 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__acceptance
[0m14:17:26.470426 [info ] [Thread-1 (]: 1 of 16 START sql view model RAW_STAGING.stg_globepay__acceptance .............. [RUN]
[0m14:17:26.471229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now model.deel_task.stg_globepay__acceptance)
[0m14:17:26.471980 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__acceptance
[0m14:17:26.482244 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__acceptance"
[0m14:17:26.483899 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__acceptance
[0m14:17:26.512480 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__acceptance"
[0m14:17:26.514362 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__acceptance"
[0m14:17:26.514741 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m14:17:26.515077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:27.193469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:27.266449 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: Close
[0m14:17:27.452468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b77a0>]}
[0m14:17:27.453707 [info ] [Thread-1 (]: 1 of 16 OK created sql view model RAW_STAGING.stg_globepay__acceptance ......... [[32mSUCCESS 1[0m in 0.98s]
[0m14:17:27.454749 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__acceptance
[0m14:17:27.455451 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__chargeback
[0m14:17:27.456395 [info ] [Thread-1 (]: 2 of 16 START sql view model RAW_STAGING.stg_globepay__chargeback .............. [RUN]
[0m14:17:27.457200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__acceptance, now model.deel_task.stg_globepay__chargeback)
[0m14:17:27.457937 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__chargeback
[0m14:17:27.462475 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__chargeback"
[0m14:17:27.463821 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__chargeback
[0m14:17:27.467337 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__chargeback"
[0m14:17:27.469589 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__chargeback"
[0m14:17:27.470349 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_chargeback
  );
[0m14:17:27.470846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:28.235706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:28.239812 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: Close
[0m14:17:28.410400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b376150>]}
[0m14:17:28.412196 [info ] [Thread-1 (]: 2 of 16 OK created sql view model RAW_STAGING.stg_globepay__chargeback ......... [[32mSUCCESS 1[0m in 0.95s]
[0m14:17:28.413402 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__chargeback
[0m14:17:28.414097 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:17:28.414951 [info ] [Thread-1 (]: 3 of 16 START test not_null_stg_globepay__acceptance_globepay_acceptance_id .... [RUN]
[0m14:17:28.415788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__chargeback, now test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f)
[0m14:17:28.416530 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:17:28.433497 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m14:17:28.436190 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:17:28.452535 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m14:17:28.454100 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m14:17:28.454519 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:17:28.454859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:29.062825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:29.069460 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: Close
[0m14:17:29.237222 [info ] [Thread-1 (]: 3 of 16 PASS not_null_stg_globepay__acceptance_globepay_acceptance_id .......... [[32mPASS[0m in 0.82s]
[0m14:17:29.238628 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:17:29.239313 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:17:29.240073 [info ] [Thread-1 (]: 4 of 16 START test unique_stg_globepay__acceptance_globepay_acceptance_id ...... [RUN]
[0m14:17:29.240891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f, now test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4)
[0m14:17:29.241532 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:17:29.251067 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m14:17:29.252923 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:17:29.256768 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m14:17:29.258821 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m14:17:29.259492 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:17:29.259985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:29.853197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:29.855593 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: Close
[0m14:17:30.023456 [info ] [Thread-1 (]: 4 of 16 PASS unique_stg_globepay__acceptance_globepay_acceptance_id ............ [[32mPASS[0m in 0.78s]
[0m14:17:30.024621 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:17:30.025303 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:17:30.026052 [info ] [Thread-1 (]: 5 of 16 START test not_null_stg_globepay__chargeback_globepay_acceptance_id .... [RUN]
[0m14:17:30.026987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4, now test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657)
[0m14:17:30.027848 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:17:30.034394 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m14:17:30.035733 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:17:30.040970 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m14:17:30.042905 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m14:17:30.043430 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:17:30.043844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.695957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:30.697592 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: Close
[0m14:17:30.855613 [info ] [Thread-1 (]: 5 of 16 PASS not_null_stg_globepay__chargeback_globepay_acceptance_id .......... [[32mPASS[0m in 0.83s]
[0m14:17:30.856626 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:17:30.857202 [debug] [Thread-1 (]: Began running node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:17:30.857836 [info ] [Thread-1 (]: 6 of 16 START test relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_  [RUN]
[0m14:17:30.858480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657, now test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c)
[0m14:17:30.859024 [debug] [Thread-1 (]: Began compiling node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:17:30.869679 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m14:17:30.872469 [debug] [Thread-1 (]: Began executing node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:17:30.875593 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m14:17:30.877443 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m14:17:30.877916 [debug] [Thread-1 (]: On test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select globepay_acceptance_id as from_field
    from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
    where globepay_acceptance_id is not null
),

parent as (
    select globepay_acceptance_id as to_field
    from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:17:30.878336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:31.616257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:31.619831 [debug] [Thread-1 (]: On test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c: Close
[0m14:17:31.782540 [info ] [Thread-1 (]: 6 of 16 PASS relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_  [[32mPASS[0m in 0.92s]
[0m14:17:31.783310 [debug] [Thread-1 (]: Finished running node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:17:31.783745 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:17:31.784208 [info ] [Thread-1 (]: 7 of 16 START test unique_stg_globepay__chargeback_globepay_acceptance_id ...... [RUN]
[0m14:17:31.784729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c, now test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec)
[0m14:17:31.785161 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:17:31.789086 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m14:17:31.790112 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:17:31.792362 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m14:17:31.793912 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m14:17:31.794456 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:17:31.794902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:32.359363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:32.363556 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: Close
[0m14:17:32.523706 [info ] [Thread-1 (]: 7 of 16 PASS unique_stg_globepay__chargeback_globepay_acceptance_id ............ [[32mPASS[0m in 0.74s]
[0m14:17:32.525159 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:17:32.526582 [debug] [Thread-1 (]: Began running node model.deel_task.dim_globepay
[0m14:17:32.527367 [info ] [Thread-1 (]: 8 of 16 START sql view model RAW_MART.dim_globepay ............................. [RUN]
[0m14:17:32.528042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec, now model.deel_task.dim_globepay)
[0m14:17:32.528587 [debug] [Thread-1 (]: Began compiling node model.deel_task.dim_globepay
[0m14:17:32.533092 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.dim_globepay"
[0m14:17:32.535684 [debug] [Thread-1 (]: Began executing node model.deel_task.dim_globepay
[0m14:17:32.539557 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.dim_globepay"
[0m14:17:32.541796 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.dim_globepay"
[0m14:17:32.542379 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.dim_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.dim_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    chargeback.globepay_chargeback_source,
    acceptance.globepay_country,
    acceptance.globepay_currency,
    acceptance.globepay_acceptance_source,
    chargeback.is_globepay_chargeback,
    acceptance.is_globepay_cvv_provided,
    acceptance.globepay_acceptance_status,
    chargeback.globepay_chargeback_status,
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m14:17:32.542866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:33.463515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:33.467478 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: Close
[0m14:17:33.637147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b785bb0>]}
[0m14:17:33.638480 [info ] [Thread-1 (]: 8 of 16 OK created sql view model RAW_MART.dim_globepay ........................ [[32mSUCCESS 1[0m in 1.11s]
[0m14:17:33.639634 [debug] [Thread-1 (]: Finished running node model.deel_task.dim_globepay
[0m14:17:33.640435 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay
[0m14:17:33.641332 [info ] [Thread-1 (]: 9 of 16 START sql view model RAW_MART.fct_globepay ............................. [RUN]
[0m14:17:33.642306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.dim_globepay, now model.deel_task.fct_globepay)
[0m14:17:33.642927 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay
[0m14:17:33.648206 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay"
[0m14:17:33.650655 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay
[0m14:17:33.656772 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay"
[0m14:17:33.659732 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay"
[0m14:17:33.660496 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_state,
    --Getting the correct rate for country amounts
    case
        when (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency] is not null
        then (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency]::string::float
        else null
    end as country_rate_to_usd,
    acceptance.globepay_acceptance_amount/country_rate_to_usd as globepay_acceptance_amount_usd
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m14:17:33.661080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:34.388449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:34.393232 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: Close
[0m14:17:34.563263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c22a3c0>]}
[0m14:17:34.564770 [info ] [Thread-1 (]: 9 of 16 OK created sql view model RAW_MART.fct_globepay ........................ [[32mSUCCESS 1[0m in 0.92s]
[0m14:17:34.565931 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay
[0m14:17:34.566764 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:17:34.567542 [info ] [Thread-1 (]: 10 of 16 START test not_null_dim_globepay_globepay_acceptance_id ............... [RUN]
[0m14:17:34.568531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.fct_globepay, now test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc)
[0m14:17:34.569220 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:17:34.575835 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"
[0m14:17:34.577285 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:17:34.581967 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"
[0m14:17:34.583620 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"
[0m14:17:34.584159 [debug] [Thread-1 (]: On test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_MART.dim_globepay
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:17:34.584632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:35.397819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:35.399716 [debug] [Thread-1 (]: On test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc: Close
[0m14:17:35.568959 [info ] [Thread-1 (]: 10 of 16 PASS not_null_dim_globepay_globepay_acceptance_id ..................... [[32mPASS[0m in 1.00s]
[0m14:17:35.569936 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:17:35.570494 [debug] [Thread-1 (]: Began running node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:17:35.571079 [info ] [Thread-1 (]: 11 of 16 START test unique_dim_globepay_globepay_acceptance_id ................. [RUN]
[0m14:17:35.571803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc, now test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd)
[0m14:17:35.572389 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:17:35.578327 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"
[0m14:17:35.579484 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:17:35.582717 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"
[0m14:17:35.584289 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"
[0m14:17:35.584870 [debug] [Thread-1 (]: On test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_MART.dim_globepay
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:17:35.585321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:36.319921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:36.322683 [debug] [Thread-1 (]: On test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd: Close
[0m14:17:36.483641 [info ] [Thread-1 (]: 11 of 16 PASS unique_dim_globepay_globepay_acceptance_id ....................... [[32mPASS[0m in 0.91s]
[0m14:17:36.485229 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:17:36.485962 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:17:36.486784 [info ] [Thread-1 (]: 12 of 16 START test not_null_fct_globepay_globepay_acceptance_id ............... [RUN]
[0m14:17:36.487623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd, now test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77)
[0m14:17:36.488242 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:17:36.494836 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"
[0m14:17:36.496101 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:17:36.499143 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"
[0m14:17:36.500610 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"
[0m14:17:36.501175 [debug] [Thread-1 (]: On test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_MART.fct_globepay
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:17:36.501659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:37.137367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:37.138882 [debug] [Thread-1 (]: On test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77: Close
[0m14:17:37.300681 [info ] [Thread-1 (]: 12 of 16 PASS not_null_fct_globepay_globepay_acceptance_id ..................... [[32mPASS[0m in 0.81s]
[0m14:17:37.301533 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:17:37.302010 [debug] [Thread-1 (]: Began running node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:17:37.302536 [info ] [Thread-1 (]: 13 of 16 START test unique_fct_globepay_globepay_acceptance_id ................. [RUN]
[0m14:17:37.303123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77, now test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182)
[0m14:17:37.303576 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:17:37.308972 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"
[0m14:17:37.310037 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:17:37.313809 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"
[0m14:17:37.314957 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"
[0m14:17:37.315365 [debug] [Thread-1 (]: On test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_MART.fct_globepay
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:17:37.315728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:37.936625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:37.939874 [debug] [Thread-1 (]: On test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182: Close
[0m14:17:38.100962 [info ] [Thread-1 (]: 13 of 16 PASS unique_fct_globepay_globepay_acceptance_id ....................... [[32mPASS[0m in 0.80s]
[0m14:17:38.102142 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:17:38.103350 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:17:38.104239 [info ] [Thread-1 (]: 14 of 16 START sql view model RAW.rpt_globepay__daily_acceptance_rate .......... [RUN]
[0m14:17:38.104914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182, now model.deel_task.rpt_globepay__daily_acceptance_rate)
[0m14:17:38.105396 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:17:38.109081 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m14:17:38.111496 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:17:38.115417 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m14:17:38.117160 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m14:17:38.117682 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__daily_acceptance_rate"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__daily_acceptance_rate
  
   as (
    --1. What is the acceptance rate over time?
with load_fct_globepay as (
    SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
)
SELECT
--DAILY GRAIN
DATE_TRUNC(day,GLOBEPAY_ACCEPTANCE_AT)::date GLOBEPAY_ACCEPTANCE_DATE,
COUNT_IF(GLOBEPAY_ACCEPTANCE_STATE = 'ACCEPTED') as count_acceptance,
COUNT(*) total_count,
count_acceptance/total_count as daily_acceptance_rate
FROM load_fct_globepay
GROUP BY GLOBEPAY_ACCEPTANCE_DATE
  );
[0m14:17:38.118135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:38.853201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:38.857513 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: Close
[0m14:17:39.020505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2382f0>]}
[0m14:17:39.022461 [info ] [Thread-1 (]: 14 of 16 OK created sql view model RAW.rpt_globepay__daily_acceptance_rate ..... [[32mSUCCESS 1[0m in 0.92s]
[0m14:17:39.024010 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:17:39.024742 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:17:39.025710 [info ] [Thread-1 (]: 15 of 16 START sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [RUN]
[0m14:17:39.026623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__daily_acceptance_rate, now model.deel_task.rpt_globepay__declined_countries_greater_25_mil)
[0m14:17:39.027328 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:17:39.032341 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m14:17:39.033849 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:17:39.037354 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m14:17:39.039413 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m14:17:39.040031 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__declined_countries_greater_25_mil
  
   as (
    --2. List the countries where the amount of declined transactions went over $25M
with load_fct_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
     where FCT_GLOBEPAY.GLOBEPAY_ACCEPTANCE_STATE = 'DECLINED'

),

load_dim_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay
),

join_tables as (
    SELECT *  
    FROM load_fct_globepay 
    LEFT JOIN load_dim_globepay  
    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID
)

SELECT 
GLOBEPAY_COUNTRY,
SUM(GLOBEPAY_ACCEPTANCE_AMOUNT_USD) total_amount
FROM join_tables
GROUP BY 1
--Over 25 millions
HAVING total_amount > 25000000
  );
[0m14:17:39.040567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:39.909046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:39.911725 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: Close
[0m14:17:40.065533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4bcfe0>]}
[0m14:17:40.066158 [info ] [Thread-1 (]: 15 of 16 OK created sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [[32mSUCCESS 1[0m in 1.04s]
[0m14:17:40.066591 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:17:40.066889 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:17:40.067266 [info ] [Thread-1 (]: 16 of 16 START sql view model RAW.rpt_globepay__no_chargeback_transactions ..... [RUN]
[0m14:17:40.067623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__declined_countries_greater_25_mil, now model.deel_task.rpt_globepay__no_chargeback_transactions)
[0m14:17:40.067882 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:17:40.069881 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__no_chargeback_transactions"
[0m14:17:40.070588 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:17:40.072443 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__no_chargeback_transactions"
[0m14:17:40.073540 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__no_chargeback_transactions"
[0m14:17:40.073857 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__no_chargeback_transactions: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__no_chargeback_transactions"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__no_chargeback_transactions
  
   as (
    with load_dim_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay
     where not is_globepay_chargeback 
),
load_fct_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay

),

join_tables as (
    SELECT 
    load_dim_globepay.globepay_acceptance_id,
    load_fct_globepay.globepay_acceptance_event_id
    FROM load_dim_globepay 
    LEFT JOIN load_fct_globepay  
    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID
)

SELECT * FROM join_tables
  );
[0m14:17:40.074175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:40.831626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:40.835517 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__no_chargeback_transactions: Close
[0m14:17:40.993058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4816184a-0db9-408a-8532-aae36ecb84c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afdb2f0>]}
[0m14:17:40.994308 [info ] [Thread-1 (]: 16 of 16 OK created sql view model RAW.rpt_globepay__no_chargeback_transactions  [[32mSUCCESS 1[0m in 0.93s]
[0m14:17:40.995221 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:17:40.996761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:40.997259 [debug] [MainThread]: Connection 'model.deel_task.rpt_globepay__no_chargeback_transactions' was properly closed.
[0m14:17:40.997799 [info ] [MainThread]: 
[0m14:17:40.998294 [info ] [MainThread]: Finished running 7 view models, 9 data tests in 0 hours 0 minutes and 19.51 seconds (19.51s).
[0m14:17:41.001752 [debug] [MainThread]: Command end result
[0m14:17:41.035381 [info ] [MainThread]: 
[0m14:17:41.035804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:41.036081 [info ] [MainThread]: 
[0m14:17:41.036360 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m14:17:41.038443 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 20.199947, "process_user_time": 2.934267, "process_kernel_time": 0.422158, "process_mem_max_rss": "137134080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:17:41.038868 [debug] [MainThread]: Command `dbt build` succeeded at 14:17:41.038804 after 20.20 seconds
[0m14:17:41.039171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4be5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2839b0>]}
[0m14:17:41.039465 [debug] [MainThread]: Flushing usage events
[0m14:21:35.787814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107586cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed5220>]}


============================== 14:21:35.790910 | 24829b96-f440-40fd-84b5-5bea676facf0 ==============================
[0m14:21:35.790910 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:21:35.791256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': './profiles', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:21:36.100050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acaec30>]}
[0m14:21:36.122648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab272f0>]}
[0m14:21:36.123395 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m14:21:36.134848 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:21:36.233283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:21:36.233773 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/semantic/product/_rpt_globepay__models.yml
[0m14:21:36.233999 [debug] [MainThread]: Partial parsing: updated file: deel_task://models/semantic/product/rpt_globepay__no_chargeback_transactions.sql
[0m14:21:36.336033 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:21:36.336410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5349e0>]}
[0m14:21:36.408354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b107890>]}
[0m14:21:36.474810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7152e0>]}
[0m14:21:36.475122 [info ] [MainThread]: Found 7 models, 10 data tests, 2 sources, 444 macros
[0m14:21:36.476620 [info ] [MainThread]: 
[0m14:21:36.476951 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:36.479054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEEL_HOME_TEST'
[0m14:21:36.486232 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m14:21:36.486609 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m14:21:36.486819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:37.487871 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:21:37.491809 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m14:21:37.660826 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m14:21:37.661412 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m14:21:37.661870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:38.232164 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:21:38.236208 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m14:21:38.418595 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST"
[0m14:21:38.419757 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST"} */
show terse schemas in database DEEL_HOME_TEST
    limit 10000
[0m14:21:38.420300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:38.946655 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:21:38.949002 [debug] [ThreadPool]: On list_DEEL_HOME_TEST: Close
[0m14:21:39.114392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST, now list_DEEL_HOME_TEST_RAW)
[0m14:21:39.127567 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW"
[0m14:21:39.128186 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW"} */
show terse objects in DEEL_HOME_TEST.RAW limit 10000
[0m14:21:39.128597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:39.753981 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:21:39.759512 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW: Close
[0m14:21:39.927416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW, now list_DEEL_HOME_TEST_RAW_STAGING)
[0m14:21:39.933148 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_STAGING"
[0m14:21:39.933760 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_STAGING"} */
show terse objects in DEEL_HOME_TEST.RAW_STAGING limit 10000
[0m14:21:39.934248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:40.500118 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:21:40.505208 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_STAGING: Close
[0m14:21:40.671735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_STAGING, now list_DEEL_HOME_TEST_RAW_MART)
[0m14:21:40.676692 [debug] [ThreadPool]: Using snowflake connection "list_DEEL_HOME_TEST_RAW_MART"
[0m14:21:40.677286 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "connection_name": "list_DEEL_HOME_TEST_RAW_MART"} */
show terse objects in DEEL_HOME_TEST.RAW_MART limit 10000
[0m14:21:40.677765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:41.400379 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:21:41.405400 [debug] [ThreadPool]: On list_DEEL_HOME_TEST_RAW_MART: Close
[0m14:21:41.578032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7158b0>]}
[0m14:21:41.579082 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:21:41.579632 [info ] [MainThread]: 
[0m14:21:41.583686 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__acceptance
[0m14:21:41.584467 [info ] [Thread-1 (]: 1 of 17 START sql view model RAW_STAGING.stg_globepay__acceptance .............. [RUN]
[0m14:21:41.585191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEEL_HOME_TEST_RAW_MART, now model.deel_task.stg_globepay__acceptance)
[0m14:21:41.585947 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__acceptance
[0m14:21:41.597170 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__acceptance"
[0m14:21:41.599071 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__acceptance
[0m14:21:41.627517 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__acceptance"
[0m14:21:41.629478 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__acceptance"
[0m14:21:41.629878 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__acceptance"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
  
   as (
    -- Load raw data
with load_acceptance as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_ACCEPTANCE_REPORT
)

select 
    AMOUNT::number as globepay_acceptance_amount,
    COUNTRY as globepay_country,
    CURRENCY as globepay_currency,
    CVV_PROVIDED::boolean as is_globepay_cvv_provided,
    DATE_TIME::timestamp as globepay_acceptance_at,
    EXTERNAL_REF as globepay_acceptance_id,
    TRY_PARSE_JSON(RATES)as globepay_acceptance_rates,
    REF as globepay_acceptance_event_id,
    SOURCE as globepay_acceptance_source,
    STATE as globepay_acceptance_state,
    STATUS as globepay_acceptance_status
from load_acceptance
  );
[0m14:21:41.630180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:42.296115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:42.326617 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__acceptance: Close
[0m14:21:42.487728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a84d0>]}
[0m14:21:42.489210 [info ] [Thread-1 (]: 1 of 17 OK created sql view model RAW_STAGING.stg_globepay__acceptance ......... [[32mSUCCESS 1[0m in 0.90s]
[0m14:21:42.490170 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__acceptance
[0m14:21:42.490878 [debug] [Thread-1 (]: Began running node model.deel_task.stg_globepay__chargeback
[0m14:21:42.491740 [info ] [Thread-1 (]: 2 of 17 START sql view model RAW_STAGING.stg_globepay__chargeback .............. [RUN]
[0m14:21:42.492677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__acceptance, now model.deel_task.stg_globepay__chargeback)
[0m14:21:42.493253 [debug] [Thread-1 (]: Began compiling node model.deel_task.stg_globepay__chargeback
[0m14:21:42.497346 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.stg_globepay__chargeback"
[0m14:21:42.498820 [debug] [Thread-1 (]: Began executing node model.deel_task.stg_globepay__chargeback
[0m14:21:42.503089 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.stg_globepay__chargeback"
[0m14:21:42.505463 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.stg_globepay__chargeback"
[0m14:21:42.506082 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.stg_globepay__chargeback"} */
create or replace   view DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
  
   as (
    -- Load raw data
with load_chargeback as (
    select * 
    from DEEL_HOME_TEST.RAW.RAW_GLOBEPAY_CHARGEBACK_REPORT
)

select 
    EXTERNAL_REF as globepay_acceptance_id,
    SOURCE as globepay_chargeback_source,
    STATUS::boolean as globepay_chargeback_status,
    CHARGEBACK::boolean as is_globepay_chargeback
from load_chargeback
  );
[0m14:21:42.506590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:43.155952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:43.160477 [debug] [Thread-1 (]: On model.deel_task.stg_globepay__chargeback: Close
[0m14:21:43.343715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3cd220>]}
[0m14:21:43.344821 [info ] [Thread-1 (]: 2 of 17 OK created sql view model RAW_STAGING.stg_globepay__chargeback ......... [[32mSUCCESS 1[0m in 0.85s]
[0m14:21:43.345657 [debug] [Thread-1 (]: Finished running node model.deel_task.stg_globepay__chargeback
[0m14:21:43.346283 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:21:43.347051 [info ] [Thread-1 (]: 3 of 17 START test not_null_stg_globepay__acceptance_globepay_acceptance_id .... [RUN]
[0m14:21:43.347739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.stg_globepay__chargeback, now test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f)
[0m14:21:43.348130 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:21:43.357609 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m14:21:43.358837 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:21:43.369548 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m14:21:43.370551 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"
[0m14:21:43.370866 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:21:43.371134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:43.994410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:44.001628 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f: Close
[0m14:21:44.167663 [info ] [Thread-1 (]: 3 of 17 PASS not_null_stg_globepay__acceptance_globepay_acceptance_id .......... [[32mPASS[0m in 0.82s]
[0m14:21:44.168946 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f
[0m14:21:44.169613 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:21:44.170357 [info ] [Thread-1 (]: 4 of 17 START test unique_stg_globepay__acceptance_globepay_acceptance_id ...... [RUN]
[0m14:21:44.171156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__acceptance_globepay_acceptance_id.5ce756c62f, now test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4)
[0m14:21:44.171805 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:21:44.181936 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m14:21:44.183858 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:21:44.187683 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m14:21:44.189521 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"
[0m14:21:44.190020 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:21:44.190451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:44.823838 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:44.827781 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4: Close
[0m14:21:45.003345 [info ] [Thread-1 (]: 4 of 17 PASS unique_stg_globepay__acceptance_globepay_acceptance_id ............ [[32mPASS[0m in 0.83s]
[0m14:21:45.004526 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4
[0m14:21:45.005210 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:21:45.005935 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_globepay__chargeback_globepay_acceptance_id .... [RUN]
[0m14:21:45.006767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__acceptance_globepay_acceptance_id.8829ad90c4, now test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657)
[0m14:21:45.007409 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:21:45.014079 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m14:21:45.015383 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:21:45.019372 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m14:21:45.021678 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"
[0m14:21:45.022233 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:21:45.022729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:45.652633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:45.656021 [debug] [Thread-1 (]: On test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657: Close
[0m14:21:45.830133 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_globepay__chargeback_globepay_acceptance_id .......... [[32mPASS[0m in 0.82s]
[0m14:21:45.831648 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657
[0m14:21:45.832363 [debug] [Thread-1 (]: Began running node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:21:45.833153 [info ] [Thread-1 (]: 6 of 17 START test relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_  [RUN]
[0m14:21:45.834027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_stg_globepay__chargeback_globepay_acceptance_id.50e07f8657, now test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c)
[0m14:21:45.834694 [debug] [Thread-1 (]: Began compiling node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:21:45.847326 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m14:21:45.849686 [debug] [Thread-1 (]: Began executing node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:21:45.852687 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m14:21:45.854253 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"
[0m14:21:45.854788 [debug] [Thread-1 (]: On test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select globepay_acceptance_id as from_field
    from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
    where globepay_acceptance_id is not null
),

parent as (
    select globepay_acceptance_id as to_field
    from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:21:45.855247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:46.596579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:46.599803 [debug] [Thread-1 (]: On test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c: Close
[0m14:21:46.769657 [info ] [Thread-1 (]: 6 of 17 PASS relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_  [[32mPASS[0m in 0.94s]
[0m14:21:46.771533 [debug] [Thread-1 (]: Finished running node test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c
[0m14:21:46.772374 [debug] [Thread-1 (]: Began running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:21:46.773164 [info ] [Thread-1 (]: 7 of 17 START test unique_stg_globepay__chargeback_globepay_acceptance_id ...... [RUN]
[0m14:21:46.774000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.relationships_stg_globepay__acceptance_globepay_acceptance_id__globepay_acceptance_id__ref_stg_globepay__chargeback_.604b6ce72c, now test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec)
[0m14:21:46.774629 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:21:46.781331 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m14:21:46.782673 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:21:46.785675 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m14:21:46.787176 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"
[0m14:21:46.787715 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:21:46.788208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:47.388860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:47.392174 [debug] [Thread-1 (]: On test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec: Close
[0m14:21:47.552825 [info ] [Thread-1 (]: 7 of 17 PASS unique_stg_globepay__chargeback_globepay_acceptance_id ............ [[32mPASS[0m in 0.78s]
[0m14:21:47.553727 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec
[0m14:21:47.554626 [debug] [Thread-1 (]: Began running node model.deel_task.dim_globepay
[0m14:21:47.555299 [info ] [Thread-1 (]: 8 of 17 START sql view model RAW_MART.dim_globepay ............................. [RUN]
[0m14:21:47.555812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_stg_globepay__chargeback_globepay_acceptance_id.44b6f4c8ec, now model.deel_task.dim_globepay)
[0m14:21:47.556223 [debug] [Thread-1 (]: Began compiling node model.deel_task.dim_globepay
[0m14:21:47.559612 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.dim_globepay"
[0m14:21:47.562057 [debug] [Thread-1 (]: Began executing node model.deel_task.dim_globepay
[0m14:21:47.566100 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.dim_globepay"
[0m14:21:47.568957 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.dim_globepay"
[0m14:21:47.569804 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.dim_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.dim_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    chargeback.globepay_chargeback_source,
    acceptance.globepay_country,
    acceptance.globepay_currency,
    acceptance.globepay_acceptance_source,
    chargeback.is_globepay_chargeback,
    acceptance.is_globepay_cvv_provided,
    acceptance.globepay_acceptance_status,
    chargeback.globepay_chargeback_status,
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m14:21:47.570254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:48.399247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:48.404896 [debug] [Thread-1 (]: On model.deel_task.dim_globepay: Close
[0m14:21:48.568667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b583f20>]}
[0m14:21:48.570250 [info ] [Thread-1 (]: 8 of 17 OK created sql view model RAW_MART.dim_globepay ........................ [[32mSUCCESS 1[0m in 1.01s]
[0m14:21:48.571480 [debug] [Thread-1 (]: Finished running node model.deel_task.dim_globepay
[0m14:21:48.572134 [debug] [Thread-1 (]: Began running node model.deel_task.fct_globepay
[0m14:21:48.573038 [info ] [Thread-1 (]: 9 of 17 START sql view model RAW_MART.fct_globepay ............................. [RUN]
[0m14:21:48.573751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.dim_globepay, now model.deel_task.fct_globepay)
[0m14:21:48.574285 [debug] [Thread-1 (]: Began compiling node model.deel_task.fct_globepay
[0m14:21:48.579371 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.fct_globepay"
[0m14:21:48.581990 [debug] [Thread-1 (]: Began executing node model.deel_task.fct_globepay
[0m14:21:48.586171 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.fct_globepay"
[0m14:21:48.589065 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.fct_globepay"
[0m14:21:48.589671 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.fct_globepay"} */
create or replace   view DEEL_HOME_TEST.RAW_MART.fct_globepay
  
   as (
    with laod_acceptance as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__acceptance
),
laod_chargeback as (
    SELECT * FROM DEEL_HOME_TEST.RAW_STAGING.stg_globepay__chargeback
),

--GRAIN is the event
join_acceptance_chargeback as (
SELECT 
    acceptance.globepay_acceptance_id,
    acceptance.globepay_acceptance_event_id,
    acceptance.globepay_acceptance_amount,
    acceptance.globepay_acceptance_at,
    acceptance.globepay_acceptance_state,
    --Getting the correct rate for country amounts
    case
        when (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency] is not null
        then (acceptance.globepay_acceptance_rates)::object[acceptance.globepay_currency]::string::float
        else null
    end as country_rate_to_usd,
    acceptance.globepay_acceptance_amount/country_rate_to_usd as globepay_acceptance_amount_usd
FROM laod_acceptance  acceptance 
LEFT JOIN laod_chargeback chargeback
ON acceptance.globepay_acceptance_id = chargeback.globepay_acceptance_id
)
SELECT * FROM join_acceptance_chargeback
  );
[0m14:21:48.590208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:49.363849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:49.367701 [debug] [Thread-1 (]: On model.deel_task.fct_globepay: Close
[0m14:21:49.564206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b582270>]}
[0m14:21:49.565459 [info ] [Thread-1 (]: 9 of 17 OK created sql view model RAW_MART.fct_globepay ........................ [[32mSUCCESS 1[0m in 0.99s]
[0m14:21:49.566799 [debug] [Thread-1 (]: Finished running node model.deel_task.fct_globepay
[0m14:21:49.567693 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:21:49.568473 [info ] [Thread-1 (]: 10 of 17 START test not_null_dim_globepay_globepay_acceptance_id ............... [RUN]
[0m14:21:49.569395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.fct_globepay, now test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc)
[0m14:21:49.570122 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:21:49.576599 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"
[0m14:21:49.577943 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:21:49.581011 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"
[0m14:21:49.582875 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"
[0m14:21:49.583872 [debug] [Thread-1 (]: On test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_MART.dim_globepay
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:21:49.584441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:50.229576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:50.231503 [debug] [Thread-1 (]: On test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc: Close
[0m14:21:50.386267 [info ] [Thread-1 (]: 10 of 17 PASS not_null_dim_globepay_globepay_acceptance_id ..................... [[32mPASS[0m in 0.82s]
[0m14:21:50.387015 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc
[0m14:21:50.387436 [debug] [Thread-1 (]: Began running node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:21:50.387891 [info ] [Thread-1 (]: 11 of 17 START test unique_dim_globepay_globepay_acceptance_id ................. [RUN]
[0m14:21:50.388383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_dim_globepay_globepay_acceptance_id.45071612bc, now test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd)
[0m14:21:50.388773 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:21:50.392760 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"
[0m14:21:50.393731 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:21:50.395832 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"
[0m14:21:50.397236 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"
[0m14:21:50.397595 [debug] [Thread-1 (]: On test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_MART.dim_globepay
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:21:50.397914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:51.090093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:51.093775 [debug] [Thread-1 (]: On test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd: Close
[0m14:21:51.259477 [info ] [Thread-1 (]: 11 of 17 PASS unique_dim_globepay_globepay_acceptance_id ....................... [[32mPASS[0m in 0.87s]
[0m14:21:51.261220 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd
[0m14:21:51.262274 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:21:51.263128 [info ] [Thread-1 (]: 12 of 17 START test not_null_fct_globepay_globepay_acceptance_id ............... [RUN]
[0m14:21:51.263933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_dim_globepay_globepay_acceptance_id.75d5538fbd, now test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77)
[0m14:21:51.264543 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:21:51.271124 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"
[0m14:21:51.272568 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:21:51.276375 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"
[0m14:21:51.278163 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"
[0m14:21:51.278849 [debug] [Thread-1 (]: On test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW_MART.fct_globepay
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:21:51.279537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:51.911415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:51.913917 [debug] [Thread-1 (]: On test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77: Close
[0m14:21:52.069649 [info ] [Thread-1 (]: 12 of 17 PASS not_null_fct_globepay_globepay_acceptance_id ..................... [[32mPASS[0m in 0.81s]
[0m14:21:52.070129 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77
[0m14:21:52.070392 [debug] [Thread-1 (]: Began running node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:21:52.070632 [info ] [Thread-1 (]: 13 of 17 START test unique_fct_globepay_globepay_acceptance_id ................. [RUN]
[0m14:21:52.070893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.not_null_fct_globepay_globepay_acceptance_id.eee0187f77, now test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182)
[0m14:21:52.071181 [debug] [Thread-1 (]: Began compiling node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:21:52.073717 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"
[0m14:21:52.074353 [debug] [Thread-1 (]: Began executing node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:21:52.075729 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"
[0m14:21:52.076494 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"
[0m14:21:52.076744 [debug] [Thread-1 (]: On test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    globepay_acceptance_id as unique_field,
    count(*) as n_records

from DEEL_HOME_TEST.RAW_MART.fct_globepay
where globepay_acceptance_id is not null
group by globepay_acceptance_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:21:52.076960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:52.920778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:52.926701 [debug] [Thread-1 (]: On test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182: Close
[0m14:21:53.101133 [info ] [Thread-1 (]: 13 of 17 PASS unique_fct_globepay_globepay_acceptance_id ....................... [[32mPASS[0m in 1.03s]
[0m14:21:53.102746 [debug] [Thread-1 (]: Finished running node test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182
[0m14:21:53.104495 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:21:53.105601 [info ] [Thread-1 (]: 14 of 17 START sql view model RAW.rpt_globepay__daily_acceptance_rate .......... [RUN]
[0m14:21:53.106407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.deel_task.unique_fct_globepay_globepay_acceptance_id.5566ec4182, now model.deel_task.rpt_globepay__daily_acceptance_rate)
[0m14:21:53.107029 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:21:53.111240 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m14:21:53.113956 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:21:53.118785 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m14:21:53.121199 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__daily_acceptance_rate"
[0m14:21:53.121914 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__daily_acceptance_rate"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__daily_acceptance_rate
  
   as (
    --1. What is the acceptance rate over time?
with load_fct_globepay as (
    SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
)
SELECT
--DAILY GRAIN
DATE_TRUNC(day,GLOBEPAY_ACCEPTANCE_AT)::date GLOBEPAY_ACCEPTANCE_DATE,
COUNT_IF(GLOBEPAY_ACCEPTANCE_STATE = 'ACCEPTED') as count_acceptance,
COUNT(*) total_count,
count_acceptance/total_count as daily_acceptance_rate
FROM load_fct_globepay
GROUP BY GLOBEPAY_ACCEPTANCE_DATE
  );
[0m14:21:53.122450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:53.899455 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:53.904342 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__daily_acceptance_rate: Close
[0m14:21:54.093903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5876e0>]}
[0m14:21:54.095261 [info ] [Thread-1 (]: 14 of 17 OK created sql view model RAW.rpt_globepay__daily_acceptance_rate ..... [[32mSUCCESS 1[0m in 0.99s]
[0m14:21:54.096226 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__daily_acceptance_rate
[0m14:21:54.096910 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:21:54.097742 [info ] [Thread-1 (]: 15 of 17 START sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [RUN]
[0m14:21:54.098498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__daily_acceptance_rate, now model.deel_task.rpt_globepay__declined_countries_greater_25_mil)
[0m14:21:54.099106 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:21:54.104053 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m14:21:54.105455 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:21:54.109014 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m14:21:54.111516 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"
[0m14:21:54.112214 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__declined_countries_greater_25_mil"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__declined_countries_greater_25_mil
  
   as (
    --2. List the countries where the amount of declined transactions went over $25M
with load_fct_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay
     where FCT_GLOBEPAY.GLOBEPAY_ACCEPTANCE_STATE = 'DECLINED'

),

load_dim_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay
),

join_tables as (
    SELECT *  
    FROM load_fct_globepay 
    LEFT JOIN load_dim_globepay  
    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID
)

SELECT 
GLOBEPAY_COUNTRY,
SUM(GLOBEPAY_ACCEPTANCE_AMOUNT_USD) total_amount
FROM join_tables
GROUP BY 1
--Over 25 millions
HAVING total_amount > 25000000
  );
[0m14:21:54.112739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:54.895750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:54.899646 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__declined_countries_greater_25_mil: Close
[0m14:21:55.080417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c48a0f0>]}
[0m14:21:55.081772 [info ] [Thread-1 (]: 15 of 17 OK created sql view model RAW.rpt_globepay__declined_countries_greater_25_mil  [[32mSUCCESS 1[0m in 0.98s]
[0m14:21:55.082676 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__declined_countries_greater_25_mil
[0m14:21:55.083336 [debug] [Thread-1 (]: Began running node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:21:55.084181 [info ] [Thread-1 (]: 16 of 17 START sql view model RAW.rpt_globepay__no_chargeback_transactions ..... [RUN]
[0m14:21:55.084973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__declined_countries_greater_25_mil, now model.deel_task.rpt_globepay__no_chargeback_transactions)
[0m14:21:55.085599 [debug] [Thread-1 (]: Began compiling node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:21:55.090551 [debug] [Thread-1 (]: Writing injected SQL for node "model.deel_task.rpt_globepay__no_chargeback_transactions"
[0m14:21:55.092071 [debug] [Thread-1 (]: Began executing node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:21:55.095832 [debug] [Thread-1 (]: Writing runtime sql for node "model.deel_task.rpt_globepay__no_chargeback_transactions"
[0m14:21:55.097934 [debug] [Thread-1 (]: Using snowflake connection "model.deel_task.rpt_globepay__no_chargeback_transactions"
[0m14:21:55.098531 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__no_chargeback_transactions: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "model.deel_task.rpt_globepay__no_chargeback_transactions"} */
create or replace   view DEEL_HOME_TEST.RAW.rpt_globepay__no_chargeback_transactions
  
   as (
    --Which transactions are missing chargeback data?
with load_dim_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.dim_globepay
     where not is_globepay_chargeback 
),
load_fct_globepay as (
     SELECT * FROM DEEL_HOME_TEST.RAW_MART.fct_globepay

),

join_tables as (
    SELECT 
    load_dim_globepay.globepay_acceptance_id,
    load_fct_globepay.globepay_acceptance_event_id
    FROM load_dim_globepay 
    LEFT JOIN load_fct_globepay  
    ON load_fct_globepay.GLOBEPAY_ACCEPTANCE_ID = load_dim_globepay.GLOBEPAY_ACCEPTANCE_ID
)

SELECT * FROM join_tables
  );
[0m14:21:55.099060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:56.019480 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:56.026661 [debug] [Thread-1 (]: On model.deel_task.rpt_globepay__no_chargeback_transactions: Close
[0m14:21:56.193985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24829b96-f440-40fd-84b5-5bea676facf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5834a0>]}
[0m14:21:56.195276 [info ] [Thread-1 (]: 16 of 17 OK created sql view model RAW.rpt_globepay__no_chargeback_transactions  [[32mSUCCESS 1[0m in 1.11s]
[0m14:21:56.196337 [debug] [Thread-1 (]: Finished running node model.deel_task.rpt_globepay__no_chargeback_transactions
[0m14:21:56.198209 [debug] [Thread-1 (]: Began running node test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf
[0m14:21:56.199171 [info ] [Thread-1 (]: 17 of 17 START test not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id  [RUN]
[0m14:21:56.200140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.deel_task.rpt_globepay__no_chargeback_transactions, now test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf)
[0m14:21:56.200824 [debug] [Thread-1 (]: Began compiling node test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf
[0m14:21:56.206726 [debug] [Thread-1 (]: Writing injected SQL for node "test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf"
[0m14:21:56.208230 [debug] [Thread-1 (]: Began executing node test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf
[0m14:21:56.211613 [debug] [Thread-1 (]: Writing runtime sql for node "test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf"
[0m14:21:56.213340 [debug] [Thread-1 (]: Using snowflake connection "test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf"
[0m14:21:56.213843 [debug] [Thread-1 (]: On test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "deel_task", "target_name": "dev", "node_id": "test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select globepay_acceptance_id
from DEEL_HOME_TEST.RAW.rpt_globepay__no_chargeback_transactions
where globepay_acceptance_id is null



      
    ) dbt_internal_test
[0m14:21:56.214264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:56.939048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:21:56.942331 [debug] [Thread-1 (]: On test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf: Close
[0m14:21:57.111853 [info ] [Thread-1 (]: 17 of 17 PASS not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id  [[32mPASS[0m in 0.91s]
[0m14:21:57.113745 [debug] [Thread-1 (]: Finished running node test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf
[0m14:21:57.115492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:57.115990 [debug] [MainThread]: Connection 'test.deel_task.not_null_rpt_globepay__no_chargeback_transactions_globepay_acceptance_id.8813dcd2cf' was properly closed.
[0m14:21:57.116545 [info ] [MainThread]: 
[0m14:21:57.117054 [info ] [MainThread]: Finished running 7 view models, 10 data tests in 0 hours 0 minutes and 20.64 seconds (20.64s).
[0m14:21:57.120629 [debug] [MainThread]: Command end result
[0m14:21:57.155514 [info ] [MainThread]: 
[0m14:21:57.155962 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:57.156241 [info ] [MainThread]: 
[0m14:21:57.156516 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m14:21:57.159436 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 21.414503, "process_user_time": 3.253374, "process_kernel_time": 0.439472, "process_mem_max_rss": "139395072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:21:57.159859 [debug] [MainThread]: Command `dbt build` succeeded at 14:21:57.159796 after 21.41 seconds
[0m14:21:57.160172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b6e8e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af9aa50>]}
[0m14:21:57.160475 [debug] [MainThread]: Flushing usage events
[0m14:25:53.834969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106834800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa0e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa0b90>]}


============================== 14:25:53.838023 | 7e5501fd-f57e-4463-97cf-6abb143fe19d ==============================
[0m14:25:53.838023 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:25:53.838388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'version_check': 'True', 'profiles_dir': './profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:25:53.852568 [info ] [MainThread]: dbt version: 1.8.0
[0m14:25:53.852859 [info ] [MainThread]: python version: 3.12.2
[0m14:25:53.853029 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m14:25:53.853187 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m14:25:54.106122 [info ] [MainThread]: Using profiles dir at ./profiles
[0m14:25:54.106431 [info ] [MainThread]: Using profiles.yml file at ./profiles/profiles.yml
[0m14:25:54.106610 [info ] [MainThread]: Using dbt_project.yml file at /Users/alessandro.broggio/Desktop/deel/github/deel_task/dbt_project.yml
[0m14:25:54.107201 [info ] [MainThread]: adapter type: snowflake
[0m14:25:54.107372 [info ] [MainThread]: adapter version: 1.8.1
[0m14:25:54.146366 [info ] [MainThread]: Configuration:
[0m14:25:54.146717 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:25:54.146890 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:25:54.147048 [info ] [MainThread]: Required dependencies:
[0m14:25:54.147384 [debug] [MainThread]: Executing "git --help"
[0m14:25:54.188909 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:25:54.189527 [debug] [MainThread]: STDERR: "b''"
[0m14:25:54.189733 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:25:54.189930 [info ] [MainThread]: Connection:
[0m14:25:54.190120 [info ] [MainThread]:   account: sb10459.eu-west-3.aws
[0m14:25:54.190273 [info ] [MainThread]:   user: DEELTESTACCOUNT
[0m14:25:54.190417 [info ] [MainThread]:   database: DEEL_HOME_TEST
[0m14:25:54.190563 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m14:25:54.190704 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m14:25:54.190849 [info ] [MainThread]:   schema: RAW
[0m14:25:54.190990 [info ] [MainThread]:   authenticator: None
[0m14:25:54.191130 [info ] [MainThread]:   oauth_client_id: None
[0m14:25:54.191271 [info ] [MainThread]:   query_tag: None
[0m14:25:54.191411 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:25:54.191555 [info ] [MainThread]:   host: None
[0m14:25:54.191695 [info ] [MainThread]:   port: None
[0m14:25:54.191830 [info ] [MainThread]:   proxy_host: None
[0m14:25:54.191969 [info ] [MainThread]:   proxy_port: None
[0m14:25:54.192103 [info ] [MainThread]:   protocol: None
[0m14:25:54.192249 [info ] [MainThread]:   connect_retries: 1
[0m14:25:54.192386 [info ] [MainThread]:   connect_timeout: None
[0m14:25:54.192526 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:25:54.192662 [info ] [MainThread]:   retry_all: False
[0m14:25:54.192797 [info ] [MainThread]:   insecure_mode: False
[0m14:25:54.192934 [info ] [MainThread]:   reuse_connections: None
[0m14:25:54.193285 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m14:25:54.197883 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:25:54.199225 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:25:54.199418 [debug] [MainThread]: On debug: select 1 as id
[0m14:25:54.199582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:54.928002 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m14:25:54.928659 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m14:25:54.929154 [debug] [MainThread]: On debug: No close available on handle
[0m14:25:54.929622 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:25:54.930087 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:25:54.930485 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: sb10459.eu-west-3.aws.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:25:54.934139 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.1473212, "process_user_time": 0.835627, "process_kernel_time": 0.229558, "process_mem_max_rss": "124764160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:25:54.935067 [debug] [MainThread]: Command `dbt debug` failed at 14:25:54.934926 after 1.15 seconds
[0m14:25:54.935634 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:25:54.936112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e8a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bb560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106474080>]}
[0m14:25:54.936630 [debug] [MainThread]: Flushing usage events
[0m14:26:48.673087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108608c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b21160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b20ec0>]}


============================== 14:26:48.676338 | b17bc100-51b1-450c-b470-cc09dc040fdc ==============================
[0m14:26:48.676338 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:26:48.676719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/alessandro.broggio/Desktop/deel/github/deel_task/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:26:48.688736 [info ] [MainThread]: dbt version: 1.8.0
[0m14:26:48.689023 [info ] [MainThread]: python version: 3.12.2
[0m14:26:48.689198 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m14:26:48.689361 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m14:26:48.943713 [info ] [MainThread]: Using profiles dir at ./profiles
[0m14:26:48.944029 [info ] [MainThread]: Using profiles.yml file at ./profiles/profiles.yml
[0m14:26:48.944280 [info ] [MainThread]: Using dbt_project.yml file at /Users/alessandro.broggio/Desktop/deel/github/deel_task/dbt_project.yml
[0m14:26:48.944865 [info ] [MainThread]: adapter type: snowflake
[0m14:26:48.945050 [info ] [MainThread]: adapter version: 1.8.1
[0m14:26:48.984714 [info ] [MainThread]: Configuration:
[0m14:26:48.985042 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:26:48.985219 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:26:48.985379 [info ] [MainThread]: Required dependencies:
[0m14:26:48.985659 [debug] [MainThread]: Executing "git --help"
[0m14:26:49.019518 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:26:49.020180 [debug] [MainThread]: STDERR: "b''"
[0m14:26:49.020385 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:26:49.020577 [info ] [MainThread]: Connection:
[0m14:26:49.020770 [info ] [MainThread]:   account: sb10459.eu-west-3.aws
[0m14:26:49.020930 [info ] [MainThread]:   user: DEELTESTACCOUNT
[0m14:26:49.021081 [info ] [MainThread]:   database: DEEL_HOME_TEST
[0m14:26:49.021227 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m14:26:49.021372 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m14:26:49.021518 [info ] [MainThread]:   schema: RAW
[0m14:26:49.021664 [info ] [MainThread]:   authenticator: None
[0m14:26:49.021807 [info ] [MainThread]:   oauth_client_id: None
[0m14:26:49.021948 [info ] [MainThread]:   query_tag: None
[0m14:26:49.022088 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:26:49.022234 [info ] [MainThread]:   host: None
[0m14:26:49.022374 [info ] [MainThread]:   port: None
[0m14:26:49.022514 [info ] [MainThread]:   proxy_host: None
[0m14:26:49.022655 [info ] [MainThread]:   proxy_port: None
[0m14:26:49.022795 [info ] [MainThread]:   protocol: None
[0m14:26:49.022936 [info ] [MainThread]:   connect_retries: 1
[0m14:26:49.023074 [info ] [MainThread]:   connect_timeout: None
[0m14:26:49.023419 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:26:49.023633 [info ] [MainThread]:   retry_all: False
[0m14:26:49.023798 [info ] [MainThread]:   insecure_mode: False
[0m14:26:49.023955 [info ] [MainThread]:   reuse_connections: None
[0m14:26:49.024331 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m14:26:49.029740 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:26:49.032529 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:26:49.032988 [debug] [MainThread]: On debug: select 1 as id
[0m14:26:49.033222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:49.903888 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:26:49.906863 [debug] [MainThread]: On debug: Close
[0m14:26:50.066339 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:26:50.067405 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:26:50.071987 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4397775, "process_user_time": 0.806819, "process_kernel_time": 0.215491, "process_mem_max_rss": "123944960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:26:50.073017 [debug] [MainThread]: Command `dbt debug` succeeded at 14:26:50.072851 after 1.44 seconds
[0m14:26:50.073758 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:26:50.074438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11263e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11257d970>]}
[0m14:26:50.075097 [debug] [MainThread]: Flushing usage events
